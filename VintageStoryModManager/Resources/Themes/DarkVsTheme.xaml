<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                    xmlns:options="http://schemas.microsoft.com/winfx/2006/xaml/presentation/options">
    <!-- Simplified Vintage Story inspired dark theme palette -->
    <Color x:Key="DVS.Text">#FFE9DDCE</Color>
    <Color x:Key="DVS.TextImportant">#FFAD8948</Color>
    <Color x:Key="DVS.Background">#FF342A20</Color>
    <Color x:Key="DVS.Foreground">#FF403529</Color>
    <Color x:Key="DVS.Element">#FF53493E</Color>
    <Color x:Key="DVS.ElementBright">#FFE0CFBB</Color>
    <Color x:Key="DVS.HoverColor">#FFF1D8BF</Color>
    <Color x:Key="DVS.Error">#FF8C3F3F</Color>

    <SolidColorBrush x:Key="DVS.TextBrush" Color="{StaticResource DVS.Text}" />
    <SolidColorBrush x:Key="DVS.TextImportantBrush" Color="{StaticResource DVS.TextImportant}" />
    <SolidColorBrush x:Key="DVS.BackgroundBrush" Color="{StaticResource DVS.Background}" />
    <SolidColorBrush x:Key="DVS.ForegroundBrush" Color="{StaticResource DVS.Foreground}" />
    <SolidColorBrush x:Key="DVS.ElementBrush" Color="{StaticResource DVS.Element}" />
    <SolidColorBrush x:Key="DVS.ElementBrightBrush" Color="{StaticResource DVS.ElementBright}" />
    <SolidColorBrush x:Key="DVS.HoverBrush" Color="{StaticResource DVS.HoverColor}" />
    <SolidColorBrush x:Key="DVS.ErrorBrush" Color="{StaticResource DVS.Error}" />

    <!-- Legacy IMM brushes mapped to the simplified palette -->
    <SolidColorBrush x:Key="IMM.AccentBrush" Color="{StaticResource DVS.ElementBright}" />
    <SolidColorBrush x:Key="IMM.SurfaceBrush" Color="{StaticResource DVS.Foreground}" />
    <SolidColorBrush x:Key="IMM.SurfaceAltBrush" Color="{StaticResource DVS.Background}" />
    <SolidColorBrush x:Key="IMM.DataGridBackgroundBrush" Color="{StaticResource DVS.Background}" />
    <SolidColorBrush x:Key="IMM.NewDataGridBackgroundBrush" Color="{StaticResource DVS.Foreground}" />
    <SolidColorBrush x:Key="IMM.RowsAndCardsBrush" Color="{StaticResource DVS.Foreground}" />
    <SolidColorBrush x:Key="IMM.MenuBackgroundBrush" Color="{StaticResource DVS.Foreground}" />
    <SolidColorBrush x:Key="IMM.BorderBrush" options:Freeze="False" Color="{StaticResource DVS.Background}" />
    <SolidColorBrush x:Key="IMM.WindowBorderBrush" Color="{StaticResource DVS.Background}" />
    <SolidColorBrush x:Key="IMM.RowBorderBrush" Color="{StaticResource DVS.Background}" />
    <SolidColorBrush x:Key="IMM.BorderHoverBrush" Color="{StaticResource DVS.HoverColor}" />
    <SolidColorBrush x:Key="IMM.ButtonBackgroundBrush" options:Freeze="False" Color="{StaticResource DVS.Element}" />
    <SolidColorBrush x:Key="IMM.ButtonHoverBrush" Color="{StaticResource DVS.HoverColor}" />
    <SolidColorBrush x:Key="IMM.ButtonPressedBrush" Color="{StaticResource DVS.Background}" />
    <SolidColorBrush x:Key="IMM.ButtonDisabledBrush" Color="{StaticResource DVS.Background}" Opacity="0.6" />
    <SolidColorBrush x:Key="IMM.ButtonBorderBrush" Color="{StaticResource DVS.ElementBright}" />
    <SolidColorBrush x:Key="IMM.ToggleOffBrush" Color="{StaticResource DVS.Background}" />
    <SolidColorBrush x:Key="IMM.ToggleThumbBrush" Color="{StaticResource DVS.ElementBright}" />
    <SolidColorBrush x:Key="IMM.ToggleDisabledBrush" Color="{StaticResource DVS.Background}" Opacity="0.7" />
    <SolidColorBrush x:Key="IMM.ToggleDisabledThumbBrush" Color="{StaticResource DVS.ElementBright}" Opacity="0.5" />
    <SolidColorBrush x:Key="IMM.PlaceholderForegroundBrush" Color="{StaticResource DVS.Text}" Opacity="0.6" />
    <SolidColorBrush x:Key="IMM.ForegroundBrush" Color="{StaticResource DVS.Text}" />
    <SolidColorBrush x:Key="IMM.BodyForegroundBrush" Color="{StaticResource DVS.Text}" />
    <SolidColorBrush x:Key="IMM.ImportantForegroundBrush" Color="{StaticResource DVS.TextImportant}" />
    <SolidColorBrush x:Key="IMM.SelectionForegroundBrush" Color="{StaticResource DVS.TextImportant}" />
    <SolidColorBrush x:Key="IMM.LinkForegroundBrush" Color="{StaticResource DVS.TextImportant}" />
    <SolidColorBrush x:Key="IMM.SuccessBrush" Color="{StaticResource DVS.ElementBright}" />
    <SolidColorBrush x:Key="IMM.RowHoverBrush" Color="{StaticResource DVS.Element}" Opacity="0.3" />
    <SolidColorBrush x:Key="IMM.RowSelectionBrush" Color="{StaticResource DVS.ElementBright}" Opacity="0.35" />
    <SolidColorBrush x:Key="IMM.ScrollBarThumbBrush" Color="{StaticResource DVS.Element}" />
    <SolidColorBrush x:Key="IMM.SearchBoxBackgroundBrush" Color="{StaticResource DVS.Background}" />
    <SolidColorBrush x:Key="IMM.TagBackgroundBrush" Color="{StaticResource DVS.Background}" />
    <SolidColorBrush x:Key="IMM.TagBorderBrush" Color="{StaticResource DVS.ElementBright}" />
    <SolidColorBrush x:Key="IMM.DataGridHeaderBrush" Color="{StaticResource DVS.Element}" />
    <SolidColorBrush x:Key="IMM.DropdownGlyphBrush" Color="{StaticResource DVS.ElementBright}" />
    <SolidColorBrush x:Key="IMM.InputBackgroundBrush" Color="{StaticResource DVS.Background}" />
    <SolidColorBrush x:Key="IMM.WindowBackgroundBrush" Color="{StaticResource DVS.Foreground}" />
    <SolidColorBrush x:Key="IMM.AlertOverlayBrush" Color="{StaticResource DVS.TextImportant}" Opacity="0.45" />
    <SolidColorBrush x:Key="IMM.SuccessOverlayBrush" Color="{StaticResource DVS.ElementBright}" Opacity="0.6" />
    <SolidColorBrush x:Key="IMM.SubtleForegroundBrush" Color="{StaticResource DVS.Text}" Opacity="0.6" />
    <SolidColorBrush x:Key="IMM.ErrorBrush" Color="{StaticResource DVS.Error}" />

    <Style TargetType="{x:Type Menu}">
        <Setter Property="Background" Value="{StaticResource IMM.MenuBackgroundBrush}" />
        <Setter Property="Foreground" Value="{StaticResource IMM.ForegroundBrush}" />
        <Setter Property="BorderBrush" Value="{StaticResource IMM.BorderBrush}" />
    </Style>

    <Style x:Key="{x:Static MenuItem.SeparatorStyleKey}" TargetType="{x:Type Separator}">
        <Setter Property="Margin" Value="0,6,0,6" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type Separator}">
                    <Grid Height="8"
                          Background="{StaticResource IMM.MenuBackgroundBrush}"
                          SnapsToDevicePixels="True">
                        <Border Height="1"
                                VerticalAlignment="Center"
                                Background="{StaticResource IMM.BorderBrush}" />
                    </Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <Style TargetType="{x:Type MenuItem}">
        <Setter Property="Foreground" Value="{StaticResource IMM.ForegroundBrush}" />
        <Setter Property="Background" Value="{StaticResource IMM.MenuBackgroundBrush}" />
        <Setter Property="BorderBrush" Value="{StaticResource IMM.BorderBrush}" />
        <Setter Property="BorderThickness" Value="0" />
        <Setter Property="Padding" Value="12,6,12,6" />
        <Style.Resources>
            <ControlTemplate x:Key="{x:Static MenuItem.TopLevelHeaderTemplateKey}"
                             TargetType="{x:Type MenuItem}">
                <Grid SnapsToDevicePixels="True">
                    <Border x:Name="Border"
                            Background="{TemplateBinding Background}"
                            BorderBrush="{TemplateBinding BorderBrush}"
                            BorderThickness="{TemplateBinding BorderThickness}">
                        <ContentPresenter x:Name="HeaderHost"
                                          Margin="{TemplateBinding Padding}"
                                          RecognizesAccessKey="True"
                                          ContentSource="Header"
                                          HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                          VerticalAlignment="{TemplateBinding VerticalContentAlignment}" />
                    </Border>
                    <Popup x:Name="PART_Popup"
                           Placement="Bottom"
                           HorizontalOffset="0"
                           VerticalOffset="0"
                           IsOpen="{TemplateBinding IsSubmenuOpen}"
                           AllowsTransparency="True"
                           Focusable="False"
                           PopupAnimation="Fade">
                        <Border x:Name="SubMenuBorder"
                                Background="{StaticResource IMM.MenuBackgroundBrush}"
                                BorderBrush="{StaticResource IMM.BorderBrush}"
                                BorderThickness="1"
                                SnapsToDevicePixels="True">
                            <ScrollViewer CanContentScroll="True">
                                <StackPanel IsItemsHost="True"
                                            KeyboardNavigation.DirectionalNavigation="Cycle" />
                            </ScrollViewer>
                        </Border>
                    </Popup>
                </Grid>
                <ControlTemplate.Triggers>
                    <Trigger Property="IsSuspendingPopupAnimation" Value="True">
                        <Setter TargetName="PART_Popup" Property="PopupAnimation" Value="None" />
                    </Trigger>
                    <Trigger Property="IsSubmenuOpen" Value="True">
                        <Setter TargetName="Border" Property="Background" Value="{StaticResource IMM.ElementBrush}" />
                        <Setter TargetName="Border" Property="BorderBrush" Value="{StaticResource IMM.BorderHoverBrush}" />
                        <Setter Property="Foreground" Value="{StaticResource IMM.TextBrush}" />
                    </Trigger>
                    <Trigger Property="IsHighlighted" Value="True">
                        <Setter TargetName="Border" Property="Background" Value="{StaticResource IMM.ElementBrush}" />
                        <Setter TargetName="Border" Property="BorderBrush" Value="{StaticResource IMM.BorderHoverBrush}" />
                    </Trigger>
                    <Trigger Property="IsEnabled" Value="False">
                        <Setter Property="Foreground" Value="{StaticResource IMM.SubtleForegroundBrush}" />
                    </Trigger>
                </ControlTemplate.Triggers>
            </ControlTemplate>
            <ControlTemplate x:Key="{x:Static MenuItem.TopLevelItemTemplateKey}"
                             TargetType="{x:Type MenuItem}">
                <Grid SnapsToDevicePixels="True">
                    <Border x:Name="Border"
                            Background="{TemplateBinding Background}"
                            BorderBrush="{TemplateBinding BorderBrush}"
                            BorderThickness="{TemplateBinding BorderThickness}">
                        <ContentPresenter Margin="{TemplateBinding Padding}"
                                          RecognizesAccessKey="True"
                                          ContentSource="Header"
                                          HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                          VerticalAlignment="{TemplateBinding VerticalContentAlignment}" />
                    </Border>
                </Grid>
                <ControlTemplate.Triggers>
                    <Trigger Property="IsHighlighted" Value="True">
                        <Setter TargetName="Border" Property="Background" Value="{StaticResource IMM.ElementBrush}" />
                        <Setter TargetName="Border" Property="BorderBrush" Value="{StaticResource IMM.BorderHoverBrush}" />
                    </Trigger>
                    <Trigger Property="IsEnabled" Value="False">
                        <Setter Property="Foreground" Value="{StaticResource IMM.SubtleForegroundBrush}" />
                    </Trigger>
                </ControlTemplate.Triggers>
            </ControlTemplate>
            <ControlTemplate x:Key="{x:Static MenuItem.SubmenuHeaderTemplateKey}"
                             TargetType="{x:Type MenuItem}">
                <Grid SnapsToDevicePixels="True">
                    <Border x:Name="Border"
                            Background="{TemplateBinding Background}"
                            BorderBrush="{TemplateBinding BorderBrush}"
                            BorderThickness="{TemplateBinding BorderThickness}"
                            Padding="{TemplateBinding Padding}">
                        <Grid VerticalAlignment="Center"
                              Grid.IsSharedSizeScope="True">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto" SharedSizeGroup="MenuItemCheckColumnGroup" />
                                <ColumnDefinition Width="Auto" SharedSizeGroup="MenuItemIconColumnGroup" />
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="Auto" SharedSizeGroup="MenuItemIGTColumnGroup" />
                                <ColumnDefinition Width="Auto" />
                            </Grid.ColumnDefinitions>
                            <TextBlock x:Name="CheckMark"
                                       Margin="0,0,8,0"
                                       VerticalAlignment="Center"
                                       Foreground="{TemplateBinding Foreground}"
                                       FontFamily="{TemplateBinding FontFamily}"
                                       FontSize="{TemplateBinding FontSize}"
                                       Text="â˜"
                                       Visibility="Collapsed" />
                            <ContentPresenter x:Name="Icon"
                                              Grid.Column="1"
                                              Margin="0,0,8,0"
                                              VerticalAlignment="Center"
                                              ContentSource="Icon"
                                              RecognizesAccessKey="True" />
                            <ContentPresenter x:Name="HeaderHost"
                                              Grid.Column="2"
                                              VerticalAlignment="Center"
                                              RecognizesAccessKey="True"
                                              ContentSource="Header"
                                              TextElement.Foreground="{TemplateBinding Foreground}" />
                            <TextBlock x:Name="InputGestureText"
                                       Grid.Column="3"
                                       Margin="24,0,0,0"
                                       VerticalAlignment="Center"
                                       Foreground="{TemplateBinding Foreground}"
                                       Text="{TemplateBinding InputGestureText}" />
                            <Path x:Name="Arrow"
                                  Grid.Column="4"
                                  Margin="12,0,0,0"
                                  VerticalAlignment="Center"
                                  Fill="{StaticResource IMM.DropdownGlyphBrush}"
                                  Data="M 0 0 L 4 4 L 0 8 Z"
                                  Visibility="Collapsed" />
                        </Grid>
                    </Border>
                    <Popup x:Name="PART_Popup"
                           Placement="Right"
                           HorizontalOffset="0"
                           VerticalOffset="-1"
                           IsOpen="{TemplateBinding IsSubmenuOpen}"
                           AllowsTransparency="True"
                           Focusable="False"
                           PopupAnimation="Fade">
                        <Border x:Name="SubMenuBorder"
                                Background="{StaticResource IMM.MenuBackgroundBrush}"
                                BorderBrush="{StaticResource IMM.BorderBrush}"
                                BorderThickness="1"
                                SnapsToDevicePixels="True">
                            <ScrollViewer CanContentScroll="True">
                                <StackPanel IsItemsHost="True"
                                            KeyboardNavigation.DirectionalNavigation="Cycle" />
                            </ScrollViewer>
                        </Border>
                    </Popup>
                </Grid>
                <ControlTemplate.Triggers>
                    <Trigger SourceName="Icon" Property="Content" Value="{x:Null}">
                        <Setter TargetName="Icon" Property="Visibility" Value="Collapsed" />
                    </Trigger>
                    <Trigger Property="InputGestureText" Value="">
                        <Setter TargetName="InputGestureText" Property="Visibility" Value="Collapsed" />
                    </Trigger>
                    <Trigger Property="InputGestureText" Value="{x:Null}">
                        <Setter TargetName="InputGestureText" Property="Visibility" Value="Collapsed" />
                    </Trigger>
                    <Trigger Property="IsCheckable" Value="True">
                        <Setter TargetName="CheckMark" Property="Visibility" Value="Visible" />
                    </Trigger>
                    <Trigger Property="IsChecked" Value="True">
                        <Setter TargetName="CheckMark" Property="Text" Value="ðŸ—¹" />
                    </Trigger>
                    <Trigger Property="IsChecked" Value="False">
                        <Setter TargetName="CheckMark" Property="Text" Value="â˜" />
                    </Trigger>
                    <Trigger Property="HasItems" Value="True">
                        <Setter TargetName="Arrow" Property="Visibility" Value="Visible" />
                    </Trigger>
                    <Trigger Property="IsSubmenuOpen" Value="True">
                        <Setter TargetName="Border" Property="Background" Value="{StaticResource IMM.ElementBrush}" />
                        <Setter TargetName="Border" Property="BorderBrush" Value="{StaticResource IMM.BorderHoverBrush}" />
                        <Setter Property="Foreground" Value="{StaticResource IMM.TextBrush}" />
                        <Setter TargetName="Arrow" Property="Fill" Value="{StaticResource IMM.TextBrush}" />
                    </Trigger>
                    <Trigger Property="IsHighlighted" Value="True">
                        <Setter TargetName="Border" Property="Background" Value="{StaticResource IMM.ElementBrush}" />
                        <Setter TargetName="Border" Property="BorderBrush" Value="{StaticResource IMM.BorderHoverBrush}" />
                        <Setter TargetName="Arrow" Property="Fill" Value="{StaticResource IMM.TextBrush}" />
                    </Trigger>
                    <Trigger Property="IsEnabled" Value="False">
                        <Setter Property="Foreground" Value="{StaticResource IMM.SubtleForegroundBrush}" />
                        <Setter TargetName="Arrow" Property="Fill" Value="{StaticResource IMM.SubtleForegroundBrush}" />
                    </Trigger>
                </ControlTemplate.Triggers>
            </ControlTemplate>
            <ControlTemplate x:Key="{x:Static MenuItem.SubmenuItemTemplateKey}"
                             TargetType="{x:Type MenuItem}">
                <Grid SnapsToDevicePixels="True">
                    <Border x:Name="Border"
                            Background="{TemplateBinding Background}"
                            BorderBrush="{TemplateBinding BorderBrush}"
                            BorderThickness="{TemplateBinding BorderThickness}"
                            Padding="{TemplateBinding Padding}">
                        <Grid VerticalAlignment="Center"
                              Grid.IsSharedSizeScope="True">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto" SharedSizeGroup="MenuItemCheckColumnGroup" />
                                <ColumnDefinition Width="Auto" SharedSizeGroup="MenuItemIconColumnGroup" />
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="Auto" SharedSizeGroup="MenuItemIGTColumnGroup" />
                                <ColumnDefinition Width="Auto" />
                            </Grid.ColumnDefinitions>
                            <TextBlock x:Name="CheckMark"
                                       Margin="0,0,8,0"
                                       VerticalAlignment="Center"
                                       Foreground="{TemplateBinding Foreground}"
                                       FontFamily="{TemplateBinding FontFamily}"
                                       FontSize="{TemplateBinding FontSize}"
                                       Text="â˜"
                                       Visibility="Collapsed" />
                            <ContentPresenter x:Name="Icon"
                                              Grid.Column="1"
                                              Margin="0,0,8,0"
                                              VerticalAlignment="Center"
                                              ContentSource="Icon"
                                              RecognizesAccessKey="True" />
                            <ContentPresenter x:Name="HeaderHost"
                                              Grid.Column="2"
                                              VerticalAlignment="Center"
                                              RecognizesAccessKey="True"
                                              ContentSource="Header"
                                              TextElement.Foreground="{TemplateBinding Foreground}" />
                            <TextBlock x:Name="InputGestureText"
                                       Grid.Column="3"
                                       Margin="24,0,0,0"
                                       VerticalAlignment="Center"
                                       Foreground="{TemplateBinding Foreground}"
                                       Text="{TemplateBinding InputGestureText}" />
                            <Path x:Name="Arrow"
                                  Grid.Column="4"
                                  Margin="12,0,0,0"
                                  VerticalAlignment="Center"
                                  Fill="{StaticResource IMM.DropdownGlyphBrush}"
                                  Data="M 0 0 L 4 4 L 0 8 Z"
                                  Visibility="Collapsed" />
                        </Grid>
                    </Border>
                </Grid>
                <ControlTemplate.Triggers>
                    <Trigger SourceName="Icon" Property="Content" Value="{x:Null}">
                        <Setter TargetName="Icon" Property="Visibility" Value="Collapsed" />
                    </Trigger>
                    <Trigger Property="InputGestureText" Value="">
                        <Setter TargetName="InputGestureText" Property="Visibility" Value="Collapsed" />
                    </Trigger>
                    <Trigger Property="InputGestureText" Value="{x:Null}">
                        <Setter TargetName="InputGestureText" Property="Visibility" Value="Collapsed" />
                    </Trigger>
                    <Trigger Property="IsCheckable" Value="True">
                        <Setter TargetName="CheckMark" Property="Visibility" Value="Visible" />
                    </Trigger>
                    <Trigger Property="IsChecked" Value="True">
                        <Setter TargetName="CheckMark" Property="Text" Value="ðŸ—¹" />
                    </Trigger>
                    <Trigger Property="IsChecked" Value="False">
                        <Setter TargetName="CheckMark" Property="Text" Value="â˜" />
                    </Trigger>
                    <Trigger Property="HasItems" Value="True">
                        <Setter TargetName="Arrow" Property="Visibility" Value="Visible" />
                    </Trigger>
                    <Trigger Property="IsHighlighted" Value="True">
                        <Setter TargetName="Border" Property="Background" Value="{StaticResource IMM.ElementBrush}" />
                        <Setter TargetName="Border" Property="BorderBrush" Value="{StaticResource IMM.BorderHoverBrush}" />
                        <Setter TargetName="Arrow" Property="Fill" Value="{StaticResource IMM.TextBrush}" />
                    </Trigger>
                    <Trigger Property="IsEnabled" Value="False">
                        <Setter Property="Foreground" Value="{StaticResource IMM.SubtleForegroundBrush}" />
                        <Setter TargetName="Arrow" Property="Fill" Value="{StaticResource IMM.SubtleForegroundBrush}" />
                    </Trigger>
                </ControlTemplate.Triggers>
            </ControlTemplate>
        </Style.Resources>
    </Style>
</ResourceDictionary>
