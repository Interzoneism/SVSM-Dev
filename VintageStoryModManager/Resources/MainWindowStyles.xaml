<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                    xmlns:converters="clr-namespace:VintageStoryModManager.Converters"
                    xmlns:views="clr-namespace:VintageStoryModManager.Views"
                    xmlns:sys="clr-namespace:System;assembly=mscorlib">

    <!-- Converters and constants -->
    <converters:BooleanToVisibilityConverter x:Key="IMM.VisibleWhenTrueConverter" />
    <converters:BooleanToVisibilityConverter x:Key="IMM.VisibleWhenFalseConverter" IsInverted="True" />
    <converters:BooleanToVisibilityConverter x:Key="IMM.HiddenWhenFalseConverter" UseHidden="True" />
    <converters:RowPaddingOffsetConverter x:Key="IMM.RowPaddingOffsetConverter" />
    <Thickness x:Key="IMM.RowPaddingBase">0,0,0,0</Thickness>
    <sys:Double x:Key="IMM.NormalRowHeightOffset">10</sys:Double>
    <sys:Double x:Key="IMM.CompactRowHeightOffset">-12</sys:Double>
    <sys:Double x:Key="IMM.ModDbCardScale">0.75</sys:Double>
    <converters:DownloadMetricDisplayConverter x:Key="IMM.DownloadMetricDisplayConverter" />
    <sys:Double x:Key="IMM.TagRowMaxHeight">70</sys:Double>
    <sys:Double x:Key="IMM.TagRowCompactMaxHeight">35</sys:Double>

    <!-- Tag badge styles -->
    <Style x:Key="IMM.TagBadgeBorderStyle" TargetType="{x:Type Border}">
        <Setter Property="Background" Value="{DynamicResource Brush.Panel.Secondary.Background.Solid}" />
        <Setter Property="BorderBrush" Value="{DynamicResource Brush.Accent.Primary}" />
        <Setter Property="BorderThickness" Value="1" />
        <Setter Property="CornerRadius" Value="10" />
        <Setter Property="Padding" Value="8,2" />
        <Setter Property="Margin" Value="0,0,0,0" />
    </Style>

    <ItemsPanelTemplate x:Key="IMM.TagItemsPanelTemplate">
        <views:OverlappingTagPanel />
    </ItemsPanelTemplate>

    <ItemsPanelTemplate x:Key="IMM.TagFilterItemsPanelTemplate">
        <UniformGrid Columns="4" HorizontalAlignment="Left" />
    </ItemsPanelTemplate>

    <DataTemplate x:Key="IMM.TagBadgeTemplate">
        <Border Style="{StaticResource IMM.TagBadgeBorderStyle}">
            <TextBlock Text="{Binding}" FontSize="12" Foreground="{DynamicResource Brush.Text.Primary}" />
        </Border>
    </DataTemplate>

    <Style x:Key="IMM.TagFilterToggleButtonStyle" TargetType="{x:Type ToggleButton}">
        <Setter Property="ContentTemplate" Value="{StaticResource IMM.TagBadgeTemplate}" />
        <Setter Property="Background" Value="Transparent" />
        <Setter Property="BorderThickness" Value="0" />
        <Setter Property="Padding" Value="0" />
        <Setter Property="Margin" Value="0,0,6,6" />
        <Setter Property="HorizontalAlignment" Value="Stretch" />
        <Setter Property="VerticalAlignment" Value="Center" />
        <Setter Property="HorizontalContentAlignment" Value="Center" />
        <Setter Property="VerticalContentAlignment" Value="Center" />
        <Setter Property="Opacity" Value="1" />
        <Setter Property="Focusable" Value="False" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type ToggleButton}">
                    <Border Background="{TemplateBinding Background}" Padding="{TemplateBinding Padding}">
                        <ContentPresenter Content="{TemplateBinding Content}"
                                          ContentTemplate="{TemplateBinding ContentTemplate}"
                                          HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                          VerticalAlignment="{TemplateBinding VerticalContentAlignment}" />
                    </Border>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
        <Style.Triggers>
            <Trigger Property="IsChecked" Value="False">
                <Setter Property="Opacity" Value="0.5" />
            </Trigger>
        </Style.Triggers>
    </Style>

    <Style x:Key="IMM.TagHeaderToggleButtonStyle" TargetType="{x:Type ToggleButton}">
        <Setter Property="Background" Value="Transparent" />
        <Setter Property="BorderThickness" Value="0" />
        <Setter Property="Padding" Value="0" />
        <Setter Property="HorizontalAlignment" Value="Stretch" />
        <Setter Property="VerticalAlignment" Value="Stretch" />
        <Setter Property="HorizontalContentAlignment" Value="Left" />
        <Setter Property="VerticalContentAlignment" Value="Center" />
        <Setter Property="Focusable" Value="False" />
        <Setter Property="Cursor" Value="Hand" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type ToggleButton}">
                    <Border Background="{TemplateBinding Background}" Padding="{TemplateBinding Padding}">
                        <ContentPresenter Content="{TemplateBinding Content}"
                                          ContentTemplate="{TemplateBinding ContentTemplate}"
                                          HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                          VerticalAlignment="{TemplateBinding VerticalContentAlignment}" />
                    </Border>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <!-- DataGrid styles -->
    <Style x:Key="IMM.DataGridCellBaseStyle" TargetType="{x:Type DataGridCell}">
        <Setter Property="Background" Value="Transparent" />
        <Setter Property="BorderBrush" Value="Transparent" />
        <Setter Property="BorderThickness" Value="0,0,0,0" />
        <Setter Property="Padding" Value="8,6" />
        <Setter Property="Foreground" Value="{DynamicResource Brush.Text.Primary}" />
        <Style.Triggers>
            <Trigger Property="IsSelected" Value="True">
                <Setter Property="Foreground" Value="{DynamicResource Brush.Text.Primary}" />
            </Trigger>
        </Style.Triggers>
    </Style>

    <Style x:Key="IMM.PrimaryDataGridColumnHeaderStyle" TargetType="{x:Type DataGridColumnHeader}">
        <Setter Property="Background" Value="{DynamicResource Brush.DataGrid.Header.Background}" />
        <Setter Property="BorderBrush" Value="{DynamicResource Brush.Panel.Secondary.Background.Solid}" />
        <Setter Property="BorderThickness" Value="1,0,0,1" />
        <Setter Property="Foreground" Value="{DynamicResource Brush.Text.Primary}" />
        <Setter Property="Margin" Value="0,0,0,6" />
        <Setter Property="Padding" Value="12,10" />
        <Setter Property="FontWeight" Value="SemiBold" />
        <Setter Property="HorizontalContentAlignment" Value="Left" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type DataGridColumnHeader}">
                    <Border x:Name="HeaderBorder"
                            Background="{TemplateBinding Background}"
                            BorderBrush="{TemplateBinding BorderBrush}"
                            BorderThickness="{TemplateBinding BorderThickness}"
                            Padding="{TemplateBinding Padding}"
                            SnapsToDevicePixels="True">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="Auto" />
                            </Grid.ColumnDefinitions>
                            <ContentPresenter Grid.Column="0"
                                              HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                              VerticalAlignment="{TemplateBinding VerticalContentAlignment}" />
                            <Path x:Name="SortArrow"
                                  Grid.Column="1"
                                  Width="6"
                                  Height="6"
                                  Margin="6,0,0,0"
                                  Fill="{DynamicResource Brush.Accent.Primary}"
                                  Stretch="Uniform"
                                  Visibility="Collapsed"
                                  VerticalAlignment="Center" />
                        </Grid>
                    </Border>
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsMouseOver" Value="True">
                            <Setter TargetName="HeaderBorder" Property="Background"
                                    Value="{DynamicResource Brush.DataGrid.Header.Background.Hover}" />
                        </Trigger>
                        <Trigger Property="SortDirection" Value="Ascending">
                            <Setter TargetName="SortArrow" Property="Visibility" Value="Visible" />
                            <Setter TargetName="SortArrow" Property="Data" Value="M 0 3 L 3 0 6 3 Z" />
                        </Trigger>
                        <Trigger Property="SortDirection" Value="Descending">
                            <Setter TargetName="SortArrow" Property="Visibility" Value="Visible" />
                            <Setter TargetName="SortArrow" Property="Data" Value="M 0 0 L 3 3 6 0 Z" />
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <!-- Mod tab button styles -->
    <Style x:Key="IMM.ModTabButtonBaseStyle"
           TargetType="{x:Type Button}"
           BasedOn="{StaticResource {x:Type Button}}">
        <Setter Property="Background" Value="{DynamicResource Brush.ModTabs.Background}" />
        <Setter Property="BorderBrush" Value="Transparent" />
        <Setter Property="BorderThickness" Value="0" />
        <Setter Property="Opacity" Value="0.5" />
        <Setter Property="Padding" Value="12,6" />
        <Setter Property="VerticalContentAlignment" Value="Top" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type Button}">
                    <Border x:Name="ButtonBackground"
                            Background="{TemplateBinding Background}"
                            Padding="{TemplateBinding Padding}">
                        <ContentPresenter HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                          VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
                                          RecognizesAccessKey="True" />
                    </Border>
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsEnabled" Value="False">
                            <Setter TargetName="ButtonBackground" Property="Opacity" Value="0.5" />
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <Style x:Key="IMM.InstalledTabButtonStyle"
           TargetType="{x:Type Button}"
           BasedOn="{StaticResource IMM.ModTabButtonBaseStyle}">
        <Style.Triggers>
            <MultiDataTrigger>
                <MultiDataTrigger.Conditions>
                    <Condition Binding="{Binding SearchModDatabase}" Value="False" />
                    <Condition Binding="{Binding IsViewingCloudModlists}" Value="False" />
                </MultiDataTrigger.Conditions>
                <Setter Property="Opacity" Value="1" />
            </MultiDataTrigger>
        </Style.Triggers>
    </Style>

    <Style x:Key="IMM.ModDatabaseTabButtonStyle"
           TargetType="{x:Type Button}"
           BasedOn="{StaticResource IMM.ModTabButtonBaseStyle}">
        <Style.Triggers>
            <DataTrigger Binding="{Binding SearchModDatabase}" Value="True">
                <Setter Property="Opacity" Value="1" />
            </DataTrigger>
        </Style.Triggers>
    </Style>

    <Style x:Key="IMM.ModDatabaseDownloadsTabButtonStyle"
           TargetType="{x:Type Button}"
           BasedOn="{StaticResource IMM.ModTabButtonBaseStyle}">
        <Style.Triggers>
            <DataTrigger Binding="{Binding IsModDatabaseDownloadsTabSelected}" Value="True">
                <Setter Property="Opacity" Value="1" />
            </DataTrigger>
        </Style.Triggers>
    </Style>

    <Style x:Key="IMM.ModDatabaseActivityTabButtonStyle"
           TargetType="{x:Type Button}"
           BasedOn="{StaticResource IMM.ModTabButtonBaseStyle}">
        <Style.Triggers>
            <DataTrigger Binding="{Binding IsModDatabaseActivityTabSelected}" Value="True">
                <Setter Property="Opacity" Value="1" />
            </DataTrigger>
        </Style.Triggers>
    </Style>

    <Style x:Key="IMM.ModlistsTabButtonStyle"
                  TargetType="{x:Type Button}"
           BasedOn="{StaticResource IMM.ModTabButtonBaseStyle}">
        <Style.Triggers>
            <DataTrigger Binding="{Binding IsViewingCloudModlists}" Value="True">
                <Setter Property="Opacity" Value="1" />
            </DataTrigger>
        </Style.Triggers>
    </Style>

    <!-- Menu item style shared by toggle and standard items -->
    <Style x:Key="ToggleMenuItemStyle" TargetType="{x:Type MenuItem}">
        <Setter Property="Background" Value="Transparent" />
        <Setter Property="BorderThickness" Value="0,0,0,0" />
        <Setter Property="Padding" Value="12,0,12,0" />
        <Setter Property="Foreground" Value="{DynamicResource Brush.Text.Primary}" />
        <Setter Property="BorderBrush" Value="Transparent" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type MenuItem}">
                    <Grid SnapsToDevicePixels="True">
                        <Border x:Name="templateRoot"
                                Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                Padding="{TemplateBinding Padding}"
                                SnapsToDevicePixels="True">
                            <Grid Grid.IsSharedSizeScope="True">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto" SharedSizeGroup="MenuItemCheckColumnGroup" />
                                    <ColumnDefinition Width="Auto" SharedSizeGroup="MenuItemIconColumnGroup" />
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="Auto" SharedSizeGroup="MenuItemIGTColumnGroup" />
                                    <ColumnDefinition Width="Auto" />
                                </Grid.ColumnDefinitions>

                                <TextBlock x:Name="CheckMark"
                                           Margin="0,0,8,0"
                                           VerticalAlignment="Center"
                                           FontFamily="{TemplateBinding FontFamily}"
                                           FontSize="{TemplateBinding FontSize}"
                                           Foreground="{TemplateBinding Foreground}"
                                           Text="â˜"
                                           Visibility="Collapsed" />

                                <ContentPresenter x:Name="Icon"
                                                  Grid.Column="1"
                                                  Margin="0,0,8,0"
                                                  VerticalAlignment="Center"
                                                  ContentSource="Icon"
                                                  RecognizesAccessKey="True"
                                                  SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" />

                                <ContentPresenter x:Name="HeaderHost"
                                                  Grid.Column="2"
                                                  VerticalAlignment="Center"
                                                  RecognizesAccessKey="True"
                                                  ContentSource="Header"
                                                  TextElement.Foreground="{TemplateBinding Foreground}" />

                                <TextBlock x:Name="InputGestureText"
                                           Grid.Column="3"
                                           Margin="24,0,0,0"
                                           VerticalAlignment="Center"
                                           Foreground="{TemplateBinding Foreground}"
                                           Text="{TemplateBinding InputGestureText}"
                                           Visibility="Visible" />

                                <TextBlock x:Name="ArrowGlyph"
                                           Grid.Column="4"
                                           Margin="24,0,0,0"
                                           VerticalAlignment="Center"
                                           Foreground="{TemplateBinding Foreground}"
                                           Text="â–¶"
                                           Visibility="Collapsed" />
                            </Grid>
                        </Border>

                        <Popup x:Name="SubMenuPopup"
                               AllowsTransparency="True"
                               Focusable="False"
                               Placement="Right"
                               PlacementTarget="{Binding ElementName=templateRoot}"
                               HorizontalOffset="-2"
                               VerticalOffset="-3"
                               IsOpen="{Binding IsSubmenuOpen, RelativeSource={RelativeSource TemplatedParent}}">
                            <Border Margin="0,0,0,4"
                                    Background="{DynamicResource Brush.Panel.Primary.Background.Solid}"
                                    BorderBrush="{DynamicResource Brush.Menu.Item.Background.Hover}"
                                    BorderThickness="4"
                                    MinWidth="{Binding ActualWidth, ElementName=templateRoot}"
                                    SnapsToDevicePixels="True">
                                <ScrollViewer CanContentScroll="False"
                                              Focusable="False"
                                              HorizontalScrollBarVisibility="Hidden"
                                              VerticalScrollBarVisibility="Auto">
                                    <ItemsPresenter Margin="4" />
                                </ScrollViewer>
                            </Border>
                        </Popup>
                    </Grid>

                    <ControlTemplate.Triggers>
                        <Trigger SourceName="Icon" Property="Content" Value="{x:Null}">
                            <Setter TargetName="Icon" Property="Visibility" Value="Collapsed" />
                        </Trigger>

                        <Trigger Property="InputGestureText" Value="">
                            <Setter TargetName="InputGestureText" Property="Visibility" Value="Collapsed" />
                        </Trigger>

                        <Trigger Property="InputGestureText" Value="{x:Null}">
                            <Setter TargetName="InputGestureText" Property="Visibility" Value="Collapsed" />
                        </Trigger>

                        <Trigger Property="HasItems" Value="True">
                            <Setter TargetName="ArrowGlyph" Property="Visibility" Value="Visible" />
                        </Trigger>

                        <Trigger Property="Role" Value="TopLevelHeader">
                            <Setter TargetName="SubMenuPopup" Property="Placement" Value="Bottom" />
                            <Setter TargetName="SubMenuPopup" Property="HorizontalOffset" Value="0" />
                            <Setter TargetName="SubMenuPopup" Property="VerticalOffset" Value="0" />
                            <Setter TargetName="ArrowGlyph" Property="Visibility" Value="Collapsed" />
                        </Trigger>

                        <Trigger Property="Role" Value="SubmenuHeader">
                            <Setter TargetName="ArrowGlyph" Property="Text" Value="â–¶" />
                        </Trigger>

                        <Trigger Property="IsCheckable" Value="True">
                            <Setter TargetName="CheckMark" Property="Visibility" Value="Visible" />
                            <Setter Property="StaysOpenOnClick" Value="True" />
                        </Trigger>

                        <Trigger Property="IsCheckable" Value="False">
                            <Setter TargetName="CheckMark" Property="Visibility" Value="Collapsed" />
                            <Setter Property="StaysOpenOnClick" Value="False" />
                        </Trigger>

                        <Trigger Property="IsChecked" Value="True">
                            <Setter TargetName="CheckMark" Property="Visibility" Value="Visible" />
                            <Setter TargetName="CheckMark" Property="Text" Value="ðŸ—¹" />
                        </Trigger>

                        <Trigger Property="IsChecked" Value="False">
                            <Setter TargetName="CheckMark" Property="Text" Value="â˜" />
                        </Trigger>

                        <Trigger Property="IsHighlighted" Value="True">
                            <Setter TargetName="templateRoot" Property="Background"
                                    Value="{DynamicResource Brush.Menu.Item.Background.Hover}" />
                            <Setter TargetName="templateRoot" Property="BorderBrush"
                                    Value="{DynamicResource Brush.Border.Hover}" />
                            <Setter Property="Foreground" Value="{DynamicResource Brush.Text.Primary}" />
                        </Trigger>

                        <Trigger Property="IsEnabled" Value="False">
                            <Setter Property="Foreground" Value="{DynamicResource Brush.Text.Placeholder}" />
                        </Trigger>

                        <Trigger Property="IsSubmenuOpen" Value="True">
                            <Setter TargetName="templateRoot" Property="Background"
                                    Value="{DynamicResource Brush.Menu.Item.Background.Hover}" />
                            <Setter TargetName="templateRoot" Property="BorderBrush"
                                    Value="{DynamicResource Brush.Border.Hover}" />
                            <Setter Property="Foreground" Value="{DynamicResource Brush.Text.Primary}" />
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <Style x:Key="ButtonStyle1" TargetType="{x:Type Button}" BasedOn="{StaticResource {x:Type Button}}">
        <Setter Property="Background" Value="Transparent" />
        <Setter Property="BorderBrush" Value="Transparent" />
        <Setter Property="BorderThickness" Value="0" />
    </Style>

    <!-- Icon button style for icon-only buttons -->
    <Style x:Key="IconButtonStyle" TargetType="{x:Type Button}">
        <Setter Property="Background" Value="{DynamicResource Brush.Button.Primary.Background.Normal}" />
        <Setter Property="BorderBrush" Value="{DynamicResource Brush.Button.Bevel.Dark}" />
        <Setter Property="BorderThickness" Value="0,0,1,1" />
        <Setter Property="Padding" Value="4" />
        <Setter Property="Cursor" Value="Hand" />
        <Setter Property="HorizontalContentAlignment" Value="Center" />
        <Setter Property="VerticalContentAlignment" Value="Center" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type Button}">
                    <Border x:Name="ButtonBorder"
                            Background="{TemplateBinding Background}"
                            BorderBrush="{TemplateBinding BorderBrush}"
                            BorderThickness="{TemplateBinding BorderThickness}"
                            CornerRadius="4"
                            UseLayoutRounding="True"
                            Padding="{TemplateBinding Padding}">
                        <ContentPresenter HorizontalAlignment="Center"
                                          VerticalAlignment="Center"
                                          RecognizesAccessKey="True" />
                    </Border>
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsMouseOver" Value="True">
                            <Setter TargetName="ButtonBorder" Property="Background"
                                    Value="{DynamicResource Brush.Button.Primary.Background.Hover}" />
                        </Trigger>
                        <Trigger Property="IsPressed" Value="True">
                            <Setter TargetName="ButtonBorder" Property="Background"
                                    Value="{DynamicResource Brush.Button.Primary.Background.Pressed}" />
                        </Trigger>
                        <Trigger Property="IsEnabled" Value="False">
                            <Setter TargetName="ButtonBorder" Property="Opacity" Value="1" />
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <!-- DataGrid column TextBlock styles -->
    <Style x:Key="IMM.DataGridCenteredTextStyle" TargetType="{x:Type TextBlock}">
        <Setter Property="HorizontalAlignment" Value="Center" />
        <Setter Property="VerticalAlignment" Value="Center" />
        <Setter Property="TextAlignment" Value="Center" />
    </Style>

    <Style x:Key="IMM.DataGridCenteredCellStyle" TargetType="{x:Type DataGridCell}"
           BasedOn="{StaticResource IMM.DataGridCellBaseStyle}">
        <Setter Property="HorizontalContentAlignment" Value="Center" />
        <Setter Property="VerticalContentAlignment" Value="Center" />
    </Style>


    <Style x:Key="IMM.ToggleCheckBoxStyle" TargetType="{x:Type CheckBox}">
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type CheckBox}">
                    <Grid Background="Transparent">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="*" />
                        </Grid.ColumnDefinitions>

                        <TextBlock x:Name="CheckMark"
                               Grid.Column="0"
                               Margin="0,0,8,0"
                               VerticalAlignment="Center"
                               FontFamily="{TemplateBinding FontFamily}"
                               FontSize="16"
                               Foreground="{TemplateBinding Foreground}"
                               Text="â˜" />

                        <ContentPresenter Grid.Column="1"
                                      Margin="{TemplateBinding Padding}"
                                      VerticalAlignment="Center"
                                      RecognizesAccessKey="True" />
                    </Grid>

                    <ControlTemplate.Triggers>
                        <Trigger Property="IsChecked" Value="True">
                            <Setter TargetName="CheckMark" Property="Text" Value="ðŸ—¹" />
                        </Trigger>
                        <Trigger Property="IsChecked" Value="False">
                            <Setter TargetName="CheckMark" Property="Text" Value="â˜" />
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <Style x:Key="IMM.ToggleRadioButtonStyle" TargetType="{x:Type RadioButton}">
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type RadioButton}">
                    <Grid Background="Transparent">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="*" />
                        </Grid.ColumnDefinitions>

                        <TextBlock x:Name="RadioMark"
                               Grid.Column="0"
                               Margin="0,0,4,0"
                               VerticalAlignment="Center"
                               FontFamily="{TemplateBinding FontFamily}"
                               FontSize="16"
                               Foreground="{TemplateBinding Foreground}"
                               Text="â—‹" />

                        <ContentPresenter Grid.Column="1"
                                      Margin="{TemplateBinding Padding}"
                                      VerticalAlignment="Center"
                                      RecognizesAccessKey="True" />
                    </Grid>

                    <ControlTemplate.Triggers>
                        <Trigger Property="IsChecked" Value="True">
                            <Setter TargetName="RadioMark" Property="Text" Value="â—‰" />
                        </Trigger>
                        <Trigger Property="IsChecked" Value="False">
                            <Setter TargetName="RadioMark" Property="Text" Value="â—‹" />
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <!-- Middle tab control header style -->
    <Style x:Key="IMM.MiddleTabItemStyle" TargetType="{x:Type TabItem}">
        <Setter Property="Foreground" Value="{DynamicResource Brush.Text.Primary}" />
        <Setter Property="Background" Value="{DynamicResource Brush.Button.Primary.Background.Normal}" />
        <Setter Property="BorderBrush" Value="{DynamicResource Brush.MiddleTab.Border.Normal}" />
        <Setter Property="BorderThickness" Value="0,0,0,0" />
        <Setter Property="HorizontalContentAlignment" Value="Stretch" />
        <Setter Property="VerticalContentAlignment" Value="Stretch" />
        <Setter Property="Padding" Value="20,10" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type TabItem}">
                    <Grid SnapsToDevicePixels="True" Background="Transparent">
                        <Border x:Name="TabBorder"
                                Margin="0,0,0,-1"
                                CornerRadius="6,6,0,0"
                                Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}">
                            <ContentPresenter x:Name="ContentSite"
                                              ContentSource="Header"
                                              HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                              VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
                                              Margin="{TemplateBinding Padding}"
                                              TextElement.FontSize="14"
                                              RecognizesAccessKey="True" />
                        </Border>
                    </Grid>
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsSelected" Value="True">
                            <Setter Property="Panel.ZIndex" Value="1" />
                            <Setter TargetName="TabBorder" Property="Background"
                                    Value="{DynamicResource Brush.MiddleTab.Background.Selected}" />
                            <Setter TargetName="TabBorder" Property="BorderBrush"
                                    Value="{DynamicResource Brush.MiddleTab.Border.Selected}" />
                        </Trigger>
                        <MultiTrigger>
                            <MultiTrigger.Conditions>
                                <Condition Property="IsMouseOver" Value="True" />
                                <Condition Property="IsSelected" Value="False" />
                            </MultiTrigger.Conditions>
                            <Setter TargetName="TabBorder" Property="Background"
                                    Value="{DynamicResource Brush.Button.Primary.Background.Hover}" />
                        </MultiTrigger>
                        <Trigger Property="IsSelected" Value="False">
                            <Setter Property="Opacity" Value="0.5"> </Setter>
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <!-- Inner modlists tab control header style -->
    <Style x:Key="IMM.InnerModlistsTabItemStyle" TargetType="{x:Type TabItem}">
        <Setter Property="Foreground" Value="{DynamicResource Brush.Text.Primary}" />
        <Setter Property="Background" Value="{DynamicResource Brush.Button.Primary.Background.Disabled}" />
        <Setter Property="BorderThickness" Value="0,0,0,0" />
        <Setter Property="HorizontalContentAlignment" Value="Stretch" />
        <Setter Property="VerticalContentAlignment" Value="Stretch" />
        <Setter Property="Padding" Value="20,10" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type TabItem}">
                    <Grid SnapsToDevicePixels="True" Background="Transparent">
                        <Border x:Name="TabBorder"
                            Margin="0,0,0,-1"
                            CornerRadius="6,6,0,0"
                            Background="{TemplateBinding Background}"
                            BorderBrush="{TemplateBinding BorderBrush}"
                            BorderThickness="{TemplateBinding BorderThickness}">
                            <ContentPresenter x:Name="ContentSite"
                                          ContentSource="Header"
                                          HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                          VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
                                          Margin="{TemplateBinding Padding}"
                                          TextElement.FontSize="14"
                                          RecognizesAccessKey="True" />
                        </Border>
                    </Grid>
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsSelected" Value="True">
                            <Setter Property="Panel.ZIndex" Value="1" />
                            <Setter TargetName="TabBorder" Property="Background"
                                Value="{DynamicResource Brush.MiddleTab.ModTab.Selected}" />
                            <Setter TargetName="TabBorder" Property="BorderBrush"
                                Value="{DynamicResource Brush.MiddleTab.ModTab.Selected}" />
                        </Trigger>
                        <MultiTrigger>
                            <MultiTrigger.Conditions>
                                <Condition Property="IsMouseOver" Value="True" />
                                <Condition Property="IsSelected" Value="False" />
                            </MultiTrigger.Conditions>
                            <Setter TargetName="TabBorder" Property="Background"
                                Value="{DynamicResource Brush.Button.Primary.Background.Hover}" />
                        </MultiTrigger>
                        <Trigger Property="IsSelected" Value="False">
                            <Setter Property="Opacity" Value="0.5"></Setter>
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <!-- Base DataGrid row style for installed mods and mod database grids -->
    <Style x:Key="IMM.ModsDataGridRowBaseStyle" TargetType="{x:Type DataGridRow}">
        <Setter Property="Background" Value="Transparent" />
        <Setter Property="BorderBrush"
            Value="{DynamicResource Brush.InstalledMod.Row.Border}" />
        <Setter Property="BorderThickness" Value="0" />
        <Setter Property="Margin" Value="2,2,2,2" />
        <Setter Property="UseLayoutRounding" Value="True" />
        <Setter Property="Padding">
            <Setter.Value>
                <MultiBinding
                    Converter="{StaticResource IMM.RowPaddingOffsetConverter}">
                    <Binding Source="{StaticResource IMM.RowPaddingBase}" />
                    <Binding Source="{StaticResource IMM.NormalRowHeightOffset}" />
                </MultiBinding>
            </Setter.Value>
        </Setter>
        <Setter Property="Height" Value="{x:Static sys:Double.NaN}" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type DataGridRow}">
                    <!-- The brushes here come from InstalledMods_Row_* resources in Resources/Themes. -->
                    <Border x:Name="RowBorder"
                        Background="{DynamicResource Brush.InstalledMod.Row.Background}"
                        BorderBrush="{TemplateBinding BorderBrush}"
                        BorderThickness="{TemplateBinding BorderThickness}"
                        CornerRadius="8"
                        Margin="4,0,4,4"
                        SnapsToDevicePixels="True">
                        <Border.Effect>
                            <DropShadowEffect
                                Color="{Binding Color, Source={StaticResource Brush.DataGrid.RowShadow}}"
                                BlurRadius="2" Direction="210" ShadowDepth="2"
                                Opacity="0.5" />

                        </Border.Effect>
                        <Grid>
                            <Border x:Name="SelectionOverlay"
                                Background="{DynamicResource Brush.Accent.Primary}"
                                Opacity="0"
                                CornerRadius="8"
                                IsHitTestVisible="False" />
                            <Border x:Name="HoverOverlay"
                                Background="{DynamicResource Brush.Button.Primary.Background.Hover}"
                                Opacity="0"
                                CornerRadius="8"
                                IsHitTestVisible="False" />
                            <Border Padding="{TemplateBinding Padding}"
                                Background="Transparent"
                                CornerRadius="8">
                                <SelectiveScrollingGrid>
                                    <SelectiveScrollingGrid.ColumnDefinitions>
                                        <ColumnDefinition Width="*" />
                                    </SelectiveScrollingGrid.ColumnDefinitions>
                                    <SelectiveScrollingGrid.RowDefinitions>
                                        <RowDefinition Height="*" />
                                        <RowDefinition Height="Auto" />
                                    </SelectiveScrollingGrid.RowDefinitions>
                                    <DataGridCellsPresenter Grid.Column="0"
                                        SelectiveScrollingGrid.SelectiveScrollingOrientation="Both" />
                                    <DataGridDetailsPresenter Grid.Column="0"
                                        Grid.Row="1"
                                        SelectiveScrollingGrid.SelectiveScrollingOrientation="Horizontal"
                                        Visibility="{TemplateBinding DetailsVisibility}" />
                                </SelectiveScrollingGrid>
                            </Border>
                        </Grid>
                    </Border>
                    <ControlTemplate.Triggers>
                        <DataTrigger Binding="{Binding HasErrors}" Value="True">
                            <Setter TargetName="RowBorder" Property="Background"
                                Value="{DynamicResource Brush.Overlay.Warning.Background}" />
                        </DataTrigger>
                        <DataTrigger Binding="{Binding HasActivationError}"
                            Value="True">
                            <Setter TargetName="RowBorder" Property="Background"
                                Value="{DynamicResource Brush.Overlay.Warning.Background}" />
                        </DataTrigger>
                        <DataTrigger Binding="{Binding IsActive}" Value="False">
                            <Setter TargetName="RowBorder" Property="Background"
                                Value="{DynamicResource Brush.ModCard.Background.Disabled}" />
                            <Setter TargetName="RowBorder" Property="Opacity"
                                Value="0.5" />
                        </DataTrigger>
                        <Trigger Property="DetailsVisibility" Value="Visible">
                            <Setter TargetName="RowBorder" Property="BorderThickness"
                                Value="2,2,2,2" />
                        </Trigger>
                        <MultiTrigger>
                            <MultiTrigger.Conditions>
                                <Condition Property="IsMouseOver" Value="True" />
                                <Condition Property="IsSelected" Value="False" />
                            </MultiTrigger.Conditions>
                            <Setter TargetName="RowBorder" Property="BorderBrush"
                                Value="{DynamicResource Brush.Button.Primary.Background.Hover}" />
                        </MultiTrigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
        <Style.Triggers>
            <DataTrigger
                Binding="{Binding DataContext.IsCompactView, RelativeSource={RelativeSource AncestorType={x:Type Window}}}"
                Value="True">
                <Setter Property="Padding">
                    <Setter.Value>
                        <MultiBinding
                            Converter="{StaticResource IMM.RowPaddingOffsetConverter}">
                            <Binding Source="{StaticResource IMM.RowPaddingBase}" />
                            <Binding
                                Source="{StaticResource IMM.CompactRowHeightOffset}" />
                        </MultiBinding>
                    </Setter.Value>
                </Setter>
            </DataTrigger>
            <DataTrigger Binding="{Binding HasErrors}" Value="True">
                <Setter Property="Background"
                    Value="{DynamicResource Brush.Overlay.Warning.Background}" />
            </DataTrigger>
            <DataTrigger Binding="{Binding HasActivationError}" Value="True">
                <Setter Property="Background"
                    Value="{DynamicResource Brush.Overlay.Warning.Background}" />
            </DataTrigger>
            <Trigger Property="IsSelected" Value="True">
                <Setter Property="Background"
                    Value="{DynamicResource Brush.DataGrid.Row.Background.Selected}" />
                <Setter Property="BorderBrush"
                    Value="{DynamicResource Brush.Accent.Primary}" />
            </Trigger>
        </Style.Triggers>
    </Style>

    <!-- Base DataGrid row style for mod database grid (without IsActive trigger)
         Note: This style is nearly identical to IMM.ModsDataGridRowBaseStyle, but WPF
         ControlTemplates cannot be partially inherited. The only difference is the 
         IsActive DataTrigger in ControlTemplate.Triggers which dims disabled mods.
         The ModDB grid shows search results that don't have an IsActive property, 
         so this trigger must be removed. -->
    <Style x:Key="IMM.ModDbDataGridRowBaseStyle" TargetType="{x:Type DataGridRow}">
        <Setter Property="Background" Value="Transparent" />
        <Setter Property="BorderBrush"
            Value="{DynamicResource Brush.InstalledMod.Row.Border}" />
        <Setter Property="BorderThickness" Value="0" />
        <Setter Property="Margin" Value="2,2,2,2" />
        <Setter Property="Padding">
            <Setter.Value>
                <MultiBinding
                    Converter="{StaticResource IMM.RowPaddingOffsetConverter}">
                    <Binding Source="{StaticResource IMM.RowPaddingBase}" />
                    <Binding Source="{StaticResource IMM.NormalRowHeightOffset}" />
                </MultiBinding>
            </Setter.Value>
        </Setter>
        <Setter Property="Height" Value="{x:Static sys:Double.NaN}" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type DataGridRow}">
                    <!-- The brushes here come from InstalledMods_Row_* resources in Resources/Themes. -->
                    <Border x:Name="RowBorder"
                        Background="{DynamicResource Brush.InstalledMod.Row.Background}"
                        BorderBrush="{TemplateBinding BorderBrush}"
                        BorderThickness="{TemplateBinding BorderThickness}"
                        CornerRadius="8"
                        Margin="4,0,4,4"
                        SnapsToDevicePixels="True">
                        <Border.Effect>
                            <DropShadowEffect
                                Color="{Binding Color, Source={StaticResource Brush.DataGrid.RowShadow}}"
                                BlurRadius="2" Direction="210" ShadowDepth="2"
                                Opacity="0.5" />

                        </Border.Effect>
                        <Grid>
                            <Border x:Name="SelectionOverlay"
                                Background="{DynamicResource Brush.Accent.Primary}"
                                Opacity="0"
                                CornerRadius="8"
                                IsHitTestVisible="False" />
                            <Border x:Name="HoverOverlay"
                                Background="{DynamicResource Brush.Button.Primary.Background.Hover}"
                                Opacity="0"
                                CornerRadius="8"
                                IsHitTestVisible="False" />
                            <Border Padding="{TemplateBinding Padding}"
                                Background="Transparent"
                                CornerRadius="8">
                                <SelectiveScrollingGrid>
                                    <SelectiveScrollingGrid.ColumnDefinitions>
                                        <ColumnDefinition Width="*" />
                                    </SelectiveScrollingGrid.ColumnDefinitions>
                                    <SelectiveScrollingGrid.RowDefinitions>
                                        <RowDefinition Height="*" />
                                        <RowDefinition Height="Auto" />
                                    </SelectiveScrollingGrid.RowDefinitions>
                                    <DataGridCellsPresenter Grid.Column="0"
                                        SelectiveScrollingGrid.SelectiveScrollingOrientation="Both" />
                                    <DataGridDetailsPresenter Grid.Column="0"
                                        Grid.Row="1"
                                        SelectiveScrollingGrid.SelectiveScrollingOrientation="Horizontal"
                                        Visibility="{TemplateBinding DetailsVisibility}" />
                                </SelectiveScrollingGrid>
                            </Border>
                        </Grid>
                    </Border>
                    <ControlTemplate.Triggers>
                        <DataTrigger Binding="{Binding HasErrors}" Value="True">
                            <Setter TargetName="RowBorder" Property="Background"
                                Value="{DynamicResource Brush.Overlay.Warning.Background}" />
                        </DataTrigger>
                        <DataTrigger Binding="{Binding HasActivationError}"
                            Value="True">
                            <Setter TargetName="RowBorder" Property="Background"
                                Value="{DynamicResource Brush.Overlay.Warning.Background}" />
                        </DataTrigger>
                        <Trigger Property="DetailsVisibility" Value="Visible">
                            <Setter TargetName="RowBorder" Property="BorderThickness"
                                Value="2,2,2,2" />
                        </Trigger>
                        <MultiTrigger>
                            <MultiTrigger.Conditions>
                                <Condition Property="IsMouseOver" Value="True" />
                                <Condition Property="IsSelected" Value="False" />
                            </MultiTrigger.Conditions>
                            <Setter TargetName="RowBorder" Property="BorderBrush"
                                Value="{DynamicResource Brush.Button.Primary.Background.Hover}" />
                        </MultiTrigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
        <Style.Triggers>
            <DataTrigger
                Binding="{Binding DataContext.IsCompactView, RelativeSource={RelativeSource AncestorType={x:Type Window}}}"
                Value="True">
                <Setter Property="Padding">
                    <Setter.Value>
                        <MultiBinding
                            Converter="{StaticResource IMM.RowPaddingOffsetConverter}">
                            <Binding Source="{StaticResource IMM.RowPaddingBase}" />
                            <Binding
                                Source="{StaticResource IMM.CompactRowHeightOffset}" />
                        </MultiBinding>
                    </Setter.Value>
                </Setter>
            </DataTrigger>
            <DataTrigger Binding="{Binding HasErrors}" Value="True">
                <Setter Property="Background"
                    Value="{DynamicResource Brush.Overlay.Warning.Background}" />
            </DataTrigger>
            <DataTrigger Binding="{Binding HasActivationError}" Value="True">
                <Setter Property="Background"
                    Value="{DynamicResource Brush.Overlay.Warning.Background}" />
            </DataTrigger>
            <Trigger Property="IsSelected" Value="True">
                <Setter Property="Background"
                    Value="{DynamicResource Brush.DataGrid.Row.Background.Selected}" />
                <Setter Property="BorderBrush"
                    Value="{DynamicResource Brush.Accent.Primary}" />
            </Trigger>
        </Style.Triggers>
    </Style>

    <!-- DataGrid row style for modlists (local and cloud) -->
    <Style x:Key="IMM.ModlistsDataGridRowStyle" TargetType="{x:Type DataGridRow}">
        <Setter Property="Background" Value="Transparent" />
        <Setter Property="BorderBrush"
            Value="{DynamicResource Brush.Panel.Secondary.Background.Solid}" />
        <Setter Property="BorderThickness" Value="0" />
        <Setter Property="Margin" Value="10,2,10,2" />
        <Setter Property="Foreground" Value="{DynamicResource Brush.Text.Primary}" />
        <Setter Property="Padding">
            <Setter.Value>
                <MultiBinding Converter="{StaticResource IMM.RowPaddingOffsetConverter}">
                    <Binding Source="{StaticResource IMM.RowPaddingBase}" />
                    <Binding Source="{StaticResource IMM.NormalRowHeightOffset}" />
                </MultiBinding>
            </Setter.Value>
        </Setter>
        <Setter Property="Height" Value="{x:Static sys:Double.NaN}" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type DataGridRow}">
                    <Border x:Name="RowBorder"
                        Background="{DynamicResource Brush.Panel.Primary.Background.Solid}"
                        BorderBrush="{TemplateBinding BorderBrush}"
                        BorderThickness="{TemplateBinding BorderThickness}"
                        CornerRadius="0"
                        Margin="4,0,4,4"
                        SnapsToDevicePixels="True">
                        <Grid>
                            <Border x:Name="SelectionOverlay"
                                Background="{DynamicResource Brush.Accent.Primary}"
                                Opacity="0"
                                CornerRadius="0"
                                IsHitTestVisible="False" />
                            <Border x:Name="HoverOverlay"
                                Background="{DynamicResource Brush.Button.Primary.Background.Hover}"
                                Opacity="0"
                                CornerRadius="0"
                                IsHitTestVisible="False" />
                            <Border Padding="{TemplateBinding Padding}"
                                Background="Transparent"
                                CornerRadius="0">
                                <SelectiveScrollingGrid>
                                    <SelectiveScrollingGrid.ColumnDefinitions>
                                        <ColumnDefinition Width="*" />
                                    </SelectiveScrollingGrid.ColumnDefinitions>
                                    <SelectiveScrollingGrid.RowDefinitions>
                                        <RowDefinition Height="*" />
                                        <RowDefinition Height="Auto" />
                                    </SelectiveScrollingGrid.RowDefinitions>
                                    <DataGridCellsPresenter Grid.Column="0"
                                        SelectiveScrollingGrid.SelectiveScrollingOrientation="Both" />
                                    <DataGridDetailsPresenter Grid.Column="0"
                                        Grid.Row="1"
                                        SelectiveScrollingGrid.SelectiveScrollingOrientation="Horizontal"
                                        Visibility="{TemplateBinding DetailsVisibility}" />
                                </SelectiveScrollingGrid>
                            </Border>
                        </Grid>
                    </Border>
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsMouseOver" Value="True">
                            <Setter TargetName="HoverOverlay" Property="Opacity" Value="0.1" />
                            <Setter TargetName="RowBorder" Property="BorderBrush"
                                Value="{DynamicResource Brush.Button.Primary.Background.Hover}" />
                        </Trigger>
                        <Trigger Property="IsMouseOver" Value="False">
                            <Setter TargetName="HoverOverlay" Property="Opacity" Value="0" />
                        </Trigger>
                        <Trigger Property="IsSelected" Value="True">
                            <Setter TargetName="SelectionOverlay" Property="Opacity" Value="0.25" />
                            <Setter TargetName="HoverOverlay" Property="Opacity" Value="0" />
                            <Setter TargetName="RowBorder" Property="BorderBrush"
                                Value="{DynamicResource Brush.Panel.Secondary.Background.Solid}" />
                            <Setter TargetName="RowBorder" Property="BorderThickness" Value="0" />
                        </Trigger>
                        <Trigger Property="IsSelected" Value="False">
                            <Setter TargetName="SelectionOverlay" Property="Opacity" Value="0" />
                            <Setter TargetName="RowBorder" Property="BorderThickness" Value="0" />
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
        <Style.Triggers>
            <Trigger Property="IsSelected" Value="True">
                <Setter Property="Foreground" Value="{DynamicResource Brush.Text.Primary}" />
            </Trigger>
        </Style.Triggers>
    </Style>

</ResourceDictionary>
