<Window
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:design="clr-namespace:VintageStoryModManager.Design"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:ui="http://schemas.modernwpf.com/2019"
    xmlns:services="clr-namespace:VintageStoryModManager.Services"
    xmlns:viewModels="clr-namespace:VintageStoryModManager.ViewModels"
    xmlns:views="clr-namespace:VintageStoryModManager.Views"
    xmlns:sys="clr-namespace:System;assembly=mscorlib"
    xmlns:converters="clr-namespace:VintageStoryModManager.Converters"
    x:Class="VintageStoryModManager.Views.MainWindow"
    mc:Ignorable="d"
    d:DataContext="{d:DesignInstance Type={x:Type design:MainWindowDesignData}}"
    Title="Simple VS Manager"
    Height="876" Width="1641"
    MinWidth="1200" MinHeight="775" WindowStartupLocation="CenterOwner"
    PreviewKeyDown="MainWindow_OnPreviewKeyDown"
    AllowDrop="True"
    PreviewDragEnter="MainWindow_OnPreviewDragEnter"
    PreviewDragOver="MainWindow_OnPreviewDragOver"
    PreviewDrop="MainWindow_OnPreviewDrop" Background="Transparent" UseLayoutRounding="False">

    <Window.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="/Resources/MainWindowStyles.xaml" />
            </ResourceDictionary.MergedDictionaries>
        </ResourceDictionary>
    </Window.Resources>

    <!-- ============================================================ -->
    <!-- Main Window Layout: 3-row grid (TOP menu bar, MIDDLE content, BOTTOM status/actions) -->
    <!-- ============================================================ -->
    <Grid x:Name="RootGrid" Background="{DynamicResource Brush.ComboBox.Background.Disabled}">

        <Grid.RowDefinitions>
            <RowDefinition Height="26" MinHeight="10" />
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>

        <!-- ============================================================ -->
        <!-- TOP: Menu Bar and Notification Links -->
        <!-- ============================================================ -->
        <Grid x:Name="TOP" Height="24" VerticalAlignment="Top">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="325" />
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <Rectangle Height="24" Grid.ColumnSpan="2" Fill="{DynamicResource Brush.Menu.Border}"/>

            <!-- Main Application Menu -->
            <Border Grid.Column="0" CornerRadius="0,5,5,0" Background="{DynamicResource Brush.Menu.Border}">

                <Menu
                    IsMainMenu="True"
                    BorderThickness="0"
                    Background="Transparent"
                    Foreground="{DynamicResource Brush.Text.Primary}">
                    <Menu.Resources>
                        <Style TargetType="{x:Type MenuItem}" BasedOn="{StaticResource ToggleMenuItemStyle}" />
                    </Menu.Resources>

                    <MenuItem Header="_File" Padding="6,0,12,0" Height="24">
                        <MenuItem Header="Set _Data Folder..." Height="35" Click="SelectDataFolderMenuItem_OnClick" />
                        <MenuItem Header="Set _Game Folder..." Height="35" Click="SelectGameFolderMenuItem_OnClick" />
                        <MenuItem Header="Set Custom Vintage Story Shortcut" Height="35"
                            Click="SetCustomShortcutMenuItem_OnClick" />
                        <MenuItem x:Name="GameProfilesMenuItem"
                            Header="Game Profiles"
                            Height="35"
                            SubmenuOpened="GameProfilesMenuItem_OnSubmenuOpened">
                            <MenuItem x:Name="CreateGameProfileMenuItem"
                                Header="Create new..."
                                Height="35"
                                Click="CreateGameProfileMenuItem_OnClick" />
                            <MenuItem x:Name="DeleteGameProfileMenuItem"
                                Header="Delete profile..."
                                Height="35"
                                Click="DeleteGameProfileMenuItem_OnClick" />
                        </MenuItem>
                        <MenuItem Header="Restore backup point"
                            Height="35"
                            SubmenuOpened="RestoreBackupMenuItem_OnSubmenuOpened">
                            <MenuItem Header="Loading..." IsEnabled="False" />
                        </MenuItem>
                        <MenuItem x:Name="RestoreDataFolderMenuItem"
                            Header="Restore VintagestoryData backup"
                            Height="35"
                            SubmenuOpened="RestoreDataFolderMenuItem_OnSubmenuOpened">
                            <MenuItem Header="Loading..." IsEnabled="False" />
                        </MenuItem>
                        <MenuItem x:Name="AutomaticDataBackupsMenuItem"
                            Header="Automatically back up VintagestoryData before launch"
                            Height="35"
                            IsCheckable="True"
                            Style="{StaticResource ToggleMenuItemStyle}"
                            Click="AutomaticDataBackupsMenuItem_OnClick" />
                        <MenuItem x:Name="DisableAutoRefreshMenuItem"
                            Header="_Disable auto-refresh"
                            Height="35"
                            IsCheckable="True"
                            Style="{StaticResource ToggleMenuItemStyle}"
                            Click="DisableAutoRefreshMenuItem_OnClick" />
                        <Separator />
                        <MenuItem Header="E_xit" Height="35" Click="ExitMenuItem_OnClick" />
                    </MenuItem>
                    <MenuItem Header="_Mods" Height="24" SubmenuOpened="ModsMenuItem_OnSubmenuOpened" Padding="6,0,12,0">
                        <MenuItem Header="_Refresh Mods"
                            Height="35"
                            Command="{Binding RefreshModsUiCommand, RelativeSource={RelativeSource AncestorType={x:Type Window}}}" />
                        <MenuItem x:Name="UpdateAllModsMenuItem"
                            Header="{Binding DataContext.UpdateAllModsMenuHeader, FallbackValue=_Update All Mods, RelativeSource={RelativeSource AncestorType={x:Type Window}}}"
                            Height="35"
                            Click="UpdateAllModsMenuItem_OnClick" />
                        <MenuItem Header="Check mods compatibility" Height="35"
                            Click="CheckModsCompatibilityMenuItem_OnClick" />
                        <MenuItem x:Name="RequireExactVsVersionMenuItem"
                            Header="Require exact VS version for compatibility checks"
                            Height="35"
                            IsCheckable="True"
                            Style="{StaticResource ToggleMenuItemStyle}"
                            Click="RequireExactVsVersionMenuItem_OnClick" />
                        <MenuItem x:Name="CacheAllVersionsMenuItem"
                            Header="Cache all versions locally"
                            Height="35"
                            IsCheckable="True"
                            Style="{StaticResource ToggleMenuItemStyle}"
                            Click="CacheAllVersionsMenuItem_OnClick" />
                        <MenuItem x:Name="DeleteCachedModsMenuItem"
                            Header="_Delete Cached Mods"
                            Height="35"
                            Click="DeleteCachedModsMenuItem_OnClick" />
                    </MenuItem>
                    <MenuItem x:Name="PresetsAndModlistsMenuItem" Header="_Save &amp; Load" Height="24" Padding="6,0,12,0">
                        <MenuItem Header="Save _Modlist as an importable PDF..." Height="35"
                            Click="SaveInstalledModsPdfMenuItem_OnClick" />
                        <MenuItem Header="Save _Modlist..." Height="35" Click="SaveModlistMenuItem_OnClick" />
                        <MenuItem Header="Load _Modlist..." Height="35" Click="LoadModlistMenuItem_OnClick" />
                        <Separator />
                        <MenuItem Header="_Save Preset..." Height="35" Click="SavePresetMenuItem_OnClick" />
                        <MenuItem x:Name="LoadPresetMenuItem"
                            Header="_Load Preset"
                            Height="35"
                            SubmenuOpened="LoadPresetMenuItem_OnSubmenuOpened">
                            <MenuItem x:Name="BrowsePresetMenuItem"
                                Header="_Browse..."
                                Height="35"
                                Click="LoadPresetMenuItem_OnClick" />
                        </MenuItem>
                        <Separator />
                        <MenuItem x:Name="AlwaysClearModlistsMenuItem"
                            Header="Always clear mods before loading Modlist"
                            Height="35"
                            IsCheckable="True"
                            Style="{StaticResource ToggleMenuItemStyle}"
                            Click="AlwaysClearModlistsMenuItem_OnClick" />
                        <MenuItem x:Name="AlwaysAddModlistsMenuItem"
                            Header="Always add to current mods when loading Modlist"
                            Height="35"
                            IsCheckable="True"
                            Style="{StaticResource ToggleMenuItemStyle}"
                            Click="AlwaysAddModlistsMenuItem_OnClick" />
                    </MenuItem>
                    <MenuItem Header="_View" Height="24" Padding="6,0,12,0">
                        <MenuItem Header="_Compact View"
                            Height="35"
                            IsCheckable="True"
                            Style="{StaticResource ToggleMenuItemStyle}"
                            IsChecked="{Binding IsCompactView, Mode=TwoWay}" />
                        <MenuItem Header="_Use ModDB design"
                            Height="35"
                            IsCheckable="True"
                            Style="{StaticResource ToggleMenuItemStyle}"
                            IsChecked="{Binding UseModDbDesignView, Mode=TwoWay}" />
                        <MenuItem Header="_Themes" Height="35">
                            <MenuItem x:Name="VintageStoryThemeMenuItem"
                                Header="_Vintage Story"
                                Height="35"
                                IsCheckable="True"
                                Style="{StaticResource ToggleMenuItemStyle}"
                                Tag="{x:Static services:ColorTheme.VintageStory}"
                                Click="ThemeMenuItem_OnClick" />
                            <MenuItem x:Name="DarkThemeMenuItem"
                                Header="_Dark"
                                Height="35"
                                IsCheckable="True"
                                Style="{StaticResource ToggleMenuItemStyle}"
                                Tag="{x:Static services:ColorTheme.Dark}"
                                Click="ThemeMenuItem_OnClick" />
                            <MenuItem x:Name="LightThemeMenuItem"
                                Header="_Light"
                                Height="35"
                                IsCheckable="True"
                                Style="{StaticResource ToggleMenuItemStyle}"
                                Tag="{x:Static services:ColorTheme.Light}"
                                Click="ThemeMenuItem_OnClick" />
                            <MenuItem x:Name="CustomThemeMenuItem"
                                Header="_Custom..."
                                Height="35"
                                IsCheckable="True"
                                Style="{StaticResource ToggleMenuItemStyle}"
                                Tag="{x:Static services:ColorTheme.Custom}"
                                Click="ThemeMenuItem_OnClick" />
                            <MenuItem x:Name="SurpriseMeThemeMenuItem"
                                Header="_Surprise me! (In A Bad Way)"
                                Height="35"
                                IsCheckable="True"
                                Style="{StaticResource ToggleMenuItemStyle}"
                                Tag="{x:Static services:ColorTheme.SurpriseMe}"
                                Click="ThemeMenuItem_OnClick" />
                        </MenuItem>
                        <MenuItem x:Name="ColumnsMenuItem"
                            Header="_Columns"
                            Height="35"
                            Visibility="{Binding IsViewingMainTab, Converter={StaticResource IMM.VisibleWhenTrueConverter}}">
                            <MenuItem x:Name="ActiveColumnMenuItem"
                                Header="_Active"
                                IsCheckable="True"
                                IsChecked="True"
                                Style="{StaticResource ToggleMenuItemStyle}"
                                Checked="InstalledModsColumnMenuItem_OnChecked"
                                Unchecked="InstalledModsColumnMenuItem_OnChecked" />
                            <MenuItem x:Name="IconColumnMenuItem"
                                Header="_Icon"
                                IsCheckable="True"
                                IsChecked="True"
                                Style="{StaticResource ToggleMenuItemStyle}"
                                Checked="InstalledModsColumnMenuItem_OnChecked"
                                Unchecked="InstalledModsColumnMenuItem_OnChecked" />
                            <MenuItem x:Name="NameColumnMenuItem"
                                Header="_Name"
                                IsCheckable="True"
                                IsChecked="True"
                                Style="{StaticResource ToggleMenuItemStyle}"
                                Checked="InstalledModsColumnMenuItem_OnChecked"
                                Unchecked="InstalledModsColumnMenuItem_OnChecked" />
                            <MenuItem x:Name="VersionColumnMenuItem"
                                Header="_Version"
                                IsCheckable="True"
                                IsChecked="True"
                                Style="{StaticResource ToggleMenuItemStyle}"
                                Checked="InstalledModsColumnMenuItem_OnChecked"
                                Unchecked="InstalledModsColumnMenuItem_OnChecked" />
                            <MenuItem x:Name="LatestVersionColumnMenuItem"
                                Header="Latest _Version"
                                IsCheckable="True"
                                IsChecked="True"
                                Style="{StaticResource ToggleMenuItemStyle}"
                                Checked="InstalledModsColumnMenuItem_OnChecked"
                                Unchecked="InstalledModsColumnMenuItem_OnChecked" />
                            <MenuItem x:Name="AuthorsColumnMenuItem"
                                Header="_Authors"
                                IsCheckable="True"
                                IsChecked="True"
                                Style="{StaticResource ToggleMenuItemStyle}"
                                Checked="InstalledModsColumnMenuItem_OnChecked"
                                Unchecked="InstalledModsColumnMenuItem_OnChecked" />
                            <MenuItem x:Name="TagsColumnMenuItem"
                                Header="_Tags"
                                IsCheckable="True"
                                IsChecked="True"
                                Style="{StaticResource ToggleMenuItemStyle}"
                                Checked="InstalledModsColumnMenuItem_OnChecked"
                                Unchecked="InstalledModsColumnMenuItem_OnChecked" />
                            <MenuItem x:Name="StatusColumnMenuItem"
                                Header="_Status"
                                IsCheckable="True"
                                IsChecked="True"
                                Style="{StaticResource ToggleMenuItemStyle}"
                                Checked="InstalledModsColumnMenuItem_OnChecked"
                                Unchecked="InstalledModsColumnMenuItem_OnChecked" />
                            <MenuItem x:Name="UserReportsColumnMenuItem"
                                Header="User _Reports"
                                IsCheckable="True"
                                IsChecked="True"
                                Style="{StaticResource ToggleMenuItemStyle}"
                                Checked="InstalledModsColumnMenuItem_OnChecked"
                                Unchecked="InstalledModsColumnMenuItem_OnChecked" />
                            <MenuItem x:Name="SideColumnMenuItem"
                                Header="S_ide"
                                IsCheckable="True"
                                IsChecked="True"
                                Style="{StaticResource ToggleMenuItemStyle}"
                                Checked="InstalledModsColumnMenuItem_OnChecked"
                                Unchecked="InstalledModsColumnMenuItem_OnChecked" />
                        </MenuItem>
                    </MenuItem>
                    <MenuItem Header="_Help &amp; Advanced" Height="24" Padding="6,0,12,0">
                        <MenuItem x:Name="ManagerVersionMenuItem"
                            Header="Version: --"
                            Padding="12,6"
                            IsEnabled="False"
                            Focusable="False"
                            Opacity="0.75" />
                        <MenuItem x:Name="GameVersionMenuItem"
                            Header="Vintage Story: --"
                            Padding="12,6"
                            IsEnabled="False"
                            Focusable="False"
                            Visibility="Collapsed"
                            Opacity="0.75" />
                        <Separator />
                        <MenuItem Header="Open manager config folder"
                            Padding="12,6"
                            Click="ManagerDataFolderMenuItem_OnClick" />
                        <MenuItem Header="Open _Mod DB page for the manager"
                            Padding="12,6"
                            Click="ManagerModDbPageMenuItem_OnClick" />
                        <MenuItem Header="Menu Guide"
                            Padding="12,6"
                            Click="GuideMenuItem_OnClick" />
                        <MenuItem Header="Help!"
                            Padding="12,6"
                            Click="HelpMenuItem_OnClick" />
                        <MenuItem x:Name="DeveloperProfilesMenuItem"
                            Header="Developer Profiles"
                            Padding="12,6"
                            Visibility="Collapsed" />
                        <Separator />
                        <MenuItem x:Name="DisableInternetAccessMenuItem"
                            Header="_Disable Internet Access"
                            Height="35"
                            IsCheckable="True"
                            Style="{StaticResource ToggleMenuItemStyle}"
                            Click="DisableInternetAccessMenuItem_OnClick" />
                        <MenuItem x:Name="EnableServerOptionsMenuItem"
                            Header="Enable server options"
                            Padding="12,6"
                            IsCheckable="True"
                            Style="{StaticResource ToggleMenuItemStyle}"
                            Click="EnableServerOptionsMenuItem_OnClick" />
                        <MenuItem Header="Enable logging for..."
                            Padding="12,6">
                            <MenuItem x:Name="LogModUpdateMenuItem"
                                Header="Mod update"
                                Height="35"
                                IsCheckable="True"
                                Style="{StaticResource ToggleMenuItemStyle}"
                                Click="LogModUpdateMenuItem_OnClick" />
                            <MenuItem x:Name="LogModInstallMenuItem"
                                Header="Mod installation"
                                Height="35"
                                IsCheckable="True"
                                Style="{StaticResource ToggleMenuItemStyle}"
                                Click="LogModInstallMenuItem_OnClick" />
                            <MenuItem x:Name="LogModDeletionMenuItem"
                                Header="Mod deletion"
                                Height="35"
                                IsCheckable="True"
                                Style="{StaticResource ToggleMenuItemStyle}"
                                Click="LogModDeletionMenuItem_OnClick" />
                            <MenuItem x:Name="LogAppLifecycleMenuItem"
                                Header="App launch and exit"
                                Height="35"
                                IsCheckable="True"
                                Style="{StaticResource ToggleMenuItemStyle}"
                                Click="LogAppLifecycleMenuItem_OnClick" />
                        </MenuItem>
                        <MenuItem Header="Scan for mod config files"
                            Padding="12,6"
                            Click="ScanForModConfigsMenuItem_OnClick" />
                        <MenuItem Header="Clear temporary cache (Safe to use, nothing important is removed)"
                            Padding="12,6"
                            Click="ClearAllCachesMenuItem_OnClick" />
                        <Separator />
                        <MenuItem Header="Debug: Show all game log lines referencing the selected mod."
                            Padding="12,6"
                            Click="ExperimentalModDebuggingMenuItem_OnClick" />
                        <MenuItem Header="Debug: Show all game log lines found referencing any installed mod"
                            Padding="12,6"
                            Click="ExperimentalAllModsDebuggingMenuItem_OnClick" />
                        <Separator />
                        <MenuItem Header="Delete all Simple VS Manager files (Uninstall)"
                            Padding="12,6"
                            Click="DeleteAllManagerFilesMenuItem_OnClick" />

                    </MenuItem>
                </Menu>

            </Border>

            <!-- Active Game Profile Display (right side of menu bar) -->
            <TextBlock x:Name="ActiveGameProfileTextBlock"
                   FontSize="15"
                   Padding="3,0,0,3"
                   Foreground="{DynamicResource Brush.Text.Primary}"
                   Text="Profile: Default"
                   Visibility="Collapsed"
                   Opacity="0.5" Margin="0,1,16,0" Grid.Column="1" HorizontalAlignment="Right" Width="310" FlowDirection="RightToLeft" Height="28" VerticalAlignment="Top"/>

            <!-- Notification Links (Update Available, Confirm Working Mods) -->
            <StackPanel Grid.Column="1"
                        Margin="4,0,0,0"
                        Orientation="Horizontal"
                        VerticalAlignment="Center"
                        HorizontalAlignment="Left" Height="Auto" Width="Auto">
                <TextBlock x:Name="ManagerUpdateLinkTextBlock"
                           Visibility="Collapsed"
                           Margin="0,0,12,0"
                           VerticalAlignment="Center"><Hyperlink NavigateUri="https://mods.vintagestory.at/simplevsmanager"
                               Foreground="{DynamicResource Brush.Text.Emphasis}"
                               RequestNavigate="ManagerUpdateLink_OnRequestNavigate"><Run Text="Manager update available!"/></Hyperlink></TextBlock>

                <TextBlock x:Name="ModUsagePromptTextBlock"
                           Visibility="Collapsed"
                           VerticalAlignment="Center"><Hyperlink Foreground="{DynamicResource Brush.Text.Emphasis}"
                               Click="ModUsagePromptLink_OnClick"><Run Text="Confirm working mods!"/></Hyperlink></TextBlock>
            </StackPanel>

        </Grid>

        <!-- ============================================================ -->
        <!-- MIDDLE: Main Content Area (Installed Mods, Mod Database, Modlists tabs) -->
        <!-- ============================================================ -->
        <Grid x:Name="MIDDLE" Grid.Row="1" Background="Transparent">
            <Grid.RowDefinitions>
                <RowDefinition Height="*" />
            </Grid.RowDefinitions>
            <TabControl x:Name="MiddleTabControl" Background="Transparent"
                        ItemContainerStyle="{StaticResource IMM.MiddleTabItemStyle}"
                        SelectionChanged="MiddleTabControl_OnSelectionChanged" BorderThickness="0,0,0,0">

                <!-- ============================================================ -->
                <!-- TAB 1: Installed Mods Tab -->
                <!-- ============================================================ -->
                <TabItem x:Name="MainTab" Header="Installed mods" Padding="8,6,8,6" Height="Auto" Width="Auto" Foreground="{DynamicResource Brush.Text.Placeholder}" HorizontalContentAlignment="Stretch">
                    <Border Margin="8,0,8,0" Background="{DynamicResource Brush.MiddleTab.Background.Selected}" BorderThickness="0" CornerRadius="0,8,0,0">
                        <Grid x:Name="MainGrid" Background="Transparent">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                            </Grid.RowDefinitions>

                            <!-- Search and Refresh Controls -->
                            <Grid x:Name="MainControls" Margin="0,0,10,0" Height="48" VerticalAlignment="Top">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition />
                                    <ColumnDefinition Width="Auto" MinWidth="229" />
                                </Grid.ColumnDefinitions>

                                <TextBox x:Name="MainSearch" MinWidth="200"
                                    Text="{Binding SearchText, UpdateSourceTrigger=PropertyChanged}"
                                    FontSize="14" VerticalContentAlignment="Center" Height="32" HorizontalAlignment="Left"
                                    Style="{StaticResource IMM.SearchTextBoxStyle}"
                                    ui:ControlHelper.PlaceholderText="Search installed mods" Padding="3,3,6,3" UseLayoutRounding="True" Grid.IsSharedSizeScope="True" Margin="10,0,0,0"/>
                                <Button Content="Refresh"
                                    Margin="0,0,0,7"
                                    ToolTip="Quickly refreshes the current view using cached data if no changes are detected on the online mod page."
                                    Background="{DynamicResource Brush.Button.Primary.Background.Normal}"
                                    BorderBrush="{DynamicResource Brush.Panel.Secondary.Background.Solid}"
                                    Command="{Binding RefreshModsUiCommand, RelativeSource={RelativeSource AncestorType={x:Type Window}}}"
                                    MinHeight="32" Grid.Column="1" Height="32" VerticalAlignment="Bottom" HorizontalAlignment="Right" Width="82"
                                    Padding="6,6,6,6" />
                            </Grid>
                            <Border x:Name="MainBorder"
                                Background="{DynamicResource Brush.DataGrid.Background}"
                                BorderBrush="{DynamicResource Brush.DataGrid.Background}"
                                BorderThickness="2,2,0,0"
                                CornerRadius="4"
                                SnapsToDevicePixels="True"
                                Grid.Row="1" Margin="8,0,8,0">
                                <DataGrid x:Name="ModsDataGrid"
                                    ItemsSource="{Binding ModsView}"
                                    AutoGenerateColumns="False"
                                    CanUserAddRows="False"
                                    CanUserDeleteRows="False"
                                    IsReadOnly="False"
                                    CanUserSortColumns="True"
                                    EnableRowVirtualization="True"
                                    VirtualizingPanel.IsVirtualizing="True"
                                    VirtualizingPanel.VirtualizationMode="Recycling"
                                    ScrollViewer.CanContentScroll="True"
                                    GridLinesVisibility="None"
                                    SelectionUnit="FullRow"
                                    SelectionMode="Single"
                                    RowHeaderWidth="0"
                                    BorderThickness="0,1,2,1"
                                    IsSynchronizedWithCurrentItem="False"
                                    MinColumnWidth="20"
                                    SelectionChanged="ModsDataGrid_OnSelectionChanged"
                                    Foreground="{DynamicResource Brush.Text.Primary}"
                                    PreviewKeyDown="ModsDataGrid_OnPreviewKeyDown"
                                    PreviewMouseLeftButtonDown="ModsDataGrid_OnPreviewMouseLeftButtonDown"
                                    PreviewMouseWheel="ModsDataGrid_OnPreviewMouseWheel"
                                    Sorting="ModsDataGrid_OnSorting"
                                    RowBackground="{DynamicResource Brush.Button.Primary.Background.Normal}"
                                    HorizontalGridLinesBrush="Transparent"
                                    VerticalGridLinesBrush="Transparent"
                                    HeadersVisibility="Column"
                                    ui:ControlHelper.CornerRadius="0"
                                    FontSize="15"
                                    Background="Transparent"
                                    BorderBrush="Transparent">
                                    <DataGrid.Resources>
                                        <Style TargetType="{x:Type ScrollBar}"
                                            BasedOn="{StaticResource IMM.DataGridScrollBarStyle}" />
                                        <Style TargetType="{x:Type Thumb}"
                                            BasedOn="{StaticResource IMM.DataGridScrollBarThumbStyle}" />
                                        <Style TargetType="{x:Type TextBlock}">
                                            <Setter Property="TextWrapping" Value="Wrap" />
                                        </Style>
                                        <Style TargetType="{x:Type DataGridColumnHeader}"
                                            BasedOn="{StaticResource IMM.PrimaryDataGridColumnHeaderStyle}" />
                                    </DataGrid.Resources>
                                    <DataGrid.CellStyle>
                                        <StaticResource ResourceKey="IMM.DataGridCellBaseStyle" />
                                    </DataGrid.CellStyle>
                                    <DataGrid.RowStyle>
                                        <Style TargetType="{x:Type DataGridRow}" BasedOn="{StaticResource IMM.ModsDataGridRowBaseStyle}">
                                            <EventSetter Event="UIElement.PreviewMouseLeftButtonDown"
                                                Handler="ModsDataGridRow_OnPreviewMouseLeftButtonDown" />
                                            <EventSetter Event="FrameworkElement.Loaded" Handler="ModsDataGridRow_OnLoaded" />
                                            <EventSetter Event="FrameworkElement.Unloaded"
                                                Handler="ModsDataGridRow_OnUnloaded" />
                                            <EventSetter Event="UIElement.MouseEnter"
                                                Handler="ModsDataGridRow_OnMouseEnter" />
                                            <EventSetter Event="UIElement.MouseLeave"
                                                Handler="ModsDataGridRow_OnMouseLeave" />
                                        </Style>
                                    </DataGrid.RowStyle>
                                    <DataGrid.Columns>
                                        <DataGridTemplateColumn x:Name="ActiveColumn" Header="Active"
                                            SortMemberPath="ActiveSortOrder" Width="90" MinWidth="85">
                                            <DataGridTemplateColumn.CellStyle>
                                                <Style TargetType="{x:Type DataGridCell}"
                                                    BasedOn="{StaticResource IMM.DataGridCellBaseStyle}">
                                                    <Setter Property="HorizontalContentAlignment" Value="Center" />
                                                    <Setter Property="VerticalContentAlignment" Value="Center" />
                                                    <Setter Property="Padding" Value="0" />
                                                </Style>
                                            </DataGridTemplateColumn.CellStyle>
                                            <DataGridTemplateColumn.CellTemplate>
                                                <DataTemplate>
                                                    <Grid HorizontalAlignment="Center">
                                                        <ui:ToggleSwitch
                                                            IsOn="{Binding IsActive, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                            HorizontalAlignment="Center"
                                                            Toggled="ActiveToggle_OnToggled"
                                                            PreviewMouseLeftButtonDown="ActiveToggle_OnPreviewMouseLeftButtonDown"
                                                            PreviewMouseLeftButtonUp="ActiveToggle_OnPreviewMouseLeftButtonUp"
                                                            PreviewMouseMove="ActiveToggle_OnPreviewMouseMove"
                                                            Margin="12,0"
                                                            OnContent="{x:Null}"
                                                            OffContent="{x:Null}">
                                                            <ui:ToggleSwitch.Style>
                                                                <Style TargetType="{x:Type ui:ToggleSwitch}"
                                                                    BasedOn="{StaticResource IMM.ToggleSwitchBaseStyle}">
                                                                    <Setter Property="IsEnabled"
                                                                        Value="{Binding CanToggle}" />
                                                                </Style>
                                                            </ui:ToggleSwitch.Style>
                                                        </ui:ToggleSwitch>
                                                    </Grid>
                                                </DataTemplate>
                                            </DataGridTemplateColumn.CellTemplate>
                                        </DataGridTemplateColumn>
                                        <DataGridTemplateColumn x:Name="IconColumn" Header="Icon" Width="76"
                                            IsReadOnly="True">
                                            <DataGridTemplateColumn.CellStyle>
                                                <Style TargetType="{x:Type DataGridCell}"
                                                    BasedOn="{StaticResource IMM.DataGridCellBaseStyle}">
                                                    <Setter Property="HorizontalContentAlignment" Value="Left" />
                                                    <Setter Property="VerticalContentAlignment" Value="Center" />
                                                    <Setter Property="Padding" Value="0,0,12,0" />
                                                </Style>
                                            </DataGridTemplateColumn.CellStyle>
                                            <DataGridTemplateColumn.CellTemplate>
                                                <DataTemplate>
                                                    <Border Width="64" Height="64"
                                                        HorizontalAlignment="Left"
                                                        VerticalAlignment="Center"
                                                        ToolTipService.ShowDuration="60000"
                                                        ToolTipService.InitialShowDelay="200">
                                                        <ToolTipService.ToolTip>
                                                            <TextBlock Text="{Binding Tooltip}"
                                                                FontFamily="Segoe UI"
                                                                FontSize="12"
                                                                FontWeight="Normal"
                                                                MaxWidth="300"
                                                                Foreground="{DynamicResource Brush.ToolTip.Text}"
                                                                TextWrapping="Wrap" />
                                                        </ToolTipService.ToolTip>
                                                        <Image Source="{Binding Icon}" Stretch="Uniform" Margin="0" />
                                                    </Border>
                                                </DataTemplate>
                                            </DataGridTemplateColumn.CellTemplate>
                                        </DataGridTemplateColumn>
                                        <DataGridTextColumn x:Name="NameColumn" Header="Name"
                                            Binding="{Binding DisplayName, Mode=OneWay}" Width="220"
                                            SortMemberPath="NameSortKey" IsReadOnly="True">
                                            <DataGridTextColumn.ElementStyle>
                                                <Style TargetType="{x:Type TextBlock}">
                                                    <Setter Property="FontFamily" Value="Segoe UI" />
                                                    <Setter Property="FontWeight" Value="Bold" />
                                                    <Setter Property="ToolTipService.ShowDuration" Value="60000" />
                                                    <Setter Property="ToolTipService.InitialShowDelay" Value="200" />
                                                    <Setter Property="HorizontalAlignment" Value="Stretch" />
                                                    <Setter Property="VerticalAlignment" Value="Center" />
                                                    <Setter Property="TextAlignment" Value="Left" />
                                                    <Setter Property="Margin" Value="15,0,0,0" />
                                                    <Setter Property="ToolTipService.ToolTip">
                                                        <Setter.Value>
                                                            <TextBlock Text="{Binding Tooltip}"
                                                                FontFamily="Segoe UI"
                                                                FontSize="12"
                                                                FontWeight="Normal"
                                                                MaxWidth="300"
                                                                Foreground="{DynamicResource Brush.ToolTip.Text}"
                                                                TextWrapping="Wrap" />
                                                        </Setter.Value>
                                                    </Setter>
                                                </Style>
                                            </DataGridTextColumn.ElementStyle>
                                            <DataGridTextColumn.CellStyle>
                                                <Style TargetType="{x:Type DataGridCell}"
                                                    BasedOn="{StaticResource IMM.DataGridCellBaseStyle}">
                                                    <Setter Property="HorizontalContentAlignment" Value="Center" />
                                                    <Setter Property="VerticalContentAlignment" Value="Center" />
                                                </Style>
                                            </DataGridTextColumn.CellStyle>
                                        </DataGridTextColumn>
                                        <DataGridTextColumn x:Name="VersionColumn"
                                            Header="Version"
                                            Binding="{Binding VersionDisplay, Mode=OneWay}"
                                            Width="85"
                                            IsReadOnly="True"
                                            MinWidth="80"
                                            ElementStyle="{StaticResource IMM.DataGridCenteredTextStyle}"
                                            CellStyle="{StaticResource IMM.DataGridCenteredCellStyle}" />
                                        <DataGridTextColumn x:Name="LatestVersionColumn" Header="Latest Version"
                                            Binding="{Binding LatestDatabaseVersionDisplay, Mode=OneWay}"
                                            SortMemberPath="LatestVersionSortKey" Width="140"
                                            MinWidth="139" IsReadOnly="True">
                                            <DataGridTextColumn.ElementStyle>
                                                <Style TargetType="{x:Type TextBlock}">
                                                    <Setter Property="HorizontalAlignment" Value="Center" />
                                                    <Setter Property="VerticalAlignment" Value="Center" />
                                                    <Setter Property="Padding" Value="4,2" />
                                                    <Setter Property="Margin" Value="2" />
                                                    <Setter Property="ToolTipService.ShowDuration" Value="60000" />
                                                    <Setter Property="ToolTip">
                                                        <Setter.Value>
                                                            <ToolTip MaxHeight="600"
                                                                MaxWidth="300"
                                                                Padding="0">
                                                                <Border MaxHeight="600"
                                                                    MaxWidth="300"
                                                                    ClipToBounds="True">
                                                                    <ItemsControl
                                                                        ItemsSource="{Binding NewerReleaseChangelogs}">
                                                                        <ItemsControl.ItemTemplate>
                                                                            <DataTemplate>
                                                                                <StackPanel Margin="0,0,0,12"
                                                                                    MaxWidth="300">
                                                                                    <TextBlock Text="{Binding Version}"
                                                                                        FontWeight="Bold"
                                                                                        Margin="0,0,0,4"
                                                                                        Foreground="{DynamicResource Brush.ToolTip.Text}" />
                                                                                    <TextBlock Text="{Binding Changelog}"
                                                                                        TextWrapping="Wrap"
                                                                                        Foreground="{DynamicResource Brush.ToolTip.Text}"
                                                                                        MaxWidth="300" />
                                                                                </StackPanel>
                                                                            </DataTemplate>
                                                                        </ItemsControl.ItemTemplate>
                                                                    </ItemsControl>
                                                                </Border>
                                                            </ToolTip>
                                                        </Setter.Value>
                                                    </Setter>
                                                    <EventSetter Event="FrameworkElement.ToolTipOpening"
                                                        Handler="LatestVersionTextBlock_OnToolTipOpening" />
                                                    <EventSetter Event="FrameworkElement.ToolTipClosing"
                                                        Handler="LatestVersionTextBlock_OnToolTipClosing" />
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding ShouldHighlightLatestVersion}"
                                                            Value="True">
                                                            <Setter Property="Background"
                                                                Value="{DynamicResource Brush.Accent.Primary}" />
                                                            <Setter Property="Foreground"
                                                                Value="{DynamicResource Brush.Text.Primary}" />
                                                        </DataTrigger>
                                                        <DataTrigger Binding="{Binding HasNewerReleaseChangelogs}"
                                                            Value="False">
                                                            <Setter Property="ToolTip" Value="{x:Null}" />
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </DataGridTextColumn.ElementStyle>
                                            <DataGridTextColumn.CellStyle>
                                                <Style TargetType="{x:Type DataGridCell}"
                                                    BasedOn="{StaticResource IMM.DataGridCellBaseStyle}">
                                                    <Setter Property="HorizontalContentAlignment" Value="Center" />
                                                    <Setter Property="VerticalContentAlignment" Value="Center" />
                                                </Style>
                                            </DataGridTextColumn.CellStyle>
                                        </DataGridTextColumn>


                                        <DataGridTextColumn x:Name="AuthorsColumn" Header="Authors"
                                            Binding="{Binding AuthorsDisplay, Mode=OneWay}" Width="150"
                                            IsReadOnly="True">
                                            <DataGridTextColumn.ElementStyle>
                                                <Style TargetType="{x:Type TextBlock}">
                                                    <Setter Property="TextWrapping" Value="NoWrap" />
                                                    <Setter Property="TextTrimming" Value="CharacterEllipsis" />
                                                    <Setter Property="HorizontalAlignment" Value="Stretch" />
                                                    <Setter Property="VerticalAlignment" Value="Center" />
                                                    <Setter Property="TextAlignment" Value="Center" />
                                                    <Setter Property="ToolTipService.ShowDuration" Value="60000" />
                                                    <Setter Property="ToolTipService.InitialShowDelay" Value="200" />
                                                    <Setter Property="ToolTipService.ToolTip">
                                                        <Setter.Value>
                                                            <TextBlock Text="{Binding AuthorsDisplay}"
                                                                FontFamily="Segoe UI"
                                                                FontSize="12"
                                                                Foreground="{DynamicResource Brush.ToolTip.Text}"
                                                                TextWrapping="Wrap"
                                                                MaxWidth="300" />
                                                        </Setter.Value>
                                                    </Setter>
                                                </Style>
                                            </DataGridTextColumn.ElementStyle>
                                            <DataGridTextColumn.CellStyle>
                                                <Style TargetType="{x:Type DataGridCell}"
                                                    BasedOn="{StaticResource IMM.DataGridCellBaseStyle}">
                                                    <Setter Property="HorizontalContentAlignment" Value="Center" />
                                                    <Setter Property="VerticalContentAlignment" Value="Center" />
                                                </Style>
                                            </DataGridTextColumn.CellStyle>
                                        </DataGridTextColumn>
                                        <DataGridTemplateColumn x:Name="TagsColumn"
                                            Header="Tags"
                                            Width="280"
                                            MinWidth="180"
                                            IsReadOnly="True"
                                            CanUserSort="False">
                                            <DataGridTemplateColumn.HeaderTemplate>
                                                <DataTemplate>
                                                    <Grid Background="Transparent"
                                                        Width="{Binding ActualWidth, RelativeSource={RelativeSource AncestorType={x:Type DataGridColumnHeader}}}">
                                                        <ToggleButton x:Name="TagsHeaderToggle"
                                                            Content="{Binding DataContext.TagsColumnHeader, RelativeSource={RelativeSource AncestorType={x:Type Window}}}"
                                                            Style="{StaticResource IMM.TagHeaderToggleButtonStyle}" />
                                                        <Popup PlacementTarget="{Binding ElementName=TagsHeaderToggle}"
                                                            Placement="Bottom"
                                                            IsOpen="{Binding IsChecked, ElementName=TagsHeaderToggle, Mode=TwoWay}"
                                                            StaysOpen="False"
                                                            AllowsTransparency="True"
                                                            Focusable="False">
                                                            <Border
                                                                Background="{DynamicResource Brush.Panel.Primary.Background.Solid}"
                                                                BorderBrush="{DynamicResource Brush.Panel.Secondary.Background.Solid}"
                                                                BorderThickness="1"
                                                                CornerRadius="6"
                                                                Padding="8"
                                                                MinWidth="440">
                                                                <ScrollViewer MaxHeight="260"
                                                                    HorizontalScrollBarVisibility="Disabled"
                                                                    VerticalScrollBarVisibility="Auto">
                                                                    <ScrollViewer.Resources>
                                                                        <Style TargetType="{x:Type ScrollBar}"
                                                                            BasedOn="{StaticResource IMM.DataGridScrollBarStyle}" />
                                                                        <Style TargetType="{x:Type Thumb}"
                                                                            BasedOn="{StaticResource IMM.DataGridScrollBarThumbStyle}" />
                                                                    </ScrollViewer.Resources>
                                                                    <ItemsControl
                                                                        ItemsPanel="{StaticResource IMM.TagFilterItemsPanelTemplate}"
                                                                        ItemsSource="{Binding DataContext.InstalledTagFilters, RelativeSource={RelativeSource AncestorType={x:Type Window}}}">
                                                                        <ItemsControl.ItemTemplate>
                                                                            <DataTemplate
                                                                                DataType="{x:Type viewModels:TagFilterOptionViewModel}">
                                                                                <ToggleButton
                                                                                    Style="{StaticResource IMM.TagFilterToggleButtonStyle}"
                                                                                    Content="{Binding Name}"
                                                                                    IsChecked="{Binding IsSelected, Mode=TwoWay}" />
                                                                            </DataTemplate>
                                                                        </ItemsControl.ItemTemplate>
                                                                    </ItemsControl>
                                                                </ScrollViewer>
                                                            </Border>
                                                        </Popup>
                                                    </Grid>
                                                </DataTemplate>
                                            </DataGridTemplateColumn.HeaderTemplate>
                                            <DataGridTemplateColumn.CellTemplate>
                                                <DataTemplate>
                                                    <Grid>
                                                        <Border x:Name="TagsContainer"
                                                            HorizontalAlignment="Stretch"
                                                            VerticalAlignment="Center"
                                                            MaxHeight="{StaticResource IMM.TagRowMaxHeight}"
                                                            ClipToBounds="True">
                                                            <ItemsControl x:Name="TagsItemsControl"
                                                                Width="{Binding ActualWidth, RelativeSource={RelativeSource AncestorType={x:Type DataGridCell}}}"
                                                                HorizontalAlignment="Left"
                                                                ItemsSource="{Binding DatabaseTags}"
                                                                ItemTemplate="{StaticResource IMM.TagBadgeTemplate}"
                                                                ItemsPanel="{StaticResource IMM.TagItemsPanelTemplate}" />
                                                        </Border>
                                                        <TextBlock x:Name="NoTagsText"
                                                            Text=""
                                                            HorizontalAlignment="Center"
                                                            VerticalAlignment="Center"
                                                            Visibility="Collapsed" />
                                                    </Grid>
                                                    <DataTemplate.Triggers>
                                                        <DataTrigger Binding="{Binding DatabaseTags.Count}" Value="0">
                                                            <Setter TargetName="TagsContainer" Property="Visibility"
                                                                Value="Collapsed" />
                                                            <Setter TargetName="NoTagsText" Property="Visibility"
                                                                Value="Visible" />
                                                        </DataTrigger>
                                                        <DataTrigger
                                                            Binding="{Binding DataContext.IsCompactView, RelativeSource={RelativeSource AncestorType={x:Type Window}}}"
                                                            Value="True">
                                                            <Setter TargetName="TagsContainer" Property="MaxHeight"
                                                                Value="{StaticResource IMM.TagRowCompactMaxHeight}" />
                                                        </DataTrigger>
                                                    </DataTemplate.Triggers>
                                                </DataTemplate>
                                            </DataGridTemplateColumn.CellTemplate>
                                            <DataGridTemplateColumn.CellStyle>
                                                <Style TargetType="{x:Type DataGridCell}"
                                                    BasedOn="{StaticResource IMM.DataGridCellBaseStyle}">
                                                    <Setter Property="HorizontalContentAlignment" Value="Stretch" />
                                                    <Setter Property="VerticalContentAlignment" Value="Center" />
                                                </Style>
                                            </DataGridTemplateColumn.CellStyle>
                                        </DataGridTemplateColumn>
                                        <DataGridTemplateColumn x:Name="StatusColumn" Header="Status" Width="80"
                                            IsReadOnly="True" SortMemberPath="StatusSortOrder">
                                            <DataGridTemplateColumn.CellTemplate>
                                                <DataTemplate>
                                                    <Grid HorizontalAlignment="Center"
                                                        VerticalAlignment="Center">
                                                        <Viewbox x:Name="StatusIconViewbox"
                                                            Width="32"
                                                            Height="32">
                                                            <Grid Width="32"
                                                                Height="32">
                                                                <Image x:Name="ErrorIcon"
                                                                    Width="32"
                                                                    Height="32"
                                                                    Stretch="Uniform"
                                                                    Source="/error.png"
                                                                    Visibility="Collapsed" />
                                                                <Image x:Name="WarningIcon"
                                                                    Width="32"
                                                                    Height="32"
                                                                    Stretch="Uniform"
                                                                    Source="/warning.png"
                                                                    Visibility="Collapsed" />
                                                            </Grid>
                                                        </Viewbox>
                                                    </Grid>
                                                    <DataTemplate.Triggers>
                                                        <DataTrigger
                                                            Binding="{Binding DataContext.IsCompactView, RelativeSource={RelativeSource AncestorType={x:Type Window}}}"
                                                            Value="True">
                                                            <Setter TargetName="StatusIconViewbox" Property="Width"
                                                                Value="22.5" />
                                                            <Setter TargetName="StatusIconViewbox" Property="Height"
                                                                Value="22.5" />
                                                            <Setter TargetName="ErrorIcon" Property="Width" Value="22.5" />
                                                            <Setter TargetName="ErrorIcon" Property="Height" Value="22.5" />
                                                            <Setter TargetName="WarningIcon" Property="Width" Value="22.5" />
                                                            <Setter TargetName="WarningIcon" Property="Height" Value="22.5" />
                                                        </DataTrigger>
                                                        <DataTrigger Binding="{Binding StatusText}" Value="Error">
                                                            <Setter TargetName="ErrorIcon" Property="Visibility"
                                                                Value="Visible" />
                                                        </DataTrigger>
                                                        <DataTrigger Binding="{Binding StatusText}" Value="Warning">
                                                            <Setter TargetName="WarningIcon" Property="Visibility"
                                                                Value="Visible" />
                                                        </DataTrigger>
                                                    </DataTemplate.Triggers>
                                                </DataTemplate>
                                            </DataGridTemplateColumn.CellTemplate>
                                            <DataGridTemplateColumn.CellStyle>
                                                <Style TargetType="{x:Type DataGridCell}"
                                                    BasedOn="{StaticResource IMM.DataGridCellBaseStyle}">
                                                    <Setter Property="ToolTip" Value="{Binding StatusDetails}" />
                                                </Style>
                                            </DataGridTemplateColumn.CellStyle>
                                        </DataGridTemplateColumn>
                                        <DataGridTemplateColumn x:Name="UserReportsColumn" Header="User Reports"
                                            Width="150" IsReadOnly="True">
                                            <DataGridTemplateColumn.CellStyle>
                                                <Style TargetType="{x:Type DataGridCell}"
                                                    BasedOn="{StaticResource IMM.DataGridCellBaseStyle}">
                                                    <Setter Property="HorizontalContentAlignment" Value="Center" />
                                                    <Setter Property="VerticalContentAlignment" Value="Center" />
                                                </Style>
                                            </DataGridTemplateColumn.CellStyle>
                                            <DataGridTemplateColumn.CellTemplate>
                                                <DataTemplate>
                                                    <Button
                                                        Content="{Binding UserReportDisplay}"
                                                        ToolTip="{Binding UserReportTooltip}"
                                                        Click="UserReportsButton_OnClick"
                                                        IsEnabled="{Binding CanSubmitUserReport}"
                                                        HorizontalAlignment="Stretch" ClipToBounds="True">
                                                        <Button.Style>
                                                            <Style TargetType="{x:Type Button}"
                                                                BasedOn="{StaticResource IMM.UserReportButtonStyle}">
                                                                <Setter Property="HorizontalAlignment" Value="Stretch" />
                                                                <Setter Property="Padding" Value="4,0" />
                                                                <Style.Triggers>
                                                                    <DataTrigger Binding="{Binding IsUserReportLoading}"
                                                                        Value="True">
                                                                        <Setter Property="Cursor" Value="Wait" />
                                                                    </DataTrigger>
                                                                    <DataTrigger Binding="{Binding UserReportHasError}"
                                                                        Value="True">
                                                                        <Setter Property="Foreground"
                                                                            Value="{DynamicResource Brush.Text.Emphasis}" />
                                                                    </DataTrigger>
                                                                </Style.Triggers>
                                                            </Style>
                                                        </Button.Style>
                                                    </Button>
                                                </DataTemplate>
                                            </DataGridTemplateColumn.CellTemplate>
                                        </DataGridTemplateColumn>
                                        <DataGridTextColumn x:Name="SideColumn" Header="Side"
                                            Binding="{Binding SideDisplay, Mode=OneWay}"
                                            SortMemberPath="SideSortValue"
                                            Width="90"
                                            MinWidth="80"
                                            IsReadOnly="True"
                                            ElementStyle="{StaticResource IMM.DataGridCenteredTextStyle}"
                                            CellStyle="{StaticResource IMM.DataGridCenteredCellStyle}" />
                                    </DataGrid.Columns>
                                </DataGrid>
                            </Border>
                            <TextBlock
                                Panel.ZIndex="1"
                                Margin="32"
                                Text="{Binding NoModsFoundMessage}"
                                TextWrapping="Wrap"
                                TextAlignment="Center"
                                HorizontalAlignment="Center"
                                VerticalAlignment="Center"
                                FontSize="16"
                                Foreground="{DynamicResource Brush.Text.Primary}"
                                IsHitTestVisible="False" Grid.Row="1">
                                <TextBlock.Style>
                                    <Style TargetType="{x:Type TextBlock}">
                                        <Setter Property="Visibility" Value="Collapsed" />
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding TotalMods}" Value="0">
                                                <Setter Property="Visibility" Value="Visible" />
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </TextBlock.Style>
                            </TextBlock>
                        </Grid>
                    </Border>
                </TabItem>

                <!-- ============================================================ -->
                <!-- TAB 2: Mod Database Tab (Browse and Install from ModDB) -->
                <!-- ============================================================ -->
                <TabItem x:Name="DatabaseTab" Header="Mod Database" Padding="8,6,8,6" Height="Auto" Width="Auto">
                    <Border Margin="8,0,8,0" Background="{DynamicResource Brush.MiddleTab.Background.Selected}" CornerRadius="0,8,0,0" >
                        <Grid x:Name="DatabaseGrid">

                            <!-- Mod Database DataGrid View -->
                            <Border x:Name="DatabaseBorder"
                                Margin="0,48,0,0"
                                Background="Transparent"
                                CornerRadius="{Binding (ui:ControlHelper.CornerRadius), ElementName=ModsDataGrid}"
                                SnapsToDevicePixels="True"
                                Visibility="Visible">

                                <DataGrid x:Name="ModDbDataGrid"
                                    ItemsSource="{Binding SearchResultsView}"
                                    AutoGenerateColumns="False"
                                    CanUserAddRows="False"
                                    CanUserDeleteRows="False"
                                    IsReadOnly="False"
                                    EnableRowVirtualization="True"
                                    VirtualizingPanel.IsVirtualizing="True"
                                    VirtualizingPanel.VirtualizationMode="Recycling"
                                    ScrollViewer.CanContentScroll="True"
                                    GridLinesVisibility="None"
                                    SelectionUnit="FullRow"
                                    SelectionMode="Single"

                                    RowHeaderWidth="0"
                                    BorderThickness="0,1,2,1"
                                    IsSynchronizedWithCurrentItem="False"
                                    MinColumnWidth="20"
                                    SelectionChanged="ModsDataGrid_OnSelectionChanged"
                                    Foreground="{DynamicResource Brush.Text.Primary}"
                                    PreviewKeyDown="ModsDataGrid_OnPreviewKeyDown"
                                    PreviewMouseLeftButtonDown="ModsDataGrid_OnPreviewMouseLeftButtonDown"
                                    PreviewMouseWheel="ModsDataGrid_OnPreviewMouseWheel"
                                    Sorting="ModsDataGrid_OnSorting"
                                    RowBackground="{DynamicResource Brush.Button.Primary.Background.Normal}"
                                    HorizontalGridLinesBrush="Transparent"
                                    VerticalGridLinesBrush="Transparent"
                                    HeadersVisibility="Column"
                                    ui:ControlHelper.CornerRadius="0"
                                    FontSize="15"
                                    Background="{DynamicResource Brush.Panel.Secondary.Background.Solid}"
                                    BorderBrush="{DynamicResource Brush.Panel.Secondary.Background.Solid}">
                                    <DataGrid.Resources>
                                        <Style TargetType="{x:Type ScrollBar}"
                                            BasedOn="{StaticResource IMM.DataGridScrollBarStyle}" />
                                        <Style TargetType="{x:Type Thumb}"
                                            BasedOn="{StaticResource IMM.DataGridScrollBarThumbStyle}" />
                                        <Style TargetType="{x:Type TextBlock}">
                                            <Setter Property="TextWrapping" Value="Wrap" />
                                        </Style>
                                        <Style TargetType="{x:Type DataGridColumnHeader}"
                                            BasedOn="{StaticResource IMM.PrimaryDataGridColumnHeaderStyle}" />
                                    </DataGrid.Resources>
                                    <DataGrid.CellStyle>
                                        <StaticResource ResourceKey="IMM.DataGridCellBaseStyle" />
                                    </DataGrid.CellStyle>
                                    <DataGrid.Style>
                                        <Style TargetType="{x:Type DataGrid}">
                                            <Setter Property="CanUserSortColumns" Value="False" />
                                            <Setter Property="IsEnabled" Value="True" />
                                            <Setter Property="Visibility" Value="Visible" />

                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding UseModDbDesignView}" Value="True">
                                                    <Setter Property="Visibility" Value="Collapsed" />
                                                    <Setter Property="IsEnabled" Value="False" />
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </DataGrid.Style>

                                    <DataGrid.RowHeaderStyle>

                                        <Style />
                                    </DataGrid.RowHeaderStyle>
                                    <DataGrid.RowStyle>
                                        <Style TargetType="{x:Type DataGridRow}" BasedOn="{StaticResource IMM.ModDbDataGridRowBaseStyle}">
                                            <EventSetter Event="UIElement.PreviewMouseLeftButtonDown"
                                                Handler="ModsDataGridRow_OnPreviewMouseLeftButtonDown" />
                                            <EventSetter Event="FrameworkElement.Loaded" Handler="ModsDataGridRow_OnLoaded" />
                                            <EventSetter Event="FrameworkElement.Unloaded"
                                                Handler="ModsDataGridRow_OnUnloaded" />
                                            <EventSetter Event="UIElement.MouseEnter"
                                                Handler="ModsDataGridRow_OnMouseEnter" />
                                            <EventSetter Event="UIElement.MouseLeave"
                                                Handler="ModsDataGridRow_OnMouseLeave" />
                                        </Style>
                                    </DataGrid.RowStyle>
                                    <DataGrid.Columns>
                                        <DataGridTextColumn x:Name="ModDbNameColumn1" Header="Name"
                                            Binding="{Binding DisplayName, Mode=OneWay}" Width="220"
                                            SortMemberPath="NameSortKey" IsReadOnly="True">
                                            <DataGridTextColumn.ElementStyle>
                                                <Style TargetType="{x:Type TextBlock}">
                                                    <Setter Property="FontFamily" Value="Segoe UI" />
                                                    <Setter Property="FontWeight" Value="Bold" />
                                                    <Setter Property="ToolTipService.ShowDuration" Value="60000" />
                                                    <Setter Property="ToolTipService.InitialShowDelay" Value="200" />
                                                    <Setter Property="HorizontalAlignment" Value="Stretch" />
                                                    <Setter Property="VerticalAlignment" Value="Center" />
                                                    <Setter Property="TextAlignment" Value="Left" />
                                                    <Setter Property="Margin" Value="15,0,0,0" />
                                                    <Setter Property="ToolTipService.ToolTip">
                                                        <Setter.Value>
                                                            <TextBlock Text="{Binding Tooltip}"
                                                                FontFamily="Segoe UI"
                                                                FontSize="12"
                                                                FontWeight="Normal"
                                                                MaxWidth="300"
                                                                Foreground="{DynamicResource Brush.ToolTip.Text}"
                                                                TextWrapping="Wrap" />
                                                        </Setter.Value>
                                                    </Setter>
                                                </Style>
                                            </DataGridTextColumn.ElementStyle>
                                            <DataGridTextColumn.CellStyle>
                                                <Style TargetType="{x:Type DataGridCell}"
                                                    BasedOn="{StaticResource IMM.DataGridCellBaseStyle}">
                                                    <Setter Property="HorizontalContentAlignment" Value="Center" />
                                                    <Setter Property="VerticalContentAlignment" Value="Center" />
                                                </Style>
                                            </DataGridTextColumn.CellStyle>
                                        </DataGridTextColumn>
                                        <DataGridTemplateColumn x:Name="ModDbInstalledColumn1" Header="Installed" Width="85"
                                            IsReadOnly="True" CellStyle="{StaticResource IMM.DataGridCenteredCellStyle}">
                                            <DataGridTemplateColumn.CellTemplate>
                                                <DataTemplate>
                                                    <TextBlock Text=""
                                                        Foreground="{DynamicResource Brush.Accent.Primary}"
                                                        FontSize="16"
                                                        FontWeight="Bold"
                                                        HorizontalAlignment="Center"
                                                        VerticalAlignment="Center">
                                                        <TextBlock.Style>
                                                            <Style TargetType="{x:Type TextBlock}">
                                                                <Setter Property="Visibility" Value="Collapsed" />
                                                                <Style.Triggers>
                                                                    <DataTrigger Binding="{Binding IsInstalled}"
                                                                        Value="True">
                                                                        <Setter Property="Visibility" Value="Visible" />
                                                                    </DataTrigger>
                                                                </Style.Triggers>
                                                            </Style>
                                                        </TextBlock.Style>
                                                    </TextBlock>
                                                </DataTemplate>
                                            </DataGridTemplateColumn.CellTemplate>
                                        </DataGridTemplateColumn>
                                        <DataGridTextColumn x:Name="ModDbLatestVersionColumn1" Header="Latest Version"
                                            Binding="{Binding LatestDatabaseVersionDisplay, Mode=OneWay}"
                                            SortMemberPath="LatestVersionSortKey" Width="140"
                                            MinWidth="139" IsReadOnly="True">
                                            <DataGridTextColumn.ElementStyle>
                                                <Style TargetType="{x:Type TextBlock}">
                                                    <Setter Property="HorizontalAlignment" Value="Center" />
                                                    <Setter Property="VerticalAlignment" Value="Center" />
                                                    <Setter Property="Padding" Value="4,2" />
                                                    <Setter Property="Margin" Value="2" />
                                                    <Setter Property="ToolTipService.ShowDuration" Value="60000" />
                                                    <Setter Property="ToolTip">
                                                        <Setter.Value>
                                                            <ToolTip MaxHeight="600"
                                                                MaxWidth="300"
                                                                Padding="0">
                                                                <Border MaxHeight="600"
                                                                    MaxWidth="300"
                                                                    ClipToBounds="True">
                                                                    <ItemsControl
                                                                        ItemsSource="{Binding NewerReleaseChangelogs}">
                                                                        <ItemsControl.ItemTemplate>
                                                                            <DataTemplate>
                                                                                <StackPanel Margin="0,0,0,12"
                                                                                    MaxWidth="300">
                                                                                    <TextBlock Text="{Binding Version}"
                                                                                        FontWeight="Bold"
                                                                                        Margin="0,0,0,4"
                                                                                        Foreground="{DynamicResource Brush.ToolTip.Text}" />
                                                                                    <TextBlock Text="{Binding Changelog}"
                                                                                        TextWrapping="Wrap"
                                                                                        Foreground="{DynamicResource Brush.ToolTip.Text}"
                                                                                        MaxWidth="300" />
                                                                                </StackPanel>
                                                                            </DataTemplate>
                                                                        </ItemsControl.ItemTemplate>
                                                                    </ItemsControl>
                                                                </Border>
                                                            </ToolTip>
                                                        </Setter.Value>
                                                    </Setter>
                                                    <EventSetter Event="FrameworkElement.ToolTipOpening"
                                                        Handler="LatestVersionTextBlock_OnToolTipOpening" />
                                                    <EventSetter Event="FrameworkElement.ToolTipClosing"
                                                        Handler="LatestVersionTextBlock_OnToolTipClosing" />
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding ShouldHighlightLatestVersion}"
                                                            Value="True">
                                                            <Setter Property="Foreground"
                                                                Value="{DynamicResource Brush.Text.Primary}" />
                                                        </DataTrigger>
                                                        <DataTrigger Binding="{Binding HasNewerReleaseChangelogs}"
                                                            Value="False">
                                                            <Setter Property="ToolTip" Value="{x:Null}" />
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </DataGridTextColumn.ElementStyle>
                                            <DataGridTextColumn.CellStyle>
                                                <Style TargetType="{x:Type DataGridCell}"
                                                    BasedOn="{StaticResource IMM.DataGridCellBaseStyle}">
                                                    <Setter Property="HorizontalContentAlignment" Value="Center" />
                                                    <Setter Property="VerticalContentAlignment" Value="Center" />
                                                </Style>
                                            </DataGridTextColumn.CellStyle>
                                        </DataGridTextColumn>
                                        <DataGridTextColumn x:Name="ModDbDownloadsColumn1"
                                            Width="120"
                                            MinWidth="110"
                                            IsReadOnly="True">
                                            <DataGridTextColumn.Header>
                                                <TextBlock Text="Downloads" />
                                            </DataGridTextColumn.Header>
                                            <DataGridTextColumn.Binding>
                                                <MultiBinding
                                                    Converter="{StaticResource IMM.DownloadMetricDisplayConverter}">
                                                    <Binding Path="DataContext.IsShowingRecentDownloadMetric"
                                                        RelativeSource="{RelativeSource AncestorType={x:Type DataGrid}}" />
                                                    <Binding Path="DownloadsDisplay" />
                                                    <Binding Path="RecentDownloadsDisplay" />
                                                    <Binding Path="TenDayDownloadsDisplay" />
                                                    <Binding Path="DataContext.ModDatabaseAutoLoadMode"
                                                        RelativeSource="{RelativeSource AncestorType={x:Type DataGrid}}" />
                                                </MultiBinding>
                                            </DataGridTextColumn.Binding>
                                            <DataGridTextColumn.ElementStyle>
                                                <Style TargetType="{x:Type TextBlock}">
                                                    <Setter Property="HorizontalAlignment" Value="Center" />
                                                    <Setter Property="VerticalAlignment" Value="Center" />
                                                </Style>
                                            </DataGridTextColumn.ElementStyle>
                                            <DataGridTextColumn.CellStyle>
                                                <Style TargetType="{x:Type DataGridCell}"
                                                    BasedOn="{StaticResource IMM.DataGridCellBaseStyle}">
                                                    <Setter Property="HorizontalContentAlignment" Value="Center" />
                                                    <Setter Property="VerticalContentAlignment" Value="Center" />
                                                </Style>
                                            </DataGridTextColumn.CellStyle>
                                        </DataGridTextColumn>


                                        <DataGridTextColumn x:Name="ModDbAuthorsColumn1" Header="Authors"
                                            Binding="{Binding AuthorsDisplay, Mode=OneWay}" Width="150"
                                            IsReadOnly="True">
                                            <DataGridTextColumn.ElementStyle>
                                                <Style TargetType="{x:Type TextBlock}">
                                                    <Setter Property="TextWrapping" Value="NoWrap" />
                                                    <Setter Property="TextTrimming" Value="CharacterEllipsis" />
                                                    <Setter Property="HorizontalAlignment" Value="Stretch" />
                                                    <Setter Property="VerticalAlignment" Value="Center" />
                                                    <Setter Property="TextAlignment" Value="Center" />
                                                    <Setter Property="ToolTipService.ShowDuration" Value="60000" />
                                                    <Setter Property="ToolTipService.InitialShowDelay" Value="200" />
                                                    <Setter Property="ToolTipService.ToolTip">
                                                        <Setter.Value>
                                                            <TextBlock Text="{Binding AuthorsDisplay}"
                                                                FontFamily="Segoe UI"
                                                                FontSize="12"
                                                                Foreground="{DynamicResource Brush.ToolTip.Text}"
                                                                TextWrapping="Wrap"
                                                                MaxWidth="300" />
                                                        </Setter.Value>
                                                    </Setter>
                                                </Style>
                                            </DataGridTextColumn.ElementStyle>
                                            <DataGridTextColumn.CellStyle>
                                                <Style TargetType="{x:Type DataGridCell}"
                                                    BasedOn="{StaticResource IMM.DataGridCellBaseStyle}">
                                                    <Setter Property="HorizontalContentAlignment" Value="Center" />
                                                    <Setter Property="VerticalContentAlignment" Value="Center" />
                                                </Style>
                                            </DataGridTextColumn.CellStyle>
                                        </DataGridTextColumn>
                                        <DataGridTemplateColumn x:Name="ModDbTagsColumn1"
                                            Header="Tags"
                                            Width="280"
                                            MinWidth="180"
                                            IsReadOnly="True"
                                            CanUserSort="False">
                                            <DataGridTemplateColumn.HeaderTemplate>
                                                <DataTemplate>
                                                    <Grid Background="Transparent"
                                                        Width="{Binding ActualWidth, RelativeSource={RelativeSource AncestorType={x:Type DataGridColumnHeader}}}">
                                                        <ToggleButton x:Name="TagsHeaderToggle"
                                                            Content="{Binding DataContext.TagsColumnHeader, RelativeSource={RelativeSource AncestorType={x:Type Window}}}"
                                                            Style="{StaticResource IMM.TagHeaderToggleButtonStyle}" />
                                                        <Popup PlacementTarget="{Binding ElementName=TagsHeaderToggle}"
                                                            Placement="Bottom"
                                                            IsOpen="{Binding IsChecked, ElementName=TagsHeaderToggle, Mode=TwoWay}"
                                                            StaysOpen="False"
                                                            AllowsTransparency="True"
                                                            Focusable="False">
                                                            <Border
                                                                Background="{DynamicResource Brush.Panel.Primary.Background.Solid}"
                                                                BorderBrush="{DynamicResource Brush.Panel.Secondary.Background.Solid}"
                                                                BorderThickness="1"
                                                                CornerRadius="6"
                                                                Padding="8"
                                                                MinWidth="440">
                                                                <ScrollViewer MaxHeight="260"
                                                                    HorizontalScrollBarVisibility="Disabled"
                                                                    VerticalScrollBarVisibility="Auto">
                                                                    <ScrollViewer.Resources>
                                                                        <Style TargetType="{x:Type ScrollBar}"
                                                                            BasedOn="{StaticResource IMM.DataGridScrollBarStyle}" />
                                                                        <Style TargetType="{x:Type Thumb}"
                                                                            BasedOn="{StaticResource IMM.DataGridScrollBarThumbStyle}" />
                                                                    </ScrollViewer.Resources>
                                                                    <ItemsControl
                                                                        ItemsPanel="{StaticResource IMM.TagFilterItemsPanelTemplate}"
                                                                        ItemsSource="{Binding DataContext.ModDatabaseTagFilters, RelativeSource={RelativeSource AncestorType={x:Type Window}}}">
                                                                        <ItemsControl.ItemTemplate>
                                                                            <DataTemplate
                                                                                DataType="{x:Type viewModels:TagFilterOptionViewModel}">
                                                                                <ToggleButton
                                                                                    Style="{StaticResource IMM.TagFilterToggleButtonStyle}"
                                                                                    Content="{Binding Name}"
                                                                                    IsChecked="{Binding IsSelected, Mode=TwoWay}" />
                                                                            </DataTemplate>
                                                                        </ItemsControl.ItemTemplate>
                                                                    </ItemsControl>
                                                                </ScrollViewer>
                                                            </Border>
                                                        </Popup>
                                                    </Grid>
                                                </DataTemplate>
                                            </DataGridTemplateColumn.HeaderTemplate>
                                            <DataGridTemplateColumn.CellTemplate>
                                                <DataTemplate>
                                                    <Grid>
                                                        <Border x:Name="TagsContainer"
                                                            HorizontalAlignment="Stretch"
                                                            VerticalAlignment="Center"
                                                            MaxHeight="{StaticResource IMM.TagRowMaxHeight}"
                                                            ClipToBounds="True">
                                                            <ItemsControl x:Name="TagsItemsControl"
                                                                Width="{Binding ActualWidth, RelativeSource={RelativeSource AncestorType={x:Type DataGridCell}}}"
                                                                HorizontalAlignment="Left"
                                                                ItemsSource="{Binding DatabaseTags}"
                                                                ItemTemplate="{StaticResource IMM.TagBadgeTemplate}"
                                                                ItemsPanel="{StaticResource IMM.TagItemsPanelTemplate}" />
                                                        </Border>
                                                        <TextBlock x:Name="NoTagsText"
                                                            Text=""
                                                            HorizontalAlignment="Center"
                                                            VerticalAlignment="Center"
                                                            Visibility="Collapsed" />
                                                    </Grid>
                                                    <DataTemplate.Triggers>
                                                        <DataTrigger Binding="{Binding DatabaseTags.Count}" Value="0">
                                                            <Setter TargetName="TagsContainer" Property="Visibility"
                                                                Value="Collapsed" />
                                                            <Setter TargetName="NoTagsText" Property="Visibility"
                                                                Value="Visible" />
                                                        </DataTrigger>
                                                        <DataTrigger
                                                            Binding="{Binding DataContext.IsCompactView, RelativeSource={RelativeSource AncestorType={x:Type Window}}}"
                                                            Value="True">
                                                            <Setter TargetName="TagsContainer" Property="MaxHeight"
                                                                Value="{StaticResource IMM.TagRowCompactMaxHeight}" />
                                                        </DataTrigger>
                                                    </DataTemplate.Triggers>
                                                </DataTemplate>
                                            </DataGridTemplateColumn.CellTemplate>
                                            <DataGridTemplateColumn.CellStyle>
                                                <Style TargetType="{x:Type DataGridCell}"
                                                    BasedOn="{StaticResource IMM.DataGridCellBaseStyle}">
                                                    <Setter Property="HorizontalContentAlignment" Value="Stretch" />
                                                    <Setter Property="VerticalContentAlignment" Value="Center" />
                                                </Style>
                                            </DataGridTemplateColumn.CellStyle>
                                        </DataGridTemplateColumn>
                                        <DataGridTemplateColumn x:Name="ModDbUserReportsColumn1" Header="User Reports"
                                            Width="150" IsReadOnly="True">
                                            <DataGridTemplateColumn.CellStyle>
                                                <Style TargetType="{x:Type DataGridCell}"
                                                    BasedOn="{StaticResource IMM.DataGridCellBaseStyle}">
                                                    <Setter Property="HorizontalContentAlignment" Value="Center" />
                                                    <Setter Property="VerticalContentAlignment" Value="Center" />
                                                </Style>
                                            </DataGridTemplateColumn.CellStyle>
                                            <DataGridTemplateColumn.CellTemplate>
                                                <DataTemplate>
                                                    <Button
                                                        Content="{Binding UserReportDisplay}"
                                                        ToolTip="{Binding UserReportTooltip}"
                                                        Click="UserReportsButton_OnClick"
                                                        IsEnabled="{Binding CanSubmitUserReport}"
                                                        HorizontalAlignment="Stretch" ClipToBounds="True">
                                                        <Button.Style>
                                                            <Style TargetType="{x:Type Button}"
                                                                BasedOn="{StaticResource IMM.UserReportButtonStyle}">
                                                                <Setter Property="HorizontalAlignment" Value="Stretch" />
                                                                <Setter Property="Padding" Value="4,0" />
                                                                <Style.Triggers>
                                                                    <DataTrigger Binding="{Binding IsUserReportLoading}"
                                                                        Value="True">
                                                                        <Setter Property="Cursor" Value="Wait" />
                                                                    </DataTrigger>
                                                                    <DataTrigger Binding="{Binding UserReportHasError}"
                                                                        Value="True">
                                                                        <Setter Property="Foreground"
                                                                            Value="{DynamicResource Brush.Text.Emphasis}" />
                                                                    </DataTrigger>
                                                                </Style.Triggers>
                                                            </Style>
                                                        </Button.Style>
                                                    </Button>
                                                </DataTemplate>
                                            </DataGridTemplateColumn.CellTemplate>
                                        </DataGridTemplateColumn>
                                        <DataGridTextColumn x:Name="ModDbSideColumn1" Header="Side"
                                            Binding="{Binding SideDisplay, Mode=OneWay}"
                                            SortMemberPath="SideSortValue"
                                            Width="90"
                                            MinWidth="80"
                                            IsReadOnly="True"
                                            ElementStyle="{StaticResource IMM.DataGridCenteredTextStyle}"
                                            CellStyle="{StaticResource IMM.DataGridCenteredCellStyle}" />
                                    </DataGrid.Columns>
                                </DataGrid>
                            </Border>
                            <Grid x:Name="DatabaseControls" Height="48" VerticalAlignment="Top" Margin="10,0,0,0" Grid.RowSpan="1" Grid.ColumnSpan="1" HorizontalAlignment="Left" Width="1174">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto" MinWidth="614" />

                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition />

                                </Grid.RowDefinitions>
                                <TabControl x:Name="SortingTab" Margin="205,0,0,0" Padding="0" Width="335" HorizontalAlignment="Left" TabStripPlacement="Left" UseLayoutRounding="False" VerticalContentAlignment="Bottom" VerticalAlignment="Center" Background="Transparent">
                                    <TabControl.Resources>
                                        <Style TargetType="{x:Type TabItem}">
                                            <Setter Property="FontSize" Value="10"/>
                                            <Setter Property="Padding" Value="0"/>
                                            <Setter Property="MinHeight" Value="0"/>
                                            <Setter Property="MinWidth" Value="0"/>
                                            <Setter Property="Foreground" Value="{DynamicResource Brush.Text.Primary}"/>
                                            <Setter Property="Background" Value="{DynamicResource Brush.Button.Primary.Background.Normal}"/>
                                            <Setter Property="BorderBrush" Value="{DynamicResource Brush.Button.Primary.Background.Normal}"/>
                                            <Setter Property="BorderThickness" Value="0"/>
                                            <Setter Property="HorizontalContentAlignment" Value="Stretch"/>
                                            <Setter Property="VerticalContentAlignment" Value="Center"/>
                                            <Setter Property="Template">
                                                <Setter.Value>
                                                    <ControlTemplate TargetType="{x:Type TabItem}">
                                                        <Border x:Name="Border"
                                                            Background="{TemplateBinding Background}"
                                                            BorderBrush="{TemplateBinding BorderBrush}"
                                                            BorderThickness="{TemplateBinding BorderThickness}"
                                                            CornerRadius="6,0,0,6"
                                                            Padding="{TemplateBinding Padding}"
                                                            Margin="0,0">
                                                            <ContentPresenter x:Name="ContentSite"
                                                                ContentSource="Header"
                                                                HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                                                VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
                                                                RecognizesAccessKey="True"/>
                                                        </Border>
                                                        <ControlTemplate.Triggers>
                                                            <!-- Unselected (Normal) State -->
                                                            <Trigger Property="IsSelected" Value="False">
                                                                <Setter TargetName="Border" Property="Background" Value="{DynamicResource Brush.Panel.Secondary.Background.Solid}"/>
                                                                <Setter Property="Foreground" Value="{DynamicResource Brush.Text.Placeholder}"/>
                                                                <Setter Property="Opacity" Value="0.6"/>
                                                            </Trigger>

                                                            <!-- Selected State -->
                                                            <Trigger Property="IsSelected" Value="True">
                                                                <Setter TargetName="Border" Property="Background" Value="{DynamicResource Brush.Button.Primary.Background.Normal}"/>
                                                                <Setter Property="Foreground" Value="{DynamicResource Brush.Text.Primary}"/>
                                                                <Setter Property="Opacity" Value="1"/>
                                                            </Trigger>

                                                            <!-- Hover State (when not selected) -->
                                                            <MultiTrigger>
                                                                <MultiTrigger.Conditions>
                                                                    <Condition Property="IsMouseOver" Value="True"/>
                                                                    <Condition Property="IsSelected" Value="False"/>
                                                                </MultiTrigger.Conditions>
                                                                <Setter TargetName="Border" Property="Background" Value="{DynamicResource Brush.Button.Primary.Background.Hover}"/>
                                                                <Setter Property="Opacity" Value="0.8"/>
                                                            </MultiTrigger>

                                                            <!-- Disabled State -->
                                                            <Trigger Property="IsEnabled" Value="False">
                                                                <Setter Property="Opacity" Value="0.4"/>
                                                                <Setter Property="Foreground" Value="{DynamicResource Brush.Text.Placeholder}"/>
                                                            </Trigger>
                                                        </ControlTemplate.Triggers>
                                                    </ControlTemplate>
                                                </Setter.Value>
                                            </Setter>
                                        </Style>
                                    </TabControl.Resources>
                                    <TabItem x:Name="Downloads" Header="Downloads" VerticalContentAlignment="Center" UseLayoutRounding="False" HorizontalContentAlignment="Center" Height="20" Padding="5,0,5,0" VerticalAlignment="Top" Margin="0,-4,0,0" FontSize="12">
                                        <Grid Height="40" Width="255" HorizontalAlignment="Center">
                                            <Border Background="{DynamicResource Brush.Button.Primary.Background.Normal}" CornerRadius="0,10,10,0" Margin="-3,0,18,0" />
                                            <RadioButton Content="All time"
                                                GroupName="ModDatabaseAutoLoadMode"
                                                IsChecked="{Binding IsTotalDownloadsMode, Mode=TwoWay}" MinWidth="65"
                                                ClickMode="Press"
                                                Margin="8,6,0,0" HorizontalAlignment="Left" Width="122"
                                                VerticalContentAlignment="Center" VerticalAlignment="Top" Height="16"
                                                Style="{StaticResource IMM.ToggleRadioButtonStyle}" Foreground="{DynamicResource Brush.Text.Primary}" />
                                            <RadioButton Content="Last 30 days"
                                                GroupName="ModDatabaseAutoLoadMode"
                                                IsChecked="{Binding IsDownloadsLastThirtyDaysMode, Mode=TwoWay}" MinWidth="90"
                                                ClickMode="Press" Margin="8,20,0,0" HorizontalAlignment="Left" Width="122"
                                                VerticalContentAlignment="Center" VerticalAlignment="Top" Height="16"
                                                Style="{StaticResource IMM.ToggleRadioButtonStyle}" Foreground="{DynamicResource Brush.Text.Primary}" />
                                            <RadioButton Content="Last 10 days"
                                                GroupName="ModDatabaseAutoLoadMode"
                                                IsChecked="{Binding IsDownloadsLastTenDaysMode, Mode=TwoWay}" MinWidth="90"
                                                ClickMode="Press" Margin="105,6,0,0" HorizontalAlignment="Left" Width="124"
                                                VerticalContentAlignment="Center" VerticalAlignment="Top" Height="16"
                                                Style="{StaticResource IMM.ToggleRadioButtonStyle}" Foreground="{DynamicResource Brush.Text.Primary}" />
                                            <RadioButton Content="Added last 30 days"
                                                GroupName="ModDatabaseAutoLoadMode"
                                                IsChecked="{Binding IsAddedLast30DaysMode, Mode=TwoWay}" MinWidth="90"
                                                ClickMode="Press" Margin="105,20,0,0" HorizontalAlignment="Left" Width="124"
                                                VerticalContentAlignment="Center" VerticalAlignment="Top" Height="16"
                                                Style="{StaticResource IMM.ToggleRadioButtonStyle}" Foreground="{DynamicResource Brush.Text.Primary}" />
                                        </Grid>
                                    </TabItem>
                                    <TabItem x:Name="Activity" Header="Activity" HorizontalContentAlignment="Center" Height="20" Padding="5,0,5,0" UseLayoutRounding="False" VerticalAlignment="Top" Margin="0,-4,0,0" FontSize="12">
                                        <Grid HorizontalAlignment="Left" Width="257" Height="40">
                                            <Border Background="{DynamicResource Brush.Button.Primary.Background.Normal}" Height="40" CornerRadius="0,10,10,0" VerticalAlignment="Center" Margin="-3,0,20,0" />

                                            <RadioButton x:Name="RecentlyAdded" Content="Recently added"
                                                GroupName="ModDatabaseAutoLoadMode"
                                                IsChecked="{Binding IsRecentlyAddedMode, Mode=TwoWay}"
                                                ClickMode="Press" HorizontalAlignment="Left" Width="117"
                                                VerticalContentAlignment="Center" Margin="8,6,0,0" VerticalAlignment="Top" Height="16" 
                                                Style="{StaticResource IMM.ToggleRadioButtonStyle}" Foreground="{DynamicResource Brush.Text.Primary}" UseLayoutRounding="True" />
                                            <RadioButton x:Name="RecentlyUpdated" Content="Recently updated"
                                                GroupName="ModDatabaseAutoLoadMode"
                                                IsChecked="{Binding IsRecentlyUpdatedMode, Mode=TwoWay}"
                                                ClickMode="Press" Margin="8,20,0,0" HorizontalAlignment="Left" Width="117"
                                                VerticalContentAlignment="Center" VerticalAlignment="Top" Height="16" 
                                                Style="{StaticResource IMM.ToggleRadioButtonStyle}" Foreground="{DynamicResource Brush.Text.Primary}" />
                                            <RadioButton x:Name="MostTrending" Content="Most trending"
                                                GroupName="ModDatabaseAutoLoadMode"
                                                IsChecked="{Binding IsMostTrendingMode, Mode=TwoWay}" MinWidth="100"
                                                ClickMode="Press" Margin="124,6,0,0" HorizontalAlignment="Left" Width="100"
                                                VerticalContentAlignment="Center" VerticalAlignment="Top" Height="16"
                                                Style="{StaticResource IMM.ToggleRadioButtonStyle}" Foreground="{DynamicResource Brush.Text.Primary}" />
                                            <RadioButton x:Name="Random" Content="Random"
                                                GroupName="ModDatabaseAutoLoadMode"
                                                IsChecked="{Binding IsRandomMode, Mode=TwoWay}" MinWidth="100"
                                                ClickMode="Press" Margin="124,20,0,0" HorizontalAlignment="Left" Width="100"
                                                VerticalContentAlignment="Center" VerticalAlignment="Top" Height="16"
                                                Style="{StaticResource IMM.ToggleRadioButtonStyle}" Foreground="{DynamicResource Brush.Text.Primary}" />
                                        </Grid>
                                    </TabItem>
                                </TabControl>
                                <StackPanel x:Name="Checkboxes" Margin="533,0,0,0" HorizontalAlignment="Left" VerticalAlignment="Center" Height="34">
                                    <CheckBox Content="Include installed mods"
                                        IsChecked="{Binding IncludeInstalledModDatabaseResults, Mode=TwoWay}"
                                        FontSize="12"
                                        Style="{StaticResource IMM.ToggleCheckBoxStyle}" Foreground="{DynamicResource Brush.Text.Primary}" Height="16" VerticalAlignment="Center" HorizontalAlignment="Left" />
                                    <CheckBox Content="Only show compatible mods"
                                        IsChecked="{Binding OnlyShowCompatibleModDatabaseResults, Mode=TwoWay}"
                                        FontSize="12"
                                        HorizontalAlignment="Left"
                                        Style="{StaticResource IMM.ToggleCheckBoxStyle}" Foreground="{DynamicResource Brush.Text.Primary}" Height="15" VerticalAlignment="Center" />
                                </StackPanel>
                                <TextBox x:Name="DatabaseSearch" MinWidth="200"
                                    Text="{Binding SearchText, UpdateSourceTrigger=PropertyChanged}"
                                    FontSize="14" VerticalContentAlignment="Center" HorizontalContentAlignment="Left" Height="32" VerticalAlignment="Center" HorizontalAlignment="Left" Grid.RowSpan="2"
                                    Style="{StaticResource IMM.SearchTextBoxStyle}"
                                    ui:ControlHelper.PlaceholderText="Search Mod Database" Padding="2,3,6,3" />
                            </Grid>
                            <ListView x:Name="ModDatabaseCardsListView"
                                ItemsSource="{Binding CurrentModsView}"
                                Background="{DynamicResource Brush.Panel.Secondary.Background.Solid}"
                                BorderThickness="1,1,1,1"
                                Margin="8,48,8,0"
                                ui:ControlHelper.CornerRadius="0"
                                SelectionMode="Single"
                                SelectionChanged="ModDatabaseCardsListView_OnSelectionChanged"
                                PreviewMouseWheel="ModsDataGrid_OnPreviewMouseWheel"
                                ScrollViewer.ScrollChanged="ModDatabaseCardsListView_OnScrollChanged"
                                ScrollViewer.HorizontalScrollBarVisibility="Disabled"
                                ScrollViewer.VerticalScrollBarVisibility="Auto"
                                ScrollViewer.CanContentScroll="True"
                                VirtualizingPanel.IsVirtualizing="True"
                                VirtualizingPanel.VirtualizationMode="Recycling" BorderBrush="{DynamicResource Brush.Panel.Secondary.Background.Solid}"
                                FontSize="16" d:ItemsSource="{d:SampleData ItemCount=5}">
                                <ListView.Style>
                                    <Style TargetType="{x:Type ListView}">
                                        <Setter Property="Visibility" Value="Collapsed" />
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding UseModDbDesignView}" Value="True">
                                                <Setter Property="Visibility" Value="Visible" />
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </ListView.Style>
                                <ListView.ItemsPanel>
                                    <ItemsPanelTemplate>
                                        <WrapPanel Orientation="Horizontal"
                                            HorizontalAlignment="Center"
                                            Margin="0,20,0,72"
                                            ItemWidth="{Binding ConverterParameter=496, Converter={StaticResource IMM.ScaledDoubleConverter}, Source={StaticResource IMM.ModDbCardScale}}" />
                                    </ItemsPanelTemplate>
                                </ListView.ItemsPanel>
                                <ListView.ItemContainerStyle>
                                    <Style TargetType="{x:Type ListViewItem}">
                                        <Setter Property="Padding" Value="0" />
                                        <Setter Property="HorizontalContentAlignment" Value="Stretch" />
                                        <Setter Property="VerticalContentAlignment" Value="Stretch" />
                                        <Setter Property="Background" Value="Transparent" />
                                        <Setter Property="BorderThickness" Value="0" />
                                        <Setter Property="Template">
                                            <Setter.Value>
                                                <ControlTemplate TargetType="{x:Type ListViewItem}">
                                                    <ContentPresenter />
                                                </ControlTemplate>
                                            </Setter.Value>
                                        </Setter>
                                        <EventSetter Event="UIElement.PreviewMouseLeftButtonDown"
                                            Handler="ModDatabaseCard_OnPreviewMouseLeftButtonDown" />
                                    </Style>
                                </ListView.ItemContainerStyle>
                                <ListView.ItemTemplate>
                                    <DataTemplate DataType="{x:Type viewModels:ModListItemViewModel}">
                                        <Border Width="480"
                                            Height="480"
                                            Margin="{Binding LayoutTransform.(ScaleTransform.ScaleX), ConverterParameter=0\,0\,16\,16, Converter={StaticResource IMM.ScaledThicknessConverter}, RelativeSource={RelativeSource Mode=Self}}"
                                            CornerRadius="12"
                                            ClipToBounds="False">
                                            <Border.LayoutTransform>
                                                <ScaleTransform ScaleX="{StaticResource IMM.ModDbCardScale}"
                                                    ScaleY="{StaticResource IMM.ModDbCardScale}" />
                                            </Border.LayoutTransform>
                                            <Border.Effect>
                                                <DropShadowEffect
                                                    Color="{Binding Color, Source={StaticResource Brush.DataGrid.RowShadow}}"
                                                    BlurRadius="2" Direction="210" ShadowDepth="2" Opacity="0.5" />

                                            </Border.Effect>
                                            <Border.Style>
                                                <Style TargetType="{x:Type Border}">
                                                    <Setter Property="BorderBrush"
                                                        Value="{DynamicResource Brush.Panel.Secondary.Background.Solid}" />
                                                    <Setter Property="BorderThickness" Value="1" />
                                                    <Setter Property="Background"
                                                        Value="{DynamicResource Brush.Panel.Primary.Background.Solid}" />
                                                    <Style.Triggers>
                                                        <Trigger Property="IsMouseOver" Value="True">
                                                            <Setter Property="BorderBrush"
                                                                Value="{DynamicResource Brush.Button.Primary.Background.Hover}" />
                                                        </Trigger>
                                                        <DataTrigger Binding="{Binding IsSelected}" Value="True">
                                                            <Setter Property="BorderBrush"
                                                                Value="{DynamicResource Brush.Accent.Primary}" />
                                                            <Setter Property="BorderThickness" Value="2" />
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </Border.Style>

                                            <Grid>
                                                <Grid.RowDefinitions>
                                                    <RowDefinition Height="2*" />
                                                    <RowDefinition Height="*" />
                                                </Grid.RowDefinitions>

                                                <Border x:Name="CardImageContainer"
                                                    CornerRadius="12,12,0,0"
                                                    ClipToBounds="True"
                                                    Background="{DynamicResource Brush.DataGrid.Background}">
                                                    <Grid>
                                                        <!-- Default placeholder image -->
                                                        <Image Source="/VintageStoryModManager;component/Resources/mod-default.png"
                                                               Stretch="UniformToFill"
                                                               HorizontalAlignment="Center"
                                                               VerticalAlignment="Top">
                                                            <Image.Style>
                                                                <Style TargetType="{x:Type Image}">
                                                                    <Setter Property="Visibility" Value="Visible" />
                                                                    <Style.Triggers>
                                                                        <DataTrigger Binding="{Binding HasModDatabasePreviewImage}"
                                                                            Value="True">
                                                                            <Setter Property="Visibility" Value="Collapsed" />
                                                                        </DataTrigger>
                                                                    </Style.Triggers>
                                                                </Style>
                                                            </Image.Style>
                                                        </Image>
                                                        <!-- Actual mod image with proper binding -->
                                                        <Image Source="{Binding ModDatabasePreviewImage}"
                                                               Stretch="UniformToFill"
                                                               HorizontalAlignment="Center"
                                                               VerticalAlignment="Top">
                                                            <Image.Style>
                                                                <Style TargetType="{x:Type Image}">
                                                                    <Setter Property="Visibility" Value="Collapsed" />
                                                                    <Style.Triggers>
                                                                        <DataTrigger Binding="{Binding HasModDatabasePreviewImage}"
                                                                            Value="True">
                                                                            <Setter Property="Visibility" Value="Visible" />
                                                                        </DataTrigger>
                                                                    </Style.Triggers>
                                                                </Style>
                                                            </Image.Style>
                                                        </Image>
                                                        <TextBlock Text="Installed"
                                                            Margin="8"
                                                            Padding="6,2"
                                                            HorizontalAlignment="Left"
                                                            VerticalAlignment="Top"
                                                            FontSize="12"
                                                            FontWeight="SemiBold"
                                                            Foreground="{DynamicResource Brush.Text.Emphasis}"
                                                            Background="{DynamicResource Brush.Overlay.Success.Background}">
                                                            <TextBlock.Style>
                                                                <Style TargetType="{x:Type TextBlock}">
                                                                    <Setter Property="Visibility" Value="Collapsed" />
                                                                    <Style.Triggers>
                                                                        <DataTrigger Binding="{Binding IsInstalled}" Value="True">
                                                                            <Setter Property="Visibility" Value="Visible" />
                                                                        </DataTrigger>
                                                                    </Style.Triggers>
                                                                </Style>
                                                            </TextBlock.Style>
                                                        </TextBlock>
                                                        <StackPanel HorizontalAlignment="Right"
                                                            VerticalAlignment="Top"
                                                            Margin="0,8,8,0"
                                                            Orientation="Vertical">
                                                            <Border Background="{DynamicResource Brush.DataGrid.Background}"
                                                                CornerRadius="4"
                                                                Padding="3">
                                                                <Border.Style>
                                                                    <Style TargetType="{x:Type Border}">
                                                                        <Setter Property="Visibility" Value="Collapsed" />
                                                                        <Style.Triggers>
                                                                            <DataTrigger Binding="{Binding LatestReleaseIsCompatible}"
                                                                                Value="True">
                                                                                <Setter Property="Visibility" Value="Visible" />
                                                                            </DataTrigger>
                                                                        </Style.Triggers>
                                                                    </Style>
                                                                </Border.Style>
                                                                <TextBlock Text="Compatible"
                                                                    Foreground="{DynamicResource Brush.Text.Body}"
                                                                    FontSize="16" />
                                                            </Border>
                                                            <Border Background="{DynamicResource Brush.DataGrid.Background}"
                                                                CornerRadius="4"
                                                                Padding="3"
                                                                Margin="0,4,0,0">
                                                                <Border.Style>
                                                                    <Style TargetType="{x:Type Border}">
                                                                        <Setter Property="Visibility" Value="Collapsed" />
                                                                        <Style.Triggers>
                                                                            <DataTrigger Binding="{Binding HasLatestReleaseUserReport}"
                                                                                Value="True">
                                                                                <Setter Property="Visibility" Value="Visible" />
                                                                            </DataTrigger>
                                                                        </Style.Triggers>
                                                                    </Style>
                                                                </Border.Style>
                                                                <TextBlock Text="{Binding LatestReleaseUserReportDisplay}"
                                                                    Foreground="{DynamicResource Brush.Text.Body}"
                                                                    FontSize="14"
                                                                    ToolTip="{Binding LatestReleaseUserReportTooltip}" />
                                                            </Border>
                                                        </StackPanel>
                                                    </Grid>
                                                </Border>

                                                <Border Grid.Row="1"
                                                    Background="{DynamicResource Brush.Panel.Primary.Background.Solid}"
                                                    Padding="12,10,12,12"
                                                    CornerRadius="0,0,12,12">
                                                    <Grid>
                                                        <Grid.ColumnDefinitions>
                                                            <ColumnDefinition Width="*" />
                                                            <ColumnDefinition Width="Auto" />
                                                        </Grid.ColumnDefinitions>
                                                        <Grid.RowDefinitions>
                                                            <RowDefinition Height="Auto" />
                                                            <RowDefinition Height="Auto" />
                                                        </Grid.RowDefinitions>
                                                        <StackPanel Grid.Column="0"
                                                            Grid.RowSpan="2"
                                                            Orientation="Vertical">
                                                            <Button Command="{Binding OpenModDatabasePageCommand}"
                                                                FontSize="24"
                                                                FontWeight="SemiBold"
                                                                Padding="0"
                                                                Margin="0,0,0,4"
                                                                Background="Transparent"
                                                                BorderThickness="0"
                                                                HorizontalAlignment="Left"
                                                                Cursor="Hand"
                                                                IsEnabled="{Binding HasModDatabasePageLink}">
                                                                <Button.Style>
                                                                    <Style TargetType="{x:Type Button}">
                                                                        <Setter Property="Foreground"
                                                                            Value="{DynamicResource Brush.Text.Primary}" />
                                                                        <Setter Property="Template">
                                                                            <Setter.Value>
                                                                                <ControlTemplate TargetType="{x:Type Button}">
                                                                                    <ContentPresenter RecognizesAccessKey="True" />
                                                                                </ControlTemplate>
                                                                            </Setter.Value>
                                                                        </Setter>
                                                                        <Style.Triggers>
                                                                            <Trigger Property="IsMouseOver" Value="True">
                                                                                <Setter Property="Foreground"
                                                                                    Value="{DynamicResource Brush.Button.Primary.Background.Hover}" />
                                                                            </Trigger>
                                                                            <Trigger Property="IsEnabled" Value="False">
                                                                                <Setter Property="Foreground"
                                                                                    Value="{DynamicResource Brush.Text.Placeholder}" />
                                                                                <Setter Property="Cursor" Value="Arrow" />
                                                                            </Trigger>
                                                                        </Style.Triggers>
                                                                    </Style>
                                                                </Button.Style>
                                                                <StackPanel Orientation="Horizontal"
                                                                    VerticalAlignment="Center"
                                                                    HorizontalAlignment="Left"
                                                                    Margin="0">
                                                                    <TextBlock Text="{Binding DisplayName}"
                                                                        VerticalAlignment="Center"
                                                                        TextTrimming="CharacterEllipsis"
                                                                        TextWrapping="NoWrap"
                                                                        Foreground="{Binding Foreground, RelativeSource={RelativeSource AncestorType={x:Type Button}}}" />
                                                                    <TextBlock Text="&#xE71B;"
                                                                        FontFamily="Segoe MDL2 Assets"
                                                                        Margin="6,0,0,0"
                                                                        VerticalAlignment="Center"
                                                                        Foreground="{Binding Foreground, RelativeSource={RelativeSource AncestorType={x:Type Button}}}" />
                                                                </StackPanel>
                                                            </Button>
                                                            <TextBlock Text="{Binding DescriptionDisplay}"
                                                                Margin="0,4,0,6"
                                                                TextWrapping="Wrap"
                                                                TextTrimming="CharacterEllipsis"
                                                                FontSize="20"
                                                                Foreground="{DynamicResource Brush.Text.Primary}"
                                                                MaxHeight="60" />
                                                            <TextBlock Text="{Binding DatabaseTagsDisplay}"
                                                                FontSize="12"
                                                                Foreground="{DynamicResource Brush.Text.Placeholder}"
                                                                TextTrimming="CharacterEllipsis"
                                                                TextWrapping="NoWrap">
                                                                <TextBlock.Style>
                                                                    <Style TargetType="{x:Type TextBlock}">
                                                                        <Setter Property="Visibility" Value="Visible" />
                                                                        <Style.Triggers>
                                                                            <DataTrigger Binding="{Binding DatabaseTagsDisplay}"
                                                                                Value="">
                                                                                <Setter Property="Visibility" Value="Collapsed" />
                                                                            </DataTrigger>
                                                                        </Style.Triggers>
                                                                    </Style>
                                                                </TextBlock.Style>
                                                            </TextBlock>
                                                        </StackPanel>
                                                        <StackPanel Grid.Column="1"
                                                            Grid.Row="0"
                                                            Orientation="Vertical"
                                                            HorizontalAlignment="Right"
                                                            Margin="12,0,0,0">
                                                            <StackPanel Orientation="Horizontal"
                                                                Margin="0,0,0,6"
                                                                VerticalAlignment="Top">
                                                                <TextBlock Text="&#xE118;"
                                                                    FontFamily="Segoe MDL2 Assets"
                                                                    FontSize="14"
                                                                    Margin="0,0,4,0"
                                                                    Foreground="{DynamicResource Brush.Text.Primary}" />
                                                                <TextBlock FontSize="20"
                                                                    FontWeight="SemiBold"
                                                                    Foreground="{DynamicResource Brush.Text.Primary}">
                                                                    <TextBlock.Text>
                                                                        <MultiBinding
                                                                            Converter="{StaticResource IMM.DownloadMetricDisplayConverter}">
                                                                            <Binding Path="DataContext.IsShowingRecentDownloadMetric"
                                                                                RelativeSource="{RelativeSource AncestorType={x:Type ListView}}" />
                                                                            <Binding Path="DownloadsDisplay" />
                                                                            <Binding Path="RecentDownloadsDisplay" />
                                                                            <Binding Path="TenDayDownloadsDisplay" />
                                                                            <Binding Path="DataContext.ModDatabaseAutoLoadMode"
                                                                                RelativeSource="{RelativeSource AncestorType={x:Type ListView}}" />
                                                                        </MultiBinding>
                                                                    </TextBlock.Text>
                                                                </TextBlock>
                                                            </StackPanel>
                                                            <StackPanel Orientation="Horizontal">
                                                                <TextBlock Text="&#xE15F;"
                                                                    FontFamily="Segoe MDL2 Assets"
                                                                    FontSize="14"
                                                                    Margin="0,0,4,0"
                                                                    Foreground="{DynamicResource Brush.Text.Primary}" />
                                                                <TextBlock Text="{Binding CommentsDisplay}"
                                                                    FontSize="20"
                                                                    FontWeight="SemiBold"
                                                                    Foreground="{DynamicResource Brush.Text.Primary}" />
                                                            </StackPanel>
                                                        </StackPanel>
                                                        <Button Grid.Column="1"
                                                            Grid.Row="1"
                                                            Padding="12,6"
                                                            Width="90"
                                                            Height="30"
                                                            HorizontalAlignment="Right"
                                                            Margin="0,12,0,0"
                                                            Background="{DynamicResource Brush.Button.Primary.Background.Normal}"
                                                            BorderBrush="{DynamicResource Brush.Panel.Secondary.Background.Solid}"
                                                            Click="InstallModButton_OnClick"
                                                            ToolTip="{Binding InstallButtonToolTip}">
                                                            <Button.Style>
                                                                <Style TargetType="{x:Type Button}"
                                                                    BasedOn="{StaticResource {x:Type Button}}">
                                                                    <Setter Property="Visibility" Value="Visible" />
                                                                    <Setter Property="HorizontalContentAlignment" Value="Center" />
                                                                    <Setter Property="VerticalContentAlignment" Value="Center" />
                                                                    <Setter Property="IsEnabled"
                                                                        Value="{Binding HasDownloadableRelease}" />
                                                                    <Style.Triggers>
                                                                        <DataTrigger Binding="{Binding IsInstalled}" Value="True">
                                                                            <Setter Property="Visibility" Value="Collapsed" />
                                                                        </DataTrigger>
                                                                    </Style.Triggers>
                                                                </Style>
                                                            </Button.Style>
                                                            <TextBlock Text="Install"
                                                                VerticalAlignment="Center"
                                                                Foreground="{DynamicResource Brush.Text.Primary}" />
                                                        </Button>
                                                    </Grid>
                                                </Border>
                                            </Grid>
                                        </Border>
                                    </DataTemplate>
                                </ListView.ItemTemplate>
                            </ListView>
                        </Grid>
                    </Border>
                </TabItem>

                <!-- ============================================================ -->
                <!-- TAB 3: Modlists Tab (Local and Online Modlists) -->
                <!-- ============================================================ -->
                <TabItem x:Name="ModlistTab" Header="Modlists" Padding="27,6,27,6" VerticalContentAlignment="Stretch" HorizontalContentAlignment="Stretch" BorderBrush="#00000000">
                    <Grid x:Name="ModlistInnerTab" Background="{DynamicResource Brush.MiddleTab.Background.Selected}" Margin="8,0,8,0">
                        <TabControl x:Name="ModlistsTabControl"
                                BorderThickness="0"
                                Loaded="ModlistsTabControl_OnLoaded"
                                ItemContainerStyle="{DynamicResource IMM.MiddleTabItemStyle}"
                                Background="Transparent"
                                SelectionChanged="ModlistsTabControl_OnSelectionChanged" Padding="0,0,0,0">

                            <!-- Local Modlists Sub-Tab -->
                            <TabItem Style="{DynamicResource IMM.InnerModlistsTabItemStyle}" x:Name="LocalModlistsTabItem"
                                 Header="Local" HorizontalContentAlignment="Stretch" Padding="14,4,14,4" VerticalAlignment="Center" BorderBrush="#00000000">
                                <Grid x:Name="LocalModlistsGrid">
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="*" />
                                        <RowDefinition Height="Auto" />
                                    </Grid.RowDefinitions>

                                    <DataGrid x:Name="LocalModlistsDataGrid"
                                                  ItemsSource="{Binding LocalModlistsView}"
                                                  AutoGenerateColumns="False"
                                                  CanUserAddRows="False"
                                                  CanUserDeleteRows="False"
                                                  IsReadOnly="True"
                                                  SelectionMode="Extended"
                                                  SelectionUnit="FullRow"
                                                  GridLinesVisibility="None"
                                                  RowHeaderWidth="0"
                                                  BorderThickness="5,5,5,5"
                                                  HorizontalGridLinesBrush="Transparent"
                                                  VerticalGridLinesBrush="Transparent"
                                                  HeadersVisibility="Column"
                                                  ui:ControlHelper.CornerRadius="0"
                                                  FontSize="15"
                                                  Foreground="{DynamicResource Brush.Text.Primary}"
                                                  SelectionChanged="LocalModlistsDataGrid_OnSelectionChanged"
                                                  Background="{DynamicResource Brush.Panel.Secondary.Background.Solid}"
                                                  RowBackground="{DynamicResource Brush.Panel.Primary.Background.Solid}" Margin="8,0,8,0" BorderBrush="{DynamicResource Brush.MiddleTab.ModTab.Selected}">
                                        <DataGrid.Resources>
                                            <Style TargetType="{x:Type ScrollBar}"
                                                       BasedOn="{StaticResource IMM.DataGridScrollBarStyle}" />
                                            <Style TargetType="{x:Type Thumb}"
                                                       BasedOn="{StaticResource IMM.DataGridScrollBarThumbStyle}" />
                                            <Style TargetType="{x:Type TextBlock}">
                                                <Setter Property="TextWrapping" Value="Wrap" />
                                            </Style>
                                            <Style TargetType="{x:Type DataGridColumnHeader}"
                                                       BasedOn="{StaticResource IMM.PrimaryDataGridColumnHeaderStyle}" />
                                        </DataGrid.Resources>
                                        <DataGrid.CellStyle>
                                            <StaticResource ResourceKey="IMM.DataGridCellBaseStyle" />
                                        </DataGrid.CellStyle>

                                        <DataGrid.RowHeaderStyle>
                                            <Style />
                                        </DataGrid.RowHeaderStyle>
                                        <DataGrid.RowStyle>
                                            <StaticResource ResourceKey="IMM.ModlistsDataGridRowStyle" />
                                        </DataGrid.RowStyle>
                                        <DataGrid.Columns>
                                            <DataGridTextColumn Header="Name"
                                                                    Binding="{Binding DisplayName}"
                                                                    Width="260"
                                                                    MinWidth="200"
                                                                    IsReadOnly="True">
                                                <DataGridTextColumn.ElementStyle>
                                                    <Style TargetType="{x:Type TextBlock}">
                                                        <Setter Property="VerticalAlignment" Value="Center" />
                                                        <Setter Property="ToolTipService.ShowDuration" Value="60000" />
                                                        <Setter Property="ToolTip" Value="{Binding DisplayName}" />
                                                    </Style>
                                                </DataGridTextColumn.ElementStyle>
                                                <DataGridTextColumn.CellStyle>
                                                    <Style TargetType="{x:Type DataGridCell}"
                                                               BasedOn="{StaticResource IMM.DataGridCellBaseStyle}">
                                                        <Setter Property="VerticalContentAlignment" Value="Center" />
                                                        <Setter Property="Margin" Value="10,0,0,0" />
                                                        <Setter Property="FontWeight" Value="Bold" />
                                                    </Style>
                                                </DataGridTextColumn.CellStyle>
                                            </DataGridTextColumn>
                                            <DataGridTextColumn Header="Uploader"
                                                                    Binding="{Binding UploaderDisplay}"
                                                                    Width="220"
                                                                    MinWidth="180"
                                                                    IsReadOnly="True"
                                                                    ElementStyle="{StaticResource IMM.DataGridCenteredTextStyle}"
                                                                    CellStyle="{StaticResource IMM.DataGridCenteredCellStyle}" />
                                            <DataGridTextColumn Header="Version"
                                                                    Width="120"
                                                                    Binding="{Binding Version, FallbackValue=, TargetNullValue=}"
                                                                    IsReadOnly="True"
                                                                    ElementStyle="{StaticResource IMM.DataGridCenteredTextStyle}"
                                                                    CellStyle="{StaticResource IMM.DataGridCenteredCellStyle}" />
                                            <DataGridTextColumn Header="VS Version"
                                                                    Width="120"
                                                                    Binding="{Binding GameVersionDisplay}"
                                                                    IsReadOnly="True"
                                                                    ElementStyle="{StaticResource IMM.DataGridCenteredTextStyle}"
                                                                    CellStyle="{StaticResource IMM.DataGridCenteredCellStyle}" />
                                            <DataGridTextColumn Header="Last Modified"
                                                                    Width="180"
                                                                    Binding="{Binding LastModifiedDisplay}"
                                                                    SortMemberPath="LastModified"
                                                                    IsReadOnly="True">
                                                <DataGridTextColumn.ElementStyle>
                                                    <Style TargetType="{x:Type TextBlock}">
                                                        <Setter Property="HorizontalAlignment" Value="Center" />
                                                        <Setter Property="VerticalAlignment" Value="Center" />
                                                        <Setter Property="TextAlignment" Value="Center" />
                                                        <Setter Property="ToolTipService.ShowDuration" Value="60000" />
                                                        <Setter Property="ToolTip" Value="{Binding LastModifiedDisplay}" />
                                                    </Style>
                                                </DataGridTextColumn.ElementStyle>
                                                <DataGridTextColumn.CellStyle>
                                                    <Style TargetType="{x:Type DataGridCell}"
                                                               BasedOn="{StaticResource IMM.DataGridCellBaseStyle}">
                                                        <Setter Property="HorizontalContentAlignment" Value="Center" />
                                                        <Setter Property="VerticalContentAlignment" Value="Center" />
                                                    </Style>
                                                </DataGridTextColumn.CellStyle>
                                            </DataGridTextColumn>
                                            <DataGridTemplateColumn Header="Mods" Width="200" MinWidth="180" IsReadOnly="True" CellStyle="{StaticResource IMM.DataGridCenteredCellStyle}">
                                                <DataGridTemplateColumn.CellTemplate>
                                                    <DataTemplate>
                                                        <Grid>
                                                            <ComboBox x:Name="LocalModsComboBox"
                                                                          ItemsSource="{Binding Mods, Mode=OneWay}"
                                                                          IsEditable="True"
                                                                          IsReadOnly="True"
                                                                          SelectedIndex="-1"
                                                                          MaxDropDownHeight="240" />
                                                            <TextBlock Text="{Binding ModsSummary, Mode=OneWay}"
                                                                           Foreground="{DynamicResource Brush.Text.Primary}"
                                                                           HorizontalAlignment="Center"
                                                                           VerticalAlignment="Center"
                                                                           IsHitTestVisible="False">
                                                                <TextBlock.Style>
                                                                    <Style TargetType="{x:Type TextBlock}">
                                                                        <Setter Property="Visibility" Value="Visible" />
                                                                        <Setter Property="Margin" Value="8,0,24,0" />
                                                                        <Setter Property="HorizontalAlignment" Value="Stretch" />
                                                                        <Setter Property="TextAlignment" Value="Center" />
                                                                        <Style.Triggers>
                                                                            <DataTrigger Binding="{Binding IsDropDownOpen, ElementName=LocalModsComboBox}" Value="True">
                                                                                <Setter Property="Visibility" Value="Collapsed" />
                                                                            </DataTrigger>
                                                                        </Style.Triggers>
                                                                    </Style>
                                                                </TextBlock.Style>
                                                            </TextBlock>
                                                        </Grid>
                                                    </DataTemplate>
                                                </DataGridTemplateColumn.CellTemplate>
                                            </DataGridTemplateColumn>
                                        </DataGrid.Columns>
                                    </DataGrid>

                                    <TextBlock x:Name="PlaceholderText" Grid.Row="0"
                                           Text="No local modlists found."
                                           FontSize="16"
                                           Foreground="{DynamicResource Brush.Text.Primary}"
                                           HorizontalAlignment="Center"
                                           VerticalAlignment="Center"
                                           TextAlignment="Center"
                                           TextWrapping="Wrap">
                                        <TextBlock.Style>
                                            <Style TargetType="{x:Type TextBlock}">
                                                <Setter Property="Visibility" Value="Collapsed" />
                                                <Style.Triggers>
                                                    <DataTrigger Binding="{Binding HasLocalModlists}" Value="False">
                                                        <Setter Property="Visibility" Value="Visible" />
                                                    </DataTrigger>
                                                </Style.Triggers>
                                            </Style>
                                        </TextBlock.Style>
                                    </TextBlock>

                                    <Border x:Name="LocalModlistsControlsBorder" Grid.Row="1"
                                        Margin="8,0,8,8"
                                        Background="{DynamicResource Brush.MiddleTab.ModTab.Selected}">

                                        <Grid x:Name="LocalModlistsControls" Margin="0,0,0,8">
                                            <Button x:Name="SaveLocalModlistButton"
                                                Content="Save Modlist (Local)"
                                                Padding="12,0,12,0"
                                                Margin="10,84,0,0"
                                                MinWidth="165"
                                                Click="SaveLocalModlistButton_OnClick"
                                                Height="32"
                                                Width="185"
                                                VerticalAlignment="Top"
                                                HorizontalAlignment="Left" />
                                            <Button x:Name="InstallLocalModlistButton"
                                                Content="Install Selected Modlist"
                                                Padding="12,0,12,0"
                                                Margin="200,121,0,0"
                                                MinWidth="165"
                                                Click="InstallLocalModlistButton_OnClick"
                                                Height="32"
                                                Width="192"
                                                VerticalAlignment="Top"
                                                HorizontalAlignment="Left"
                                                IsEnabled="False" />
                                            <Button x:Name="DeleteLocalModlistsButton"
                                                Content="Delete"
                                                Padding="12,0,12,0"
                                                Margin="10,47,0,0"
                                                MinWidth="165"
                                                Click="DeleteLocalModlistsButton_OnClick"
                                                Height="32"
                                                Width="185"
                                                VerticalAlignment="Top"
                                                HorizontalAlignment="Left"
                                                IsEnabled="False" />
                                            <Button x:Name="OpenModlistsFolderButton"
                                                Content="Open Modlists Folder"
                                                Padding="12,0,12,0"
                                                Margin="10,121,0,0"
                                                MinWidth="165"
                                                Click="OpenModlistsFolderButton_OnClick"
                                                Height="32"
                                                Width="185"
                                                VerticalAlignment="Top"
                                                HorizontalAlignment="Left" />
                                            <Button x:Name="ModifyLocalModlistButton"
                                                Content="Modify"
                                                Padding="12,0,12,0"
                                                Margin="10,10,0,0"
                                                MinWidth="165"
                                                Click="ModifyLocalModlistButton_OnClick"
                                                Height="32"
                                                Width="185"
                                                VerticalAlignment="Top"
                                                HorizontalAlignment="Left"
                                                IsEnabled="False" />
                                            <Border HorizontalAlignment="Left"
                                                Margin="200,10,0,0"
                                                CornerRadius="5"
                                                Width="942"
                                                Background="Transparent"
                                                BorderBrush="{DynamicResource Brush.SunkenSurface.Bevel.Light}"
                                                BorderThickness="0,0,2,2"
                                                SnapsToDevicePixels="True" Height="106" VerticalAlignment="Top">
                                                <Border Background="{DynamicResource Brush.ModCard.Background.Active}"
                                                    BorderBrush="{DynamicResource Brush.SunkenSurface.Bevel.Dark}"
                                                    BorderThickness="2,2,0,0"
                                                    CornerRadius="5"
                                                    Padding="10"
                                                    SnapsToDevicePixels="True"
                                                    ClipToBounds="True">
                                                    <Grid>
                                                        <Grid.RowDefinitions>
                                                            <RowDefinition Height="Auto" />
                                                            <RowDefinition Height="*" />
                                                        </Grid.RowDefinitions>
                                                        <TextBlock x:Name="SelectedLocalModlistTitle"
                                                               Grid.Row="0"
                                                               TextWrapping="Wrap"
                                                               Text=""
                                                               FontWeight="Bold"
                                                               Foreground="{DynamicResource Brush.Text.Primary}" Margin="0,0,0,66" Grid.RowSpan="2" />
                                                        <TextBlock x:Name="SelectedLocalModlistDescription"
                                                               Grid.Row="1"
                                                               Margin="0,8,0,0"
                                                               TextWrapping="Wrap"
                                                               Text=""
                                                               Foreground="{DynamicResource Brush.Text.Primary}" />
                                                    </Grid>
                                                </Border>
                                            </Border>
                                        </Grid>
                                    </Border>
                                </Grid>
                            </TabItem>

                            <!-- Online Modlists Sub-Tab -->
                            <TabItem x:Name="OnlineModlistsTabItem"
                                 Header="Online" Padding="10,4,10,4" Style="{DynamicResource IMM.InnerModlistsTabItemStyle}">
                                <Grid x:Name="OnlineModlistsGrid">
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="*" />
                                        <RowDefinition Height="Auto"/>
                                    </Grid.RowDefinitions>

                                    <DataGrid x:Name="CloudModlistsDataGrid"
                                                  ItemsSource="{Binding CloudModlistsView}"
                                                  AutoGenerateColumns="False"
                                                  CanUserAddRows="False"
                                                  CanUserDeleteRows="False"
                                                  IsReadOnly="True"
                                                  SelectionMode="Single"
                                                  SelectionUnit="FullRow"
                                                  IsEnabled="{Binding CanAccessCloudModlists}"
                                                  GridLinesVisibility="None"
                                                  RowHeaderWidth="0"
                                                  BorderThickness="5,5,5,5"
                                                  HorizontalGridLinesBrush="Transparent"
                                                  VerticalGridLinesBrush="Transparent"
                                                  HeadersVisibility="Column"
                                                  ui:ControlHelper.CornerRadius="0"
                                                  FontSize="15"
                                                  Foreground="{DynamicResource Brush.Text.Primary}"
                                                  SelectionChanged="CloudModlistsDataGrid_OnSelectionChanged"
                                                  Background="{DynamicResource Brush.Panel.Secondary.Background.Solid}"
                                                  RowBackground="{DynamicResource Brush.Panel.Primary.Background.Solid}" Margin="8,0,8,0" BorderBrush="{DynamicResource Brush.MiddleTab.ModTab.Selected}">
                                        <DataGrid.Resources>
                                            <Style TargetType="{x:Type ScrollBar}"
                                                       BasedOn="{StaticResource IMM.DataGridScrollBarStyle}" />
                                            <Style TargetType="{x:Type Thumb}"
                                                       BasedOn="{StaticResource IMM.DataGridScrollBarThumbStyle}" />
                                            <Style TargetType="{x:Type TextBlock}">
                                                <Setter Property="TextWrapping" Value="Wrap" />
                                            </Style>
                                            <Style TargetType="{x:Type DataGridColumnHeader}"
                                                       BasedOn="{StaticResource IMM.PrimaryDataGridColumnHeaderStyle}" />
                                        </DataGrid.Resources>
                                        <DataGrid.CellStyle>
                                            <StaticResource ResourceKey="IMM.DataGridCellBaseStyle" />
                                        </DataGrid.CellStyle>

                                        <DataGrid.RowHeaderStyle>
                                            <Style />
                                        </DataGrid.RowHeaderStyle>
                                        <DataGrid.RowStyle>
                                            <StaticResource ResourceKey="IMM.ModlistsDataGridRowStyle" />
                                        </DataGrid.RowStyle>
                                        <DataGrid.Columns>
                                            <DataGridTextColumn Header="Name"
                                                                    Binding="{Binding DisplayName}"
                                                                    Width="260"
                                                                    MinWidth="200"
                                                                    IsReadOnly="True">
                                                <DataGridTextColumn.ElementStyle>
                                                    <Style TargetType="{x:Type TextBlock}">
                                                        <Setter Property="VerticalAlignment" Value="Center" />
                                                        <Setter Property="ToolTipService.ShowDuration" Value="60000" />
                                                        <Setter Property="ToolTip" Value="{Binding DisplayName}" />
                                                    </Style>
                                                </DataGridTextColumn.ElementStyle>
                                                <DataGridTextColumn.CellStyle>
                                                    <Style TargetType="{x:Type DataGridCell}"
                                                               BasedOn="{StaticResource IMM.DataGridCellBaseStyle}">
                                                        <Setter Property="VerticalContentAlignment" Value="Center" />
                                                        <Setter Property="Margin" Value="10,0,0,0" />
                                                        <Setter Property="FontWeight" Value="Bold" />
                                                    </Style>
                                                </DataGridTextColumn.CellStyle>
                                            </DataGridTextColumn>
                                            <DataGridTextColumn Header="Uploader"
                                                                    Binding="{Binding Uploader}"
                                                                    Width="220"
                                                                    MinWidth="180"
                                                                    IsReadOnly="True"
                                                                    ElementStyle="{StaticResource IMM.DataGridCenteredTextStyle}"
                                                                    CellStyle="{StaticResource IMM.DataGridCenteredCellStyle}" />
                                            <DataGridTextColumn Header="Version"
                                                                    Width="120"
                                                                    Binding="{Binding Version, FallbackValue=, TargetNullValue=}"
                                                                    IsReadOnly="True"
                                                                    ElementStyle="{StaticResource IMM.DataGridCenteredTextStyle}"
                                                                    CellStyle="{StaticResource IMM.DataGridCenteredCellStyle}" />
                                            <DataGridTextColumn Header="VS Version"
                                                                    Width="120"
                                                                    Binding="{Binding GameVersionDisplay}"
                                                                    IsReadOnly="True"
                                                                    ElementStyle="{StaticResource IMM.DataGridCenteredTextStyle}"
                                                                    CellStyle="{StaticResource IMM.DataGridCenteredCellStyle}" />
                                            <DataGridTextColumn Header="Date Added"
                                                                    Width="180"
                                                                    Binding="{Binding DateAddedDisplay}"
                                                                    SortMemberPath="DateAdded"
                                                                    IsReadOnly="True">
                                                <DataGridTextColumn.ElementStyle>
                                                    <Style TargetType="{x:Type TextBlock}">
                                                        <Setter Property="HorizontalAlignment" Value="Center" />
                                                        <Setter Property="VerticalAlignment" Value="Center" />
                                                        <Setter Property="TextAlignment" Value="Center" />
                                                        <Setter Property="ToolTipService.ShowDuration" Value="60000" />
                                                        <Setter Property="ToolTip" Value="{Binding DateAddedDisplay}" />
                                                    </Style>
                                                </DataGridTextColumn.ElementStyle>
                                                <DataGridTextColumn.CellStyle>
                                                    <Style TargetType="{x:Type DataGridCell}"
                                                               BasedOn="{StaticResource IMM.DataGridCellBaseStyle}">
                                                        <Setter Property="HorizontalContentAlignment" Value="Center" />
                                                        <Setter Property="VerticalContentAlignment" Value="Center" />
                                                    </Style>
                                                </DataGridTextColumn.CellStyle>
                                            </DataGridTextColumn>
                                            <DataGridTemplateColumn Header="Mods" Width="200" MinWidth="180" IsReadOnly="True" CellStyle="{StaticResource IMM.DataGridCenteredCellStyle}">
                                                <DataGridTemplateColumn.CellTemplate>
                                                    <DataTemplate>
                                                        <Grid>
                                                            <ComboBox x:Name="ModsComboBox"
                                                                          ItemsSource="{Binding Mods, Mode=OneWay}"
                                                                          IsEditable="True"
                                                                          IsReadOnly="True"
                                                                          SelectedIndex="-1"
                                                                          MaxDropDownHeight="240" />
                                                            <TextBlock Text="{Binding ModsSummary, Mode=OneWay}"
                                                                           Foreground="{DynamicResource Brush.Text.Primary}"
                                                                           HorizontalAlignment="Center"
                                                                           VerticalAlignment="Center"
                                                                           IsHitTestVisible="False">
                                                                <TextBlock.Style>
                                                                    <Style TargetType="{x:Type TextBlock}">
                                                                        <Setter Property="Visibility" Value="Visible" />
                                                                        <Setter Property="Margin" Value="8,0,24,0" />
                                                                        <Setter Property="HorizontalAlignment" Value="Stretch" />
                                                                        <Setter Property="TextAlignment" Value="Center" />
                                                                        <Style.Triggers>
                                                                            <DataTrigger Binding="{Binding IsDropDownOpen, ElementName=ModsComboBox}" Value="True">
                                                                                <Setter Property="Visibility" Value="Collapsed" />
                                                                            </DataTrigger>
                                                                        </Style.Triggers>
                                                                    </Style>
                                                                </TextBlock.Style>
                                                            </TextBlock>
                                                        </Grid>
                                                    </DataTemplate>
                                                </DataGridTemplateColumn.CellTemplate>
                                            </DataGridTemplateColumn>
                                        </DataGrid.Columns>
                                    </DataGrid>

                                    <Border x:Name="OnlineModlistsButtonsBorder"
                                        Background="{DynamicResource Brush.MiddleTab.ModTab.Selected}" Grid.Row="1" Margin="8,0,8,8">

                                        <Grid x:Name="OnlineModlistsButtons"
                                          IsEnabled="{Binding CanAccessCloudModlists}" Margin="0,0,0,8">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="197*"/>
                                                <ColumnDefinition Width="955*"/>
                                            </Grid.ColumnDefinitions>
                                            <Button x:Name="InstallCloudModlistButton"
                                                Content="Install Selected Modlist"
                                                Padding="12,0,12,0"
                                                MinWidth="185"
                                                IsEnabled="False"
                                                Visibility="Visible"
                                                Click="InstallCloudModlistButton_OnClick"
                                                Margin="10,35,0,0"
                                                Height="32"
                                                Width="198"
                                                HorizontalAlignment="Left"
                                                VerticalAlignment="Top" />
                                            <Button x:Name="SaveCloudModlistButton"
                                                Content="Save Modlist (Online)"
                                                Padding="12,0,12,0"
                                                Margin="10,109,0,0"
                                                MinWidth="165"
                                                Click="SaveCloudModlistButton_OnClick"
                                                Height="32"
                                                Width="198"
                                                VerticalAlignment="Top"
                                                HorizontalAlignment="Left" />
                                            <Button x:Name="ModifyCloudModlistsButton"
                                                Content="Modify Modlists"
                                                Padding="12,0,12,0"
                                                Margin="10,72,0,0"
                                                MinWidth="165"
                                                Click="ModifyCloudModlistsButton_OnClick"
                                                Height="32"
                                                Width="198"
                                                VerticalAlignment="Top"
                                                HorizontalAlignment="Left" />
                                            <Button x:Name="RefreshCloudModlistsButton"
                                                Content="Refresh"
                                                Padding="12,0,12,0"
                                                MinWidth="100"
                                                Click="RefreshCloudModlistsButton_OnClick"
                                                Margin="836,109,0,0"
                                                Height="32"
                                                Width="109"
                                                HorizontalAlignment="Left"
                                                VerticalAlignment="Top" Grid.Column="1" />
                                            <Border x:Name="OnlineModlistsDescriptions" HorizontalAlignment="Left"
                                                Height="131"
                                                Margin="3,0,0,0"
                                                VerticalAlignment="Center"
                                                CornerRadius="5"
                                                Width="821"
                                                Background="Transparent"
                                                BorderBrush="{DynamicResource Brush.SunkenSurface.Bevel.Light}"
                                                BorderThickness="0,0,2,2"
                                                SnapsToDevicePixels="True" Grid.Column="1">
                                                <Border Background="{DynamicResource Brush.ModCard.Background.Active}"
                                                    BorderBrush="{DynamicResource Brush.SunkenSurface.Bevel.Dark}"
                                                    BorderThickness="2,2,0,0"
                                                    CornerRadius="5"
                                                    Padding="10"
                                                    SnapsToDevicePixels="True"
                                                    ClipToBounds="True">
                                                    <Grid>
                                                        <Grid.RowDefinitions>
                                                            <RowDefinition Height="Auto" />
                                                            <RowDefinition Height="*" />
                                                        </Grid.RowDefinitions>
                                                        <TextBlock x:Name="SelectedModlistTitle"
                                                               Grid.Row="0"
                                                               TextWrapping="Wrap"
                                                               Text=""
                                                               FontWeight="Bold"
                                                               Foreground="{DynamicResource Brush.Text.Primary}" />
                                                        <ScrollViewer Grid.Row="1"
                                                                  Margin="0,8,0,0"
                                                                  Padding="0,0,4,0"
                                                                  HorizontalScrollBarVisibility="Disabled"
                                                                  VerticalScrollBarVisibility="Auto"
                                                                  CanContentScroll="False"
                                                                  PanningMode="VerticalOnly">
                                                            <ScrollViewer.Resources>
                                                                <Style TargetType="{x:Type ScrollBar}"
                                                                   BasedOn="{StaticResource IMM.SlimScrollBarStyle}" />
                                                            </ScrollViewer.Resources>
                                                            <TextBlock x:Name="SelectedModlistDescription"
                                                                   TextWrapping="Wrap"
                                                                   Text=""
                                                                   Foreground="{DynamicResource Brush.Text.Primary}" />
                                                        </ScrollViewer>
                                                    </Grid>
                                                </Border>
                                            </Border>
                                        </Grid>
                                    </Border>
                                </Grid>
                            </TabItem>
                        </TabControl>
                    </Grid>
                </TabItem>
            </TabControl>

            <!-- Discord Button (top-right corner) -->
            <Button x:Name="DiscordButton"
                    Height="48"
                    Padding="0"
                    BorderThickness="0"
                    ToolTip="Join the Simple VS Manager Discord"
                    Click="DiscordButton_OnClick" VerticalAlignment="Top" Margin="0,-6,5,0" HorizontalAlignment="Right" Width="48">
                <Button.Template>
                    <ControlTemplate TargetType="{x:Type Button}">
                        <Grid Width="{TemplateBinding Width}" Height="{TemplateBinding Height}">
                            <Grid HorizontalAlignment="Center"
                                  VerticalAlignment="Center">
                                <Image x:Name="DiscordIcon"
                                       Source="/Resources/Discord.png"
                                       Width="26"
                                       Height="26"
                                       Stretch="Uniform" />
                                <Rectangle x:Name="DiscordNormalOverlay"
                                           Width="{Binding ActualWidth, ElementName=DiscordIcon}"
                                           Height="{Binding ActualHeight, ElementName=DiscordIcon}"
                                           Fill="{DynamicResource Brush.ComboBox.Background.Hover}">
                                    <Rectangle.OpacityMask>
                                        <ImageBrush ImageSource="/Resources/Discord.png"
                                                    Stretch="Uniform" />
                                    </Rectangle.OpacityMask>
                                </Rectangle>
                                <Rectangle x:Name="DiscordHoverOverlay"
                                           Width="{Binding ActualWidth, ElementName=DiscordIcon}"
                                           Height="{Binding ActualHeight, ElementName=DiscordIcon}"
                                           Visibility="Collapsed"
                                           Fill="#5865F2">
                                    <Rectangle.OpacityMask>
                                        <ImageBrush ImageSource="/Resources/Discord.png"
                                                    Stretch="Uniform" />
                                    </Rectangle.OpacityMask>
                                </Rectangle>
                            </Grid>
                        </Grid>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="DiscordHoverOverlay"
                                        Property="Visibility"
                                        Value="Visible" />
                                <Setter TargetName="DiscordNormalOverlay"
                                        Property="Visibility"
                                        Value="Collapsed" />
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Button.Template>
            </Button>
        </Grid>

        <!-- ============================================================ -->
        <!-- BOTTOM: Status Bar and Action Buttons -->
        <!-- ============================================================ -->
        <Grid x:Name="BOTTOM" Grid.Row="2" Background="{DynamicResource Brush.MiddleTab.Background.Selected}">
            <Grid.Effect>
                <DropShadowEffect Direction="90" BlurRadius="15" ShadowDepth="5" Opacity="0.5"/>
            </Grid.Effect>
            <Grid.ColumnDefinitions>
                <ColumnDefinition />
                <ColumnDefinition Width="Auto" MinWidth="729" />
            </Grid.ColumnDefinitions>

            <Rectangle RadiusY="4.806" Fill="{DynamicResource Brush.MiddleTab.Background.Selected}" Margin="0,91,0,-5" RadiusX="4.806" Grid.ColumnSpan="2"/>

            <!-- Status Message and Loading Progress -->
            <Border x:Name="StatusTextBorder"
                    Width="376"
                    Background="{DynamicResource Brush.SearchBox.Background}"
                    BorderBrush="{DynamicResource Brush.SunkenSurface.Bevel.Dark}"
                    BorderThickness="0,0,2,2"
                    CornerRadius="3"
                    SnapsToDevicePixels="True" Height="80" HorizontalAlignment="Left" Margin="8,8,0,8">
                <Grid>
                    <!-- Regular status message -->
                    <TextBlock Grid.Column="0"
                                   Text="{Binding StatusMessage}"
                                   TextWrapping="Wrap"
                                   HorizontalAlignment="Center"
                                   VerticalAlignment="Center"
                                   FontSize="14"
                                   Foreground="{DynamicResource Brush.Text.Primary}"
                                   FontWeight="Bold"
                                   Padding="4,2,4,2">
                        <TextBlock.Style>
                            <Style TargetType="{x:Type TextBlock}">
                                <Setter Property="Foreground" Value="{DynamicResource Brush.Text.Primary}" />
                                <Setter Property="Visibility" Value="Visible" />
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding HasStatusMessage}" Value="True">
                                        <Setter Property="Visibility" Value="Visible" />
                                    </DataTrigger>
                                    <DataTrigger Binding="{Binding IsErrorStatus}" Value="True">
                                        <Setter Property="Foreground" Value="{DynamicResource Brush.Text.Emphasis}" />
                                    </DataTrigger>
                                    <DataTrigger Binding="{Binding IsLoadingMods}" Value="True">
                                        <Setter Property="Visibility" Value="Collapsed" />
                                    </DataTrigger>
                                    <DataTrigger Binding="{Binding IsModlistInstallInProgress, RelativeSource={RelativeSource AncestorType={x:Type Window}}}" Value="True">
                                        <Setter Property="Visibility" Value="Collapsed" />
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </TextBlock.Style>
                    </TextBlock>

                    <!-- Loading progress display -->
                    <StackPanel VerticalAlignment="Center"
                                    Margin="8,4">
                        <StackPanel.Style>
                            <Style TargetType="{x:Type StackPanel}">
                                <Setter Property="Visibility" Value="Collapsed" />
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding IsLoadingMods}" Value="True">
                                        <Setter Property="Visibility" Value="Visible" />
                                    </DataTrigger>
                                    <DataTrigger Binding="{Binding IsModlistInstallInProgress, RelativeSource={RelativeSource AncestorType={x:Type Window}}}" Value="True">
                                        <Setter Property="Visibility" Value="Collapsed" />
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </StackPanel.Style>

                        <TextBlock Text="{Binding LoadingStatusText}"
                                       FontSize="12"
                                       FontWeight="SemiBold"
                                       Foreground="{DynamicResource Brush.Text.Primary}"
                                       HorizontalAlignment="Center"
                                       Margin="0,0,0,4" />

                        <ProgressBar Value="{Binding LoadingProgress, Mode=OneWay}"
                                         Minimum="0"
                                         Maximum="100"
                                         Height="8"
                                         Foreground="{DynamicResource Brush.Accent.Primary}"
                                         Background="{DynamicResource Brush.Panel.Secondary.Background.Solid}" />
                    </StackPanel>
                </Grid>
            </Border>

            <!-- Action Buttons (Update All, Open Folders, Launch Game) -->
            <StackPanel Grid.Column="1"
                        Orientation="Horizontal"
                        HorizontalAlignment="Left"
                        VerticalAlignment="Bottom" Height="32" Width="666" Margin="53,0,0,10">
                <Button x:Name="UpdateAllButton"
                        Content="{Binding DataContext.UpdateAllButtonLabel, FallbackValue=Update All, RelativeSource={RelativeSource AncestorType={x:Type Window}}}"
                        Margin="0,0,4,0"
                        Background="{DynamicResource Brush.Button.Primary.Background.Normal}"
                        BorderBrush="{DynamicResource Brush.Panel.Secondary.Background.Solid}"
                        Click="UpdateAllModsMenuItem_OnClick" Padding="6,6,6,6" MinHeight="32" MinWidth="125" />
                <Button Content="Open Logs Folder"
                        Margin="0,0,4,0"
                        Background="{DynamicResource Brush.Button.Primary.Background.Normal}"
                        BorderBrush="{DynamicResource Brush.Panel.Secondary.Background.Solid}"
                        Click="OpenLogsFolderButton_OnClick" Padding="6,6,6,6" MinHeight="32" MinWidth="125" />
                <Button Content="Open Config Folder"
                        Margin="0,0,4,0"
                        Background="{DynamicResource Brush.Button.Primary.Background.Normal}"
                        BorderBrush="{DynamicResource Brush.Panel.Secondary.Background.Solid}"
                        Click="OpenConfigFolderButton_OnClick" Padding="6,6,6,6" MinHeight="32" MinWidth="125" />
                <Button Content="Open Mods Folder"
                        Margin="0,0,4,0"
                        Background="{DynamicResource Brush.Button.Primary.Background.Normal}"
                        BorderBrush="{DynamicResource Brush.Panel.Secondary.Background.Solid}"
                        Click="OpenModFolderButton_OnClick" Padding="6,6,6,6" MinHeight="32" MinWidth="125" />
                <Button x:Name="LaunchGameButton"
                        Content="Launch Vintage Story"
                        Background="{DynamicResource Brush.Button.Primary.Background.Normal}"
                        BorderBrush="{DynamicResource Brush.Panel.Secondary.Background.Solid}"
                        Click="LaunchGameButton_OnClick"
                        FontWeight="Bold" MinHeight="32" MinWidth="150" />
            </StackPanel>

            <!-- Loading Progress Ring -->
            <ui:ProgressRing
                HorizontalAlignment="Right"
                IsActive="{Binding IsBusy}"
                Foreground="{DynamicResource Brush.Accent.Primary}" Margin="0,10,10,54" VerticalAlignment="Stretch" Grid.Column="1" Width="32">
                <ui:ProgressRing.Style>
                    <Style TargetType="{x:Type ui:ProgressRing}">
                        <Setter Property="Visibility" Value="Visible" />
                        <Style.Triggers>
                            <DataTrigger Binding="{Binding IsBusy}" Value="False">
                                <Setter Property="Visibility" Value="Collapsed" />
                            </DataTrigger>
                            <DataTrigger Binding="{Binding IsModlistInstallInProgress, RelativeSource={RelativeSource AncestorType={x:Type Window}}}" Value="True">
                                <Setter Property="Visibility" Value="Collapsed" />
                            </DataTrigger>
                        </Style.Triggers>
                    </Style>
                </ui:ProgressRing.Style>
            </ui:ProgressRing>
        </Grid>

        <!-- ============================================================ -->
        <!-- FLOATING OVERLAYS: Mod Info Panel, Modlist Install, Data Backup -->
        <!-- ============================================================ -->

        <!-- Selected Mod Info Panel (Draggable Floating Panel) -->
        <Canvas x:Name="ModInfoOverlay" Grid.RowSpan="3" Panel.ZIndex="400" d:IsHidden="True">
            <Border Background="{DynamicResource Brush.ModCard.Background.Active}" x:Name="MODINFO_border"
                    BorderBrush="{DynamicResource Brush.Panel.Secondary.Background.Solid}"
                    BorderThickness="0"
                    CornerRadius="15,15,15,15" Height="201" Width="326"
                    Canvas.Left="1060"
                    Canvas.Top="350"
                    Panel.ZIndex="400"
                    MouseLeftButtonDown="ModInfoBorder_OnMouseLeftButtonDown"
                    MouseLeftButtonUp="ModInfoBorder_OnMouseLeftButtonUp"
                    MouseMove="ModInfoBorder_OnMouseMove"
                    LostMouseCapture="ModInfoBorder_OnLostMouseCapture">
                <Border.Style>
                    <Style TargetType="{x:Type Border}">
                        <Setter Property="Visibility" Value="Collapsed" />
                        <Setter Property="IsHitTestVisible" Value="False" />
                        <Style.Triggers>
                            <DataTrigger Binding="{Binding HasSelectedMods}" Value="True">
                                <Setter Property="Visibility" Value="Visible" />
                                <Setter Property="IsHitTestVisible" Value="True" />
                            </DataTrigger>
                            <DataTrigger Binding="{Binding IsViewingModlistTab}" Value="True">
                                <Setter Property="Visibility" Value="Collapsed" />
                                <Setter Property="IsHitTestVisible" Value="False" />
                            </DataTrigger>
                            <MultiDataTrigger>
                                <MultiDataTrigger.Conditions>
                                    <Condition Binding="{Binding SearchModDatabase}" Value="True" />
                                    <Condition Binding="{Binding UseModDbDesignView}" Value="True" />
                                </MultiDataTrigger.Conditions>
                                <Setter Property="Visibility" Value="Collapsed" />
                                <Setter Property="IsHitTestVisible" Value="False" />
                            </MultiDataTrigger>
                        </Style.Triggers>
                    </Style>
                </Border.Style>
                <Border.Effect>
                    <DropShadowEffect Color="{DynamicResource Palette.BaseSurface.Shadowed}"
                                      BlurRadius="20"
                                      Direction="270"
                                      ShadowDepth="8"
                                      Opacity="0.2" />
                </Border.Effect>
                <Grid x:Name="MODINFO_grid" Height="223" Width="324" Background="Transparent">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="53*" />
                        <ColumnDefinition Width="28*" />
                    </Grid.ColumnDefinitions>
                    <Grid.Effect>
                        <DropShadowEffect BlurRadius="6"
                                          Direction="270"
                                          ShadowDepth="4"
                                          Opacity="0.1"
                                          Color="{DynamicResource Palette.BaseSurface.Shadowed}" />
                    </Grid.Effect>
                    <Button x:Name="SelectedModDatabasePageButton"
                            Padding="12,6"
                            Background="{DynamicResource Brush.Button.Primary.Background.Normal}"
                            BorderBrush="{DynamicResource Brush.Panel.Secondary.Background.Solid}"
                            Visibility="Visible"
                            IsEnabled="False"
                            Click="ModDatabasePageButton_OnClick"
                            ToolTip="{Binding ModDatabasePageUrlDisplay}"
                            VerticalContentAlignment="Center"
                            Content="Mod Page" HorizontalAlignment="Center" VerticalAlignment="Top" Grid.Column="1"
                            Margin="0,45,0,0" MinHeight="32" MinWidth="92" />
                    <Button x:Name="SelectedModEditConfigButton"
                            Padding="12,6"
                            Background="{DynamicResource Brush.Button.Primary.Background.Normal}"
                            BorderBrush="{DynamicResource Brush.Panel.Secondary.Background.Solid}"
                            Visibility="Visible"
                            IsEnabled="False"
                            Click="EditConfigButton_OnClick"
                            VerticalContentAlignment="Stretch"
                            Content="Edit Config" HorizontalContentAlignment="Stretch" HorizontalAlignment="Center"
                            VerticalAlignment="Top" Margin="0,10,0,0" Grid.Column="1" MinHeight="32" MinWidth="92" />
                    <Button x:Name="SelectedModDeleteButton"
                            Padding="12,6"
                            Background="{DynamicResource Brush.Status.Error}"
                            BorderBrush="{DynamicResource Brush.Panel.Secondary.Background.Solid}"
                            Visibility="Visible"
                            IsEnabled="False"
                            Click="DeleteModButton_OnClick" HorizontalAlignment="Center" VerticalAlignment="Top"
                            Margin="0,80,0,0" Grid.Column="1" MinHeight="32" MinWidth="92">
                        <Button.Style>
                            <Style TargetType="{x:Type Button}" BasedOn="{StaticResource {x:Type Button}}">
                                <Setter Property="ToolTip" Value="{Binding DisplayName, StringFormat=Delete \{0\}}" />
                                <Style.Triggers>
                                    <DataTrigger
                                        Binding="{Binding DataContext.HasMultipleSelectedMods, RelativeSource={RelativeSource AncestorType={x:Type Window}}}"
                                        Value="True">
                                        <Setter Property="ToolTip" Value="Delete selected mods" />
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </Button.Style>
                        <StackPanel Orientation="Horizontal" VerticalAlignment="Center">

                            <TextBlock Text="Delete" VerticalAlignment="Center"
                                       Foreground="{DynamicResource Brush.Text.Primary}" />
                        </StackPanel>
                    </Button>
                    <Button x:Name="SelectedModCopyForServerButton"
                            Padding="12,6"
                            Background="{DynamicResource Brush.Button.Primary.Background.Normal}"
                            BorderBrush="{DynamicResource Brush.Panel.Secondary.Background.Solid}"
                            Visibility="Visible"
                            IsEnabled="False"
                            Click="SelectedModCopyForServerButton_OnClick"
                            HorizontalAlignment="Center"
                            VerticalAlignment="Top"
                            Margin="0,117,0,0"
                            Grid.Column="1"
                            MinHeight="32" MinWidth="92"
                            VerticalContentAlignment="Center"
                            HorizontalContentAlignment="Center"
                            Content="Copy for Server" />
                    <Button x:Name="SelectedModFixButton"
                            Padding="12,6"
                            Background="{DynamicResource Brush.Status.Error}"
                            BorderBrush="{DynamicResource Brush.Text.Primary}"
                            Visibility="Collapsed"
                            IsEnabled="False"
                            Click="FixModButton_OnClick"
                            ToolTip="Resolve dependency issues" HorizontalAlignment="Center" VerticalAlignment="Top"
                            Margin="0,115,0,0" Grid.Column="1" MinHeight="32" MinWidth="92" d:IsHidden="True">
                        <Button.Style>
                            <Style TargetType="{x:Type Button}" BasedOn="{StaticResource {x:Type Button}}">
                                <Setter Property="Background" Value="{DynamicResource Brush.Status.Error}" />
                                <Setter Property="BorderBrush" Value="{DynamicResource Brush.Text.Primary}" />
                                <Setter Property="Template">
                                    <Setter.Value>
                                        <ControlTemplate TargetType="{x:Type Button}">
                                            <Border x:Name="Root"
                                                    Background="{TemplateBinding Background}"
                                                    BorderBrush="{TemplateBinding BorderBrush}"
                                                    BorderThickness="{TemplateBinding BorderThickness}"
                                                    CornerRadius="{TemplateBinding ui:ControlHelper.CornerRadius}"
                                                    Padding="{TemplateBinding Padding}"
                                                    SnapsToDevicePixels="True">
                                                <ContentPresenter
                                                    HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                                    VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
                                                    RecognizesAccessKey="True" />
                                            </Border>
                                            <ControlTemplate.Triggers>
                                                <Trigger Property="IsEnabled" Value="False">
                                                    <Setter TargetName="Root" Property="Opacity" Value="0.6" />
                                                </Trigger>
                                                <Trigger Property="IsMouseOver" Value="True">
                                                    <Setter TargetName="Root" Property="Background"
                                                            Value="{DynamicResource Brush.Status.Error}" />
                                                    <Setter TargetName="Root" Property="BorderBrush"
                                                            Value="{DynamicResource Brush.Text.Primary}" />
                                                </Trigger>
                                                <Trigger Property="IsPressed" Value="True">
                                                    <Setter TargetName="Root" Property="Background"
                                                            Value="{DynamicResource Brush.Status.Error}" />
                                                    <Setter TargetName="Root" Property="BorderBrush"
                                                            Value="{DynamicResource Brush.Text.Primary}" />
                                                </Trigger>
                                            </ControlTemplate.Triggers>
                                        </ControlTemplate>
                                    </Setter.Value>
                                </Setter>
                            </Style>
                        </Button.Style>
                        <StackPanel Orientation="Horizontal" VerticalAlignment="Center">

                            <TextBlock Text="Fix" VerticalAlignment="Center" />
                        </StackPanel>
                    </Button>
                    <Button x:Name="SelectedModInstallButton"
                            Padding="12,6"
                            Background="{DynamicResource Brush.Button.Primary.Background.Normal}"
                            BorderBrush="{DynamicResource Brush.Panel.Secondary.Background.Solid}"
                            Visibility="Visible"
                            IsEnabled="False"
                            Click="InstallModButton_OnClick"
                            ToolTip="{Binding InstallButtonToolTip}" HorizontalAlignment="Center"
                            VerticalAlignment="Top" Margin="0,10,0,0" Grid.Column="1" MinHeight="32" MinWidth="92">
                        <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                            <TextBlock Text="Install" VerticalAlignment="Center" />
                        </StackPanel>
                    </Button>
                    <ComboBox x:Name="SelectedModVersionComboBox"
                              Width="166"
                              Padding="12,6"
                              Background="{DynamicResource Brush.ComboBox.Background.Normal}"
                              BorderBrush="{DynamicResource Brush.ComboBox.Border.Normal}"
                              BorderThickness="1"
                              Foreground="{DynamicResource Brush.Text.Primary}"
                              ui:ControlHelper.CornerRadius="6"
                              ItemsSource="{Binding SelectedMod.VersionOptions}"
                              SelectedItem="{Binding SelectedMod.SelectedVersionOption, Mode=TwoWay}"
                              SelectionChanged="SelectedModVersionComboBox_OnSelectionChanged"
                              DropDownOpened="SelectedModVersionComboBox_OnDropDownOpened"
                              VerticalAlignment="Top" HorizontalAlignment="Left" Margin="17,155,0,0" MinHeight="32">
                        <ComboBox.Resources>
                            <DataTemplate x:Key="SelectedModVersionTemplate"
                                          DataType="{x:Type viewModels:ModVersionOptionViewModel}">
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="{Binding SelectionDisplay}" />
                                    <TextBlock Text="" Foreground="{DynamicResource Brush.Accent.Primary}"
                                               Margin="6,0,0,0">
                                        <TextBlock.Style>
                                            <Style TargetType="{x:Type TextBlock}">
                                                <Setter Property="Visibility" Value="Collapsed" />
                                                <Style.Triggers>
                                                    <DataTrigger Binding="{Binding IsCompatible}" Value="True">
                                                        <Setter Property="Visibility" Value="Visible" />
                                                    </DataTrigger>
                                                </Style.Triggers>
                                            </Style>
                                        </TextBlock.Style>
                                    </TextBlock>
                                </StackPanel>
                            </DataTemplate>
                        </ComboBox.Resources>
                        <ComboBox.Style>
                            <Style TargetType="{x:Type ComboBox}" BasedOn="{StaticResource {x:Type ComboBox}}">
                                <Setter Property="Visibility" Value="Visible" />
                                <Setter Property="IsEnabled" Value="False" />
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding SelectedMod.HasVersionOptions}" Value="True">
                                        <Setter Property="Visibility" Value="Visible" />
                                        <Setter Property="IsEnabled" Value="True" />
                                    </DataTrigger>
                                    <DataTrigger
                                        Binding="{Binding DataContext.SearchModDatabase, RelativeSource={RelativeSource AncestorType={x:Type Window}}}"
                                        Value="True">
                                        <Setter Property="Visibility" Value="Visible" />
                                        <Setter Property="IsEnabled" Value="False" />
                                    </DataTrigger>
                                    <DataTrigger Binding="{Binding HasMultipleSelectedMods}" Value="True">
                                        <Setter Property="Visibility" Value="Collapsed" />
                                        <Setter Property="IsEnabled" Value="False" />
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </ComboBox.Style>
                        <ComboBox.ItemTemplate>
                            <StaticResource ResourceKey="SelectedModVersionTemplate" />
                        </ComboBox.ItemTemplate>
                    </ComboBox>
                    <Button x:Name="SelectedModUpdateButton"
                            Padding="6,6,6,6"
                            Background="{DynamicResource Brush.Button.Primary.Background.Normal}"
                            BorderBrush="{DynamicResource Brush.Panel.Secondary.Background.Solid}"
                            Visibility="Visible"
                            IsEnabled="False"
                            Click="UpdateModButton_OnClick"
                            ToolTip="{Binding UpdateButtonToolTip}" HorizontalAlignment="Center"
                            VerticalAlignment="Top" Grid.Column="1" Margin="0,154,0,0" MinHeight="32" MaxHeight="33"
                            MinWidth="100" Width="108">
                        <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                            <TextBlock Width="90">
                                <Run Text="Update to latest" /><LineBreak /><Run />
                            </TextBlock>
                        </StackPanel>
                    </Button>
                    <TextBlock
                        FontWeight="SemiBold"
                        Foreground="{DynamicResource Brush.Text.Primary}"
                        TextAlignment="Left" VerticalAlignment="Top" HorizontalAlignment="Left" Width="189"
                        Margin="23,15,0,0" Height="25" FontSize="14">
                        <TextBlock.Style>
                            <Style TargetType="{x:Type TextBlock}">
                                <Setter Property="Text" Value="{Binding SelectedMod.DisplayName}" />
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding HasMultipleSelectedMods}" Value="True">
                                        <Setter Property="Text" Value="Multiple mods selected" />
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </TextBlock.Style>
                    </TextBlock>
                    <TextBlock
                        Text="{Binding SelectedMod.DescriptionDisplay}"
                        Foreground="{DynamicResource Brush.Text.Primary}"
                        MaxWidth="420"
                        TextWrapping="Wrap"
                        TextTrimming="CharacterEllipsis"
                        TextAlignment="Left" HorizontalAlignment="Left" VerticalAlignment="Top" Width="189"
                        Height="105" MaxHeight="143" Margin="23,45,0,0" FontSize="14">
                        <TextBlock.Style>
                            <Style TargetType="{x:Type TextBlock}">
                                <Setter Property="Visibility" Value="Visible" />
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding HasMultipleSelectedMods}" Value="True">
                                        <Setter Property="Visibility" Value="Collapsed" />
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </TextBlock.Style>
                    </TextBlock>
                </Grid>
            </Border>
        </Canvas>

        <!-- Modlist Installation Progress Overlay -->
        <Border x:Name="ModlistInstallOverlay"
                Grid.RowSpan="3"
                Margin="0,0,0,-8"
                Background="#C0000000"
                Visibility="{Binding RelativeSource={RelativeSource AncestorType=Window}, Path=IsModlistInstallInProgress, Converter={StaticResource IMM.VisibleWhenTrueConverter}}"
                IsHitTestVisible="True"
                Panel.ZIndex="5500" d:IsHidden="True">
            <Border HorizontalAlignment="Center"
                    VerticalAlignment="Center"
                    Background="{DynamicResource Brush.Panel.Primary.Background.Solid}"
                    CornerRadius="10"
                    Padding="32"
                    Width="420">
                <StackPanel>
                    <TextBlock Text="Installing modlist..."
                               FontSize="18"
                               FontWeight="Bold"
                               HorizontalAlignment="Center"
                               Foreground="{DynamicResource Brush.Text.Primary}" />
                    <ProgressBar Margin="0,16,0,8"
                                 Height="18"
                                 Minimum="0"
                                 Maximum="100"
                                 Value="{Binding RelativeSource={RelativeSource AncestorType=Window}, Path=ModlistInstallProgress}" />
                    <TextBlock Text="{Binding RelativeSource={RelativeSource AncestorType=Window}, Path=ModlistInstallStatusMessage}"
                               FontSize="14"
                               Foreground="{DynamicResource Brush.Text.Primary}"
                               TextWrapping="Wrap"
                               Margin="0,0,0,8" />
                    <TextBlock Text="{Binding RelativeSource={RelativeSource AncestorType=Window}, Path=ModlistDownloadSpeed, StringFormat=Download speed: {0}}"
                               FontSize="13"
                               Foreground="{DynamicResource Brush.Text.Primary}"
                               TextWrapping="Wrap"
                               Margin="0,0,0,8"
                               Visibility="{Binding RelativeSource={RelativeSource AncestorType=Window}, Path=HasModlistDownloadSpeed, Converter={StaticResource IMM.VisibleWhenTrueConverter}}" />
                    <TextBlock Text="Simple VS Manager disables all controls while mods install."
                               FontSize="13"
                               Foreground="{DynamicResource Brush.Text.Primary}"
                               TextWrapping="Wrap"
                               TextAlignment="Center" Width="260" />
                </StackPanel>
            </Border>
        </Border>

        <!-- Data Backup Progress Overlay -->
        <Border x:Name="DataBackupOverlay"
                Grid.RowSpan="3"
                Margin="0,0,0,-8"
                Background="#C0000000"
                Visibility="{Binding RelativeSource={RelativeSource AncestorType=Window}, Path=IsDataBackupInProgress, Converter={StaticResource IMM.VisibleWhenTrueConverter}}"
                IsHitTestVisible="True"
                Panel.ZIndex="5000" d:IsHidden="True">
            <Border HorizontalAlignment="Center"
                    VerticalAlignment="Center"
                    Background="{DynamicResource Brush.Panel.Primary.Background.Solid}"
                    CornerRadius="10"
                    Padding="32"
                    Width="420">
                <StackPanel>
                    <TextBlock Text="Please wait..."
                               FontSize="18"
                               FontWeight="Bold"
                               HorizontalAlignment="Center"
                               Foreground="{DynamicResource Brush.Text.Primary}" />
                    <ProgressBar Margin="0,16,0,8"
                                 Height="18"
                                 Minimum="0"
                                 Maximum="100"
                                 Value="{Binding RelativeSource={RelativeSource AncestorType=Window}, Path=DataBackupProgress}" />
                    <TextBlock Text="{Binding RelativeSource={RelativeSource AncestorType=Window}, Path=DataBackupStatusMessage}"
                               FontSize="14"
                               Foreground="{DynamicResource Brush.Text.Primary}"
                               TextWrapping="Wrap"
                               Margin="0,0,0,8" />
                    <TextBlock Text="Simple VS Manager disables all controls while the backup finishes."
                               FontSize="13"
                               Foreground="{DynamicResource Brush.Text.Primary}"
                               TextWrapping="Wrap"
                               TextAlignment="Center" Width="228" />
                </StackPanel>
            </Border>
        </Border>

    </Grid>
</Window>